{"pageProps":{"toc":"[{\"url\":\"#\",\"text\":\"æ¦‚è§ˆ\",\"depth\":2},{\"url\":\"#what-are-effects-and-how-are-they-different-from-events\",\"depth\":2,\"text\":\"ä»€ä¹ˆæ˜¯ Effectï¼Œå®ƒä¸äº‹ä»¶ï¼ˆeventï¼‰æœ‰ä½•ä¸åŒï¼Ÿ \"},{\"url\":\"#you-might-not-need-an-effect\",\"depth\":2,\"text\":\"ä½ å¯èƒ½ä¸éœ€è¦ Effect \"},{\"url\":\"#how-to-write-an-effect\",\"depth\":2,\"text\":\"å¦‚ä½•ç¼–å†™ Effect \"},{\"url\":\"#step-1-declare-an-effect\",\"depth\":3,\"text\":\"ç¬¬ä¸€æ­¥ï¼šå£°æ˜ Effect \"},{\"url\":\"#step-2-specify-the-effect-dependencies\",\"depth\":3,\"text\":\"ç¬¬äºŒæ­¥ï¼šæŒ‡å®š Effect çš„ä¾èµ–é¡¹ \"},{\"url\":\"#step-3-add-cleanup-if-needed\",\"depth\":3,\"text\":\"ç¬¬ä¸‰æ­¥ï¼šæŒ‰éœ€æ·»åŠ æ¸…ç†ï¼ˆcleanupï¼‰å‡½æ•° \"},{\"url\":\"#how-to-handle-the-effect-firing-twice-in-development\",\"depth\":2,\"text\":\"å¦‚ä½•å¤„ç†åœ¨å¼€å‘ç¯å¢ƒä¸‹ Effect è¿è¡Œäº†ä¸¤æ¬¡ï¼Ÿ \"},{\"url\":\"#controlling-non-react-widgets\",\"depth\":3,\"text\":\"ç®¡ç†é React å°éƒ¨ä»¶ \"},{\"url\":\"#subscribing-to-events\",\"depth\":3,\"text\":\"è®¢é˜…äº‹ä»¶ \"},{\"url\":\"#triggering-animations\",\"depth\":3,\"text\":\"è§¦å‘åŠ¨ç”» \"},{\"url\":\"#fetching-data\",\"depth\":3,\"text\":\"è·å–æ•°æ® \"},{\"url\":\"#sending-analytics\",\"depth\":3,\"text\":\"å‘é€åˆ†ææŠ¥å‘Š \"},{\"url\":\"#not-an-effect-initializing-the-application\",\"depth\":3,\"text\":\"ä¸é€‚ç”¨äº Effectï¼šåˆå§‹åŒ–åº”ç”¨ \"},{\"url\":\"#not-an-effect-buying-a-product\",\"depth\":3,\"text\":\"ä¸é€‚ç”¨äº Effectï¼šè´­ä¹°å•†å“ \"},{\"url\":\"#putting-it-all-together\",\"depth\":2,\"text\":\"ç»¼åˆä»¥ä¸Šå†…å®¹ \"},{\"url\":\"#recap\",\"depth\":2,\"text\":\"Recap\"},{\"url\":\"#challenges\",\"depth\":2,\"text\":\"Challenges\"}]","content":"[[\"$r\",\"MaxWidth\",\"54\",{\"children\":[[\"$r\",\"Intro\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"æœ‰äº›ç»„ä»¶éœ€è¦ä¸å¤–éƒ¨ç³»ç»ŸåŒæ­¥ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½å¸Œæœ›æ ¹æ® React state æ§åˆ¶é React ç»„ä»¶ã€å»ºç«‹æœåŠ¡å™¨è¿æ¥æˆ–å½“ç»„ä»¶åœ¨é¡µé¢æ˜¾ç¤ºæ—¶å‘é€åˆ†ææ—¥å¿—ã€‚Effect å…è®¸ä½ åœ¨æ¸²æŸ“ç»“æŸåæ‰§è¡Œä¸€äº›ä»£ç ï¼Œä»¥ä¾¿å°†ç»„ä»¶ä¸ React å¤–éƒ¨çš„æŸä¸ªç³»ç»Ÿç›¸åŒæ­¥ã€‚\"}]}],\"\\n\",[\"$r\",\"YouWillLearn\",null,{\"children\":[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä»€ä¹ˆæ˜¯ Effect\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"Effect ä¸äº‹ä»¶ï¼ˆeventï¼‰æœ‰ä½•ä¸åŒ\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å¦‚ä½•åœ¨ç»„ä»¶ä¸­å£°æ˜ Effect\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å¦‚ä½•é¿å…ä¸å¿…è¦åœ°é‡æ–°è¿è¡Œ Effect\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä¸ºä»€ä¹ˆ Effect åœ¨å¼€å‘ç¯å¢ƒä¸­ä¼šè¿è¡Œä¸¤æ¬¡ä»¥åŠå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜\"}],\"\\n\"]}]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"what-are-effects-and-how-are-they-different-from-events\",\"children\":\"ä»€ä¹ˆæ˜¯ Effectï¼Œå®ƒä¸äº‹ä»¶ï¼ˆeventï¼‰æœ‰ä½•ä¸åŒï¼Ÿ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"åœ¨æ¥è§¦ Effect ä¹‹å‰ï¼Œä½ éœ€è¦ç†Ÿæ‚‰ React ç»„ä»¶ä¸­çš„ä¸¤ç§é€»è¾‘ç±»å‹ï¼š\"}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"æ¸²æŸ“ä»£ç \"}],\"ï¼ˆåœ¨ \",[\"$r\",\"a\",null,{\"href\":\"/learn/describing-the-ui\",\"children\":\"æè¿° UI\"}],\" ä¸­æœ‰ä»‹ç»ï¼‰ä½äºç»„ä»¶çš„é¡¶å±‚ã€‚ä½ åœ¨è¿™é‡Œå¤„ç† props å’Œ stateï¼Œå¯¹å®ƒä»¬è¿›è¡Œè½¬æ¢ï¼Œå¹¶è¿”å›å¸Œæœ›åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºçš„ JSXã€‚\",[\"$r\",\"a\",null,{\"href\":\"/learn/keeping-components-pure\",\"children\":\"æ¸²æŸ“ä»£ç å¿…é¡»æ˜¯çº¯ç²¹çš„\"}],\"â€”â€”å°±åƒæ•°å­¦å…¬å¼ä¸€æ ·ï¼Œå®ƒåªåº”è¯¥â€œè®¡ç®—â€ç»“æœï¼Œè€Œä¸åšå…¶ä»–ä»»ä½•äº‹æƒ…ã€‚\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"äº‹ä»¶å¤„ç†ç¨‹åº\"}],\"ï¼ˆåœ¨ \",[\"$r\",\"a\",null,{\"href\":\"/learn/adding-interactivity\",\"children\":\"æ·»åŠ äº¤äº’æ€§\"}],\" ä¸­æœ‰ä»‹ç»ï¼‰æ˜¯ç»„ä»¶å†…éƒ¨çš„åµŒå¥—å‡½æ•°ï¼Œå®ƒä»¬ä¸å…‰è¿›è¡Œè®¡ç®—, è¿˜ä¼šæ‰§è¡Œä¸€äº›æ“ä½œã€‚äº‹ä»¶å¤„ç†ç¨‹åºå¯èƒ½ä¼šæ›´æ–°è¾“å…¥å­—æ®µã€æäº¤ HTTP POST è¯·æ±‚æ¥è´­ä¹°äº§å“ï¼Œæˆ–è€…å°†ç”¨æˆ·å¯¼èˆªåˆ°å¦ä¸€ä¸ªé¡µé¢ã€‚äº‹ä»¶å¤„ç†ç¨‹åºåŒ…å«ç”±ç‰¹å®šç”¨æˆ·æ“ä½œï¼ˆä¾‹å¦‚æŒ‰é’®ç‚¹å‡»æˆ–è¾“å…¥ï¼‰å¼•èµ·çš„â€œå‰¯ä½œç”¨â€ï¼ˆå®ƒä»¬æ”¹å˜äº†ç¨‹åºçš„çŠ¶æ€ï¼‰ã€‚\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æœ‰æ—¶è¿™è¿˜ä¸å¤Ÿã€‚è€ƒè™‘ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" ç»„ä»¶ï¼Œå®ƒåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºæ—¶å¿…é¡»è¿æ¥åˆ°èŠå¤©æœåŠ¡å™¨ã€‚è¿æ¥åˆ°æœåŠ¡å™¨å¹¶ä¸æ˜¯çº¯ç²¹çš„è®¡ç®—ï¼ˆå®ƒæ˜¯ä¸€ä¸ªå‰¯ä½œç”¨ï¼‰ï¼Œå› æ­¤å®ƒä¸èƒ½åœ¨æ¸²æŸ“æœŸé—´å‘ç”Ÿã€‚ç„¶è€Œï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶ï¼ˆæ¯”å¦‚ç‚¹å‡»ï¼‰èƒ½è®© \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" è¢«æ˜¾ç¤ºã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"Effect å…è®¸ä½ æŒ‡å®šç”±æ¸²æŸ“è‡ªèº«ï¼Œè€Œä¸æ˜¯ç‰¹å®šäº‹ä»¶å¼•èµ·çš„å‰¯ä½œç”¨\"}],\"ã€‚åœ¨èŠå¤©ä¸­å‘é€æ¶ˆæ¯æ˜¯ä¸€ä¸ªâ€œäº‹ä»¶â€ï¼Œå› ä¸ºå®ƒç›´æ¥ç”±ç”¨æˆ·ç‚¹å‡»ç‰¹å®šæŒ‰é’®å¼•èµ·ã€‚ç„¶è€Œï¼Œå»ºç«‹æœåŠ¡å™¨è¿æ¥æ˜¯ä¸€ä¸ª Effectï¼Œå› ä¸ºæ— è®ºå“ªç§äº¤äº’è‡´ä½¿ç»„ä»¶å‡ºç°ï¼Œå®ƒéƒ½åº”è¯¥å‘ç”Ÿã€‚Effect åœ¨ \",[\"$r\",\"a\",null,{\"href\":\"/learn/render-and-commit\",\"children\":\"æäº¤\"}],\" ç»“æŸåã€é¡µé¢æ›´æ–°åè¿è¡Œã€‚æ­¤æ—¶æ˜¯å°† React ç»„ä»¶ä¸å¤–éƒ¨ç³»ç»Ÿï¼ˆå¦‚ç½‘ç»œæˆ–ç¬¬ä¸‰æ–¹åº“ï¼‰åŒæ­¥çš„æœ€ä½³æ—¶æœºã€‚\"]}],\"\\n\",[\"$r\",\"Note\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"åœ¨æœ¬æ–‡æ­¤å¤„å’Œåç»­æ–‡æœ¬ä¸­ï¼Œå¤§å†™çš„ \",[\"$r\",\"code\",null,{\"children\":\"Effect\"}],\" æ˜¯ React ä¸­çš„ä¸“æœ‰å®šä¹‰â€”â€”ç”±æ¸²æŸ“å¼•èµ·çš„å‰¯ä½œç”¨ã€‚è‡³äºæ›´å¹¿æ³›çš„ç¼–ç¨‹æ¦‚å¿µ(ä»»ä½•æ”¹å˜ç¨‹åºçŠ¶æ€æˆ–å¤–éƒ¨ç³»ç»Ÿçš„è¡Œä¸º)ï¼Œæˆ‘ä»¬åˆ™ä½¿ç”¨â€œå‰¯ä½œç”¨ï¼ˆside effectï¼‰â€ æ¥æŒ‡ä»£ã€‚\"]}]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"you-might-not-need-an-effect\",\"children\":\"ä½ å¯èƒ½ä¸éœ€è¦ Effect \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"ä¸è¦æ€¥ç€åœ¨ä½ çš„ç»„ä»¶ä¸­ä½¿ç”¨ Effect\"}],\"ã€‚è®°ä½ï¼ŒEffect é€šå¸¸ç”¨äºæš‚æ—¶â€œè·³å‡ºâ€ React å¹¶ä¸ä¸€äº› \",[\"$r\",\"strong\",null,{\"children\":\"å¤–éƒ¨\"}],\" ç³»ç»Ÿè¿›è¡ŒåŒæ­¥ã€‚è¿™åŒ…æ‹¬æµè§ˆå™¨ APIã€ç¬¬ä¸‰æ–¹å°éƒ¨ä»¶ï¼Œä»¥åŠç½‘ç»œç­‰ç­‰ã€‚å¦‚æœä½ çš„ Effect åªæ˜¯æ ¹æ®å…¶ä»–çŠ¶æ€æ¥è°ƒæ•´æŸäº›çŠ¶æ€ï¼Œé‚£ä¹ˆ \",[\"$r\",\"a\",null,{\"href\":\"/learn/you-might-not-need-an-effect\",\"children\":\"ä½ å¯èƒ½å¹¶ä¸éœ€è¦ä¸€ä¸ª Effect\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"how-to-write-an-effect\",\"children\":\"å¦‚ä½•ç¼–å†™ Effect \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¦ç¼–å†™ä¸€ä¸ª Effect, è¯·éµå¾ªä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"å£°æ˜ Effect\"}],\"ã€‚é€šå¸¸ Effect ä¼šåœ¨æ¯æ¬¡ \",[\"$r\",\"a\",null,{\"href\":\"/learn/render-and-commit\",\"children\":\"æäº¤\"}],\" åè¿è¡Œã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"æŒ‡å®š Effect ä¾èµ–\"}],\"ã€‚å¤§å¤šæ•° Effect åº”è¯¥æŒ‰éœ€è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨æ¯æ¬¡æ¸²æŸ“åéƒ½è¿è¡Œã€‚ä¾‹å¦‚ï¼Œæ·¡å…¥åŠ¨ç”»åº”è¯¥åªåœ¨ç»„ä»¶å‡ºç°æ—¶è§¦å‘ã€‚è¿æ¥å’Œæ–­å¼€æœåŠ¡å™¨çš„æ“ä½œåªåº”åœ¨ç»„ä»¶å‡ºç°å’Œæ¶ˆå¤±æ—¶ï¼Œæˆ–è€…åˆ‡æ¢èŠå¤©å®¤æ—¶æ‰§è¡Œã€‚ä½ å°†é€šè¿‡æŒ‡å®š \",[\"$r\",\"strong\",null,{\"children\":\"ä¾èµ–é¡¹\"}],\" æ¥å­¦ä¹ å¦‚ä½•æ§åˆ¶è¿™ä¸€ç‚¹ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"å¿…è¦æ—¶æ·»åŠ æ¸…ç†æ“ä½œ\"}],\"ã€‚ä¸€äº› Effect éœ€è¦æŒ‡å®šå¦‚ä½•åœæ­¢ã€æ’¤é”€ï¼Œæˆ–è€…æ¸…é™¤å®ƒä»¬æ‰€æ‰§è¡Œçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œâ€œè¿æ¥â€éœ€è¦â€œæ–­å¼€â€ï¼Œâ€œè®¢é˜…â€éœ€è¦â€œé€€è®¢â€ï¼Œè€Œâ€œè·å–æ•°æ®â€éœ€è¦â€œå–æ¶ˆâ€æˆ–è€…â€œå¿½ç•¥â€ã€‚ä½ å°†å­¦ä¹ å¦‚ä½•é€šè¿‡è¿”å›ä¸€ä¸ª \",[\"$r\",\"strong\",null,{\"children\":\"æ¸…ç†å‡½æ•°\"}],\" æ¥å®ç°è¿™äº›ã€‚\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è®©æˆ‘ä»¬è¯¦ç»†çœ‹çœ‹æ¯ä¸€æ­¥ã€‚\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"step-1-declare-an-effect\",\"children\":\"ç¬¬ä¸€æ­¥ï¼šå£°æ˜ Effect \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å…ˆä» React ä¸­å¯¼å…¥ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/useEffect\",\"children\":[[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\" Hook\"]}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useEffect } from 'react';\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å†åœ¨ç»„ä»¶é¡¶éƒ¨è°ƒç”¨, å¹¶åœ¨å…¶ä¸­åŠ å…¥ä¸€äº›ä»£ç ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-4}\",\"children\":\"function MyComponent() {\\r\\n  useEffect(() => {\\r\\n    // æ¯æ¬¡æ¸²æŸ“åéƒ½ä¼šæ‰§è¡Œæ­¤å¤„çš„ä»£ç \\r\\n  });\\r\\n  return <div />;\\r\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æ¯å½“ä½ çš„ç»„ä»¶æ¸²æŸ“æ—¶ï¼ŒReact ä¼šå…ˆæ›´æ–°é¡µé¢ï¼Œç„¶åå†è¿è¡Œ \",[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\" ä¸­çš„ä»£ç ã€‚æ¢å¥è¯è¯´ï¼Œ\",[\"$r\",\"strong\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\" ä¼šâ€œå»¶è¿Ÿâ€ä¸€æ®µä»£ç çš„è¿è¡Œï¼Œç›´åˆ°æ¸²æŸ“ç»“æœåæ˜ åœ¨é¡µé¢ä¸Š\"]}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Effect æ¥ä¸å¤–éƒ¨ç³»ç»ŸåŒæ­¥ã€‚è€ƒè™‘ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"<VideoPlayer>\"}],\" React ç»„ä»¶ã€‚æˆ‘ä»¬æƒ³è¦é€šè¿‡ä¼ é€’ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" prop æ¥æ§åˆ¶å®ƒæ’­æ”¾æˆ–è€…æš‚åœï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"<VideoPlayer isPlaying={isPlaying} />;\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"VideoPlayer\"}],\" ç»„ä»¶æ¸²æŸ“äº†æµè§ˆå™¨å†…ç½®çš„ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/video\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"<video>\"}]}],\" æ ‡ç­¾ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"function VideoPlayer({ src, isPlaying }) {\\r\\n  // TODOï¼šä½¿ç”¨ isPlaying åšä¸€äº›äº‹æƒ…\\r\\n  return <video src={src} />;\\r\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½†æ˜¯ï¼Œæµè§ˆå™¨çš„ \",[\"$r\",\"code\",null,{\"children\":\"<video>\"}],\" æ ‡ç­¾æ²¡æœ‰ \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" å±æ€§ã€‚æ§åˆ¶å®ƒçš„å”¯ä¸€æ–¹å¼æ˜¯åœ¨ DOM å…ƒç´ ä¸Šè°ƒç”¨ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLMediaElement/play\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"play()\"}]}],\" å’Œ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLMediaElement/pause\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"pause()\"}]}],\" æ–¹æ³•ã€‚å› æ­¤ï¼Œ\",[\"$r\",\"strong\",null,{\"children\":[\"ä½ éœ€è¦å°† \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" prop çš„å€¼ï¼ˆè¡¨ç¤ºè§†é¢‘å½“å‰æ˜¯å¦åº”è¯¥æ’­æ”¾ï¼‰ä¸ \",[\"$r\",\"code\",null,{\"children\":\"play()\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"pause()\"}],\" ç­‰å‡½æ•°çš„è°ƒç”¨è¿›è¡ŒåŒæ­¥\"]}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æˆ‘ä»¬é¦–å…ˆéœ€è¦è·å– \",[\"$r\",\"code\",null,{\"children\":\"<video>\"}],\" DOM èŠ‚ç‚¹çš„ \",[\"$r\",\"a\",null,{\"href\":\"/learn/manipulating-the-dom-with-refs\",\"children\":\"å¯¹è±¡å¼•ç”¨\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½ å¯èƒ½ä¼šå°è¯•åœ¨æ¸²æŸ“æœŸé—´è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"play()\"}],\" æˆ– \",[\"$r\",\"code\",null,{\"children\":\"pause()\"}],\"ï¼Œä½†è¿™æ ·åšæ˜¯ä¸å¯¹çš„ï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useRef, useEffect } from 'react';\\r\\n\\r\\nfunction VideoPlayer({ src, isPlaying }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  if (isPlaying) {\\r\\n    ref.current.play();  // æ¸²æŸ“æœŸé—´ä¸èƒ½è°ƒç”¨ `play()`ã€‚ \\r\\n  } else {\\r\\n    ref.current.pause(); // åŒæ ·ï¼Œè°ƒç”¨ `pause()` ä¹Ÿä¸è¡Œã€‚\\r\\n  }\\r\\n\\r\\n  return <video ref={ref} src={src} loop playsInline />;\\r\\n}\\r\\n\\r\\nexport default function App() {\\r\\n  const [isPlaying, setIsPlaying] = useState(false);\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setIsPlaying(!isPlaying)}>\\r\\n        {isPlaying ? 'æš‚åœ' : 'æ’­æ”¾'}\\r\\n      </button>\\r\\n      <VideoPlayer\\r\\n        isPlaying={isPlaying}\\r\\n        src=\\\"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4\\\"\\r\\n      />\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { display: block; margin-bottom: 20px; }\\r\\nvideo { width: 250px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"70\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™æ®µä»£ç ä¹‹æ‰€ä»¥ä¸å¯¹ï¼Œæ˜¯å› ä¸ºå®ƒè¯•å›¾åœ¨æ¸²æŸ“æœŸé—´å¯¹ DOM èŠ‚ç‚¹è¿›è¡Œæ“ä½œã€‚åœ¨ React ä¸­ï¼Œ\",[\"$r\",\"a\",null,{\"href\":\"/learn/keeping-components-pure\",\"children\":\"æ¸²æŸ“åº”è¯¥æ˜¯çº¯ç²¹çš„è®¡ç®—\"}],\" JSXï¼Œä¸åº”è¯¥åŒ…å«ä»»ä½•åƒä¿®æ”¹ DOM è¿™æ ·çš„å‰¯ä½œç”¨ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è€Œä¸”ï¼Œå½“ç¬¬ä¸€æ¬¡è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"VideoPlayer\"}],\" æ—¶ï¼Œå¯¹åº”çš„ DOM èŠ‚ç‚¹è¿˜ä¸å­˜åœ¨ï¼å› ä¸º React åœ¨ä½ è¿”å› JSX ä¹‹å‰ä¸çŸ¥é“è¦åˆ›å»ºä»€ä¹ˆæ ·çš„ DOMï¼Œæ‰€ä»¥æ²¡æœ‰ DOM èŠ‚ç‚¹å¯ä»¥è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"play()\"}],\" æˆ– \",[\"$r\",\"code\",null,{\"children\":\"pause()\"}],\" æ–¹æ³•ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è§£å†³åŠæ³•æ˜¯ \",[\"$r\",\"strong\",null,{\"children\":[\"ä½¿ç”¨ \",[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\" åŒ…è£¹å‰¯ä½œç”¨ï¼ŒæŠŠå®ƒåˆ†ç¦»åˆ°æ¸²æŸ“é€»è¾‘çš„è®¡ç®—è¿‡ç¨‹ä¹‹å¤–\"]}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{6,12}\",\"children\":\"import { useEffect, useRef } from 'react';\\r\\n\\r\\nfunction VideoPlayer({ src, isPlaying }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  useEffect(() => {\\r\\n    if (isPlaying) {\\r\\n      ref.current.play();\\r\\n    } else {\\r\\n      ref.current.pause();\\r\\n    }\\r\\n  });\\r\\n\\r\\n  return <video ref={ref} src={src} loop playsInline />;\\r\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"é€šè¿‡å°† DOM æ›´æ–°å°è£…åœ¨ Effect ä¸­ï¼Œä½ å¯ä»¥è®© React å…ˆæ›´æ–°é¡µé¢ï¼Œç„¶åå†è¿è¡Œ Effectã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å½“ \",[\"$r\",\"code\",null,{\"children\":\"VideoPlayer\"}],\" ç»„ä»¶æ¸²æŸ“æ—¶ï¼ˆæ— è®ºæ˜¯å¦ä¸ºé¦–æ¬¡æ¸²æŸ“ï¼‰ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹å‡ ä»¶äº‹ï¼šé¦–å…ˆ React ä¼šæ›´æ–°é¡µé¢ï¼Œç¡®ä¿ \",[\"$r\",\"code\",null,{\"children\":\"<video>\"}],\" æ ‡ç­¾å¸¦ç€æ­£ç¡®çš„ props å‡ºç°åœ¨ DOM ä¸­ï¼›æ¥ç€ React å°†è¿è¡Œ Effectï¼›æœ€å Effect å°†æ ¹æ® \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" çš„å€¼è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"play()\"}],\" æˆ– \",[\"$r\",\"code\",null,{\"children\":\"pause()\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¯•è¯•ç‚¹å‡»å‡ æ¬¡æ’­æ”¾å’Œæš‚åœæŒ‰é’®ï¼Œè§‚å¯Ÿè§†é¢‘æ’­æ”¾å™¨çš„è¡Œä¸ºæ˜¯å¦‚ä½•ä¸ \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" çš„å€¼ç›¸åŒæ­¥çš„ï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useRef, useEffect } from 'react';\\r\\n\\r\\nfunction VideoPlayer({ src, isPlaying }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  useEffect(() => {\\r\\n    if (isPlaying) {\\r\\n      ref.current.play();\\r\\n    } else {\\r\\n      ref.current.pause();\\r\\n    }\\r\\n  });\\r\\n\\r\\n  return <video ref={ref} src={src} loop playsInline />;\\r\\n}\\r\\n\\r\\nexport default function App() {\\r\\n  const [isPlaying, setIsPlaying] = useState(false);\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setIsPlaying(!isPlaying)}>\\r\\n        {isPlaying ? 'æš‚åœ' : 'æ’­æ”¾'}\\r\\n      </button>\\r\\n      <VideoPlayer\\r\\n        isPlaying={isPlaying}\\r\\n        src=\\\"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4\\\"\\r\\n      />\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { display: block; margin-bottom: 20px; }\\r\\nvideo { width: 250px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"86\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":\"åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä½ åŒæ­¥åˆ° React state çš„â€œå¤–éƒ¨ç³»ç»Ÿâ€æ˜¯æµè§ˆå™¨åª’ä½“ APIã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ–¹æ³•å°†ä¼ ç»Ÿçš„é React ä»£ç ï¼ˆå¦‚ jQuery æ’ä»¶ï¼‰å°è£…æˆå£°æ˜å¼çš„ React ç»„ä»¶ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ§åˆ¶è§†é¢‘æ’­æ”¾å™¨åœ¨å®é™…åº”ç”¨ä¸­è¦å¤æ‚å¾—å¤šï¼šæ¯”å¦‚è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"play()\"}],\" å¯èƒ½ä¼šå¤±è´¥ã€ç”¨æˆ·å¯èƒ½ä¼šä½¿ç”¨å†…ç½®çš„æµè§ˆå™¨æ§ä»¶æ¥è¿›è¡Œæ’­æ”¾æˆ–æš‚åœç­‰æ“ä½œã€‚æœ¬ä¾‹å­æ˜¯ä¸€ä¸ªéå¸¸ç®€åŒ–ä¸”ä¸å®Œæ•´çš„ç¤ºä¾‹ã€‚\"]}],\"\\n\",[\"$r\",\"Pitfall\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"é»˜è®¤æƒ…å†µä¸‹ï¼ŒEffect ä¼šåœ¨ \",[\"$r\",\"strong\",null,{\"children\":\"æ¯æ¬¡\"}],\" æ¸²æŸ“åè¿è¡Œã€‚\",[\"$r\",\"strong\",null,{\"children\":\"æ­£å› å¦‚æ­¤ï¼Œä»¥ä¸‹ä»£ç ä¼šé™·å…¥æ­»å¾ªç¯\"}],\"ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"const [count, setCount] = useState(0);\\r\\nuseEffect(() => {\\r\\n  setCount(count + 1);\\r\\n});\\n\"}]}],[\"$r\",\"p\",null,{\"children\":\"Effect åœ¨æ¸²æŸ“ç»“æŸåè¿è¡Œã€‚æ›´æ–° state ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚åœ¨ Effect ä¸­ç›´æ¥æ›´æ–° state å°±åƒæ˜¯æŠŠç”µæºæ’åº§çš„æ’å¤´æ’å›è‡ªèº«ï¼šEffect è¿è¡Œã€æ›´æ–° stateã€è§¦å‘é‡æ–°æ¸²æŸ“ã€äºæ˜¯åˆè§¦å‘ Effect è¿è¡Œã€å†æ¬¡æ›´æ–° stateï¼Œç»§è€Œå†æ¬¡è§¦å‘é‡æ–°æ¸²æŸ“ã€‚å¦‚æ­¤åå¤ï¼Œä»è€Œé™·å…¥æ­»å¾ªç¯ã€‚\"}],[\"$r\",\"p\",null,{\"children\":[\"Effect åº”è¯¥ç”¨äºå°†ä½ çš„ç»„ä»¶ä¸ä¸€ä¸ª \",[\"$r\",\"strong\",null,{\"children\":\"å¤–éƒ¨\"}],\" çš„ç³»ç»Ÿä¿æŒåŒæ­¥ã€‚å¦‚æœæ²¡æœ‰å¤–éƒ¨ç³»ç»Ÿï¼Œä½ åªæ˜¯æƒ³æ ¹æ®å…¶ä»–çŠ¶æ€è°ƒæ•´ä¸€äº›çŠ¶æ€ï¼Œé‚£ä¹ˆ \",[\"$r\",\"a\",null,{\"href\":\"/learn/you-might-not-need-an-effect\",\"children\":\"ä½ ä¹Ÿè®¸ä¸éœ€è¦ Effect\"}],\"ã€‚\"]}]]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"step-2-specify-the-effect-dependencies\",\"children\":\"ç¬¬äºŒæ­¥ï¼šæŒ‡å®š Effect çš„ä¾èµ–é¡¹ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"é»˜è®¤æƒ…å†µä¸‹ï¼ŒEffect ä¼šåœ¨ \",[\"$r\",\"strong\",null,{\"children\":\"æ¯æ¬¡\"}],\" æ¸²æŸ“åè¿è¡Œã€‚ä½†å¾€å¾€ \",[\"$r\",\"strong\",null,{\"children\":\"è¿™å¹¶ä¸æ˜¯ä½ æƒ³è¦çš„\"}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"æœ‰æ—¶ï¼Œå®ƒå¯èƒ½ä¼šå¾ˆæ…¢ã€‚ä¸å¤–éƒ¨ç³»ç»Ÿçš„åŒæ­¥å¹¶ä¸æ€»æ˜¯å³æ—¶çš„ï¼Œæ‰€ä»¥ä½ å¯èƒ½å¸Œæœ›åœ¨ä¸å¿…è¦æ—¶è·³è¿‡å®ƒã€‚ä¾‹å¦‚ï¼Œä½ ä¸ä¼šæƒ³åœ¨æ¯æ¬¡æ‰“å­—æ—¶éƒ½å¾—é‡æ–°è¿æ¥èŠå¤©æœåŠ¡å™¨ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"æœ‰æ—¶ï¼Œå®ƒå¯èƒ½ä¼šå‡ºé”™ã€‚ä¾‹å¦‚ï¼Œä½ ä¸ä¼šæƒ³åœ¨æ¯æ¬¡æŒ‰é”®æ—¶éƒ½è§¦å‘ç»„ä»¶çš„æ·¡å…¥åŠ¨ç”»ã€‚åŠ¨ç”»åº”è¯¥åªåœ¨ç»„ä»¶é¦–æ¬¡å‡ºç°æ—¶æ’­æ”¾ã€‚\"}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä¸ºäº†æ¼”ç¤ºè¿™ä¸ªé—®é¢˜ï¼Œä»¥ä¸‹æ˜¯åœ¨ä¹‹å‰çš„ç¤ºä¾‹ä¸­åŠ å…¥äº†ä¸€äº› \",[\"$r\",\"code\",null,{\"children\":\"console.log\"}],\" è°ƒç”¨å’Œä¸€ä¸ªæ›´æ–°çˆ¶ç»„ä»¶ state çš„æ–‡æœ¬è¾“å…¥æ¡†ã€‚æ³¨æ„åœ¨è¾“å…¥æ—¶æ˜¯å¦‚ä½•è§¦å‘ Effect é‡æ–°è¿è¡Œçš„ï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useRef, useEffect } from 'react';\\r\\n\\r\\nfunction VideoPlayer({ src, isPlaying }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  useEffect(() => {\\r\\n    if (isPlaying) {\\r\\n      console.log('è°ƒç”¨ video.play()');\\r\\n      ref.current.play();\\r\\n    } else {\\r\\n      console.log('è°ƒç”¨ video.pause()');\\r\\n      ref.current.pause();\\r\\n    }\\r\\n  });\\r\\n\\r\\n  return <video ref={ref} src={src} loop playsInline />;\\r\\n}\\r\\n\\r\\nexport default function App() {\\r\\n  const [isPlaying, setIsPlaying] = useState(false);\\r\\n  const [text, setText] = useState('');\\r\\n  return (\\r\\n    <>\\r\\n      <input value={text} onChange={e => setText(e.target.value)} />\\r\\n      <button onClick={() => setIsPlaying(!isPlaying)}>\\r\\n        {isPlaying ? 'æš‚åœ' : 'æ’­æ”¾'}\\r\\n      </button>\\r\\n      <VideoPlayer\\r\\n        isPlaying={isPlaying}\\r\\n        src=\\\"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4\\\"\\r\\n      />\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input, button { display: block; margin-bottom: 20px; }\\r\\nvideo { width: 250px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"94\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"é€šè¿‡åœ¨è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\" æ—¶æŒ‡å®šä¸€ä¸ª \",[\"$r\",\"strong\",null,{\"children\":\"ä¾èµ–æ•°ç»„\"}],\" ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œä½ å¯ä»¥è®© React \",[\"$r\",\"strong\",null,{\"children\":\"è·³è¿‡ä¸å¿…è¦åœ°é‡æ–°è¿è¡Œ Effect\"}],\"ã€‚é¦–å…ˆï¼Œåœ¨ä¸Šé¢ç¤ºä¾‹çš„ç¬¬ 14 è¡Œä¸­ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ \",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3}\",\"children\":\"  useEffect(() => {\\r\\n    // ...\\r\\n  }, []);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½ ä¼šçœ‹åˆ°ä¸€ä¸ªé”™è¯¯æç¤ºï¼š\",[\"$r\",\"code\",null,{\"children\":\"React Hook useEffect has a missing dependency: 'isPlaying'\"}],\"ï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useRef, useEffect } from 'react';\\r\\n\\r\\nfunction VideoPlayer({ src, isPlaying }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  useEffect(() => {\\r\\n    if (isPlaying) {\\r\\n      console.log('è°ƒç”¨ video.play()');\\r\\n      ref.current.play();\\r\\n    } else {\\r\\n      console.log('è°ƒç”¨ video.pause()');\\r\\n      ref.current.pause();\\r\\n    }\\r\\n  }, []); // è¿™å°†äº§ç”Ÿé”™è¯¯\\r\\n\\r\\n  return <video ref={ref} src={src} loop playsInline />;\\r\\n}\\r\\n\\r\\nexport default function App() {\\r\\n  const [isPlaying, setIsPlaying] = useState(false);\\r\\n  const [text, setText] = useState('');\\r\\n  return (\\r\\n    <>\\r\\n      <input value={text} onChange={e => setText(e.target.value)} />\\r\\n      <button onClick={() => setIsPlaying(!isPlaying)}>\\r\\n        {isPlaying ? 'æš‚åœ' : 'æ’­æ”¾'}\\r\\n      </button>\\r\\n      <VideoPlayer\\r\\n        isPlaying={isPlaying}\\r\\n        src=\\\"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4\\\"\\r\\n      />\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input, button { display: block; margin-bottom: 20px; }\\r\\nvideo { width: 250px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"102\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åŸå› åœ¨äºï¼Œä½ çš„ Effect å†…éƒ¨ä»£ç ä¾èµ–äº \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" prop æ¥å†³å®šè¯¥åšä»€ä¹ˆï¼Œä½†ä½ å¹¶æ²¡æœ‰æ˜¾å¼å£°æ˜è¿™ä¸ªä¾èµ–å…³ç³»ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°† \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" æ·»åŠ è‡³ä¾èµ–æ•°ç»„ä¸­ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2,7}\",\"children\":\"  useEffect(() => {\\r\\n    if (isPlaying) { // isPlaying åœ¨æ­¤å¤„ä½¿ç”¨â€¦â€¦\\r\\n      // ...\\r\\n    } else {\\r\\n      // ...\\r\\n    }\\r\\n  }, [isPlaying]); // â€¦â€¦æ‰€ä»¥å®ƒå¿…é¡»åœ¨æ­¤å¤„å£°æ˜ï¼\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨æ‰€æœ‰çš„ä¾èµ–éƒ½å·²ç»å£°æ˜ï¼Œæ‰€ä»¥æ²¡æœ‰é”™è¯¯äº†ã€‚æŒ‡å®š \",[\"$r\",\"code\",null,{\"children\":\"[isPlaying]\"}],\" ä½œä¸ºä¾èµ–æ•°ç»„ä¼šå‘Šè¯‰ Reactï¼šå¦‚æœ \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" ä¸ä¸Šæ¬¡æ¸²æŸ“æ—¶ç›¸åŒï¼Œå°±è·³è¿‡é‡æ–°è¿è¡Œ Effectã€‚è¿™æ ·ä¸€æ¥ï¼Œè¾“å…¥æ¡†çš„è¾“å…¥ä¸ä¼šè§¦å‘ Effect é‡æ–°è¿è¡Œï¼Œåªæœ‰æŒ‰ä¸‹æ’­æ”¾/æš‚åœæŒ‰é’®ä¼šè§¦å‘ã€‚\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useRef, useEffect } from 'react';\\r\\n\\r\\nfunction VideoPlayer({ src, isPlaying }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  useEffect(() => {\\r\\n    if (isPlaying) {\\r\\n      console.log('è°ƒç”¨ video.play()');\\r\\n      ref.current.play();\\r\\n    } else {\\r\\n      console.log('è°ƒç”¨ video.pause()');\\r\\n      ref.current.pause();\\r\\n    }\\r\\n  }, [isPlaying]);\\r\\n\\r\\n  return <video ref={ref} src={src} loop playsInline />;\\r\\n}\\r\\n\\r\\nexport default function App() {\\r\\n  const [isPlaying, setIsPlaying] = useState(false);\\r\\n  const [text, setText] = useState('');\\r\\n  return (\\r\\n    <>\\r\\n      <input value={text} onChange={e => setText(e.target.value)} />\\r\\n      <button onClick={() => setIsPlaying(!isPlaying)}>\\r\\n        {isPlaying ? 'æš‚åœ' : 'æ’­æ”¾'}\\r\\n      </button>\\r\\n      <VideoPlayer\\r\\n        isPlaying={isPlaying}\\r\\n        src=\\\"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4\\\"\\r\\n      />\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input, button { display: block; margin-bottom: 20px; }\\r\\nvideo { width: 250px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"128\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä¾èµ–æ•°ç»„å¯ä»¥åŒ…å«å¤šä¸ªä¾èµ–é¡¹ã€‚åªæœ‰å½“ä½ æŒ‡å®šçš„ \",[\"$r\",\"strong\",null,{\"children\":\"æ‰€æœ‰\"}],\" ä¾èµ–é¡¹çš„å€¼éƒ½ä¸ä¸Šä¸€æ¬¡æ¸²æŸ“æ—¶å®Œå…¨ç›¸åŒï¼ŒReact æ‰ä¼šè·³è¿‡é‡æ–°è¿è¡Œè¯¥ Effectã€‚React ä½¿ç”¨ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"Object.is\"}]}],\" æ¥æ¯”è¾ƒä¾èµ–é¡¹çš„å€¼ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/useEffect#reference\",\"children\":[[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\" å‚è€ƒæ–‡æ¡£\"]}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"è¯·æ³¨æ„ï¼Œä½ ä¸èƒ½éšæ„â€œé€‰æ‹©â€ä¾èµ–é¡¹\"}],\"ã€‚å¦‚æœä½ æŒ‡å®šçš„ä¾èµ–é¡¹ä¸ React æ ¹æ® Effect å†…éƒ¨ä»£ç æ‰€æ¨æ–­å‡ºçš„ä¾èµ–é¡¹ä¸åŒ¹é…ï¼Œä½ å°†æ”¶åˆ°æ¥è‡ª lint çš„é”™è¯¯æç¤ºã€‚è¿™æœ‰åŠ©äºæ•æ‰ä»£ç ä¸­çš„è®¸å¤š bugã€‚å¦‚æœä½ ä¸å¸Œæœ›æŸäº›ä»£ç é‡æ–°è¿è¡Œï¼Œ\",[\"$r\",\"a\",null,{\"href\":\"/learn/lifecycle-of-reactive-effects#what-to-do-when-you-dont-want-to-re-synchronize\",\"children\":[\"é‚£ä¹ˆä½ åº”å½“ \",[\"$r\",\"strong\",null,{\"children\":\"ä¿®æ”¹ Effect ä»£ç æœ¬èº«\"}],\"ï¼Œä½¿å…¶ä¸å†â€œéœ€è¦â€è¯¥ä¾èµ–é¡¹\"]}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"Pitfall\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"æ²¡æœ‰ä¾èµ–æ•°ç»„å’Œä½¿ç”¨ç©ºæ•°ç»„ \",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\" ä½œä¸ºä¾èµ–æ•°ç»„ï¼Œè¡Œä¸ºæ˜¯ä¸åŒçš„ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{3,7,11}\",\"children\":\"useEffect(() => {\\r\\n  // è¿™é‡Œçš„ä»£ç ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åè¿è¡Œ\\r\\n});\\r\\n\\r\\nuseEffect(() => {\\r\\n  // è¿™é‡Œçš„ä»£ç åªä¼šåœ¨ç»„ä»¶æŒ‚è½½ï¼ˆé¦–æ¬¡å‡ºç°ï¼‰æ—¶è¿è¡Œ\\r\\n}, []);\\r\\n\\r\\nuseEffect(() => {\\r\\n  // è¿™é‡Œçš„ä»£ç ä¸ä½†ä¼šåœ¨ç»„ä»¶æŒ‚è½½æ—¶è¿è¡Œï¼Œè€Œä¸”å½“ a æˆ– b çš„å€¼è‡ªä¸Šæ¬¡æ¸²æŸ“åå‘ç”Ÿå˜åŒ–åä¹Ÿä¼šè¿è¡Œ\\r\\n}, [a, b]);\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€æ­¥è¯¦ç»†äº†è§£ä»€ä¹ˆæ˜¯ \",[\"$r\",\"strong\",null,{\"children\":\"æŒ‚è½½ï¼ˆmountï¼‰\"}],\"ã€‚\"]}]]}],\"\\n\",[\"$r\",\"DeepDive\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"why-was-the-ref-omitted-from-the-dependency-array\",\"children\":\"ä¸ºä»€ä¹ˆä¾èµ–æ•°ç»„ä¸­å¯ä»¥çœç•¥ ref? \"}],[\"$r\",\"p\",null,{\"children\":[\"ä¸‹é¢çš„ Effect åŒæ—¶ä½¿ç”¨äº† \",[\"$r\",\"code\",null,{\"children\":\"ref\"}],\" ä¸ \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" propï¼Œä½†æ˜¯åªæœ‰ \",[\"$r\",\"code\",null,{\"children\":\"isPlaying\"}],\" è¢«å£°æ˜ä¸ºä¾èµ–é¡¹ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{9}\",\"children\":\"function VideoPlayer({ src, isPlaying }) {\\r\\n  const ref = useRef(null);\\r\\n  useEffect(() => {\\r\\n    if (isPlaying) {\\r\\n      ref.current.play();\\r\\n    } else {\\r\\n      ref.current.pause();\\r\\n    }\\r\\n  }, [isPlaying]);\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™æ˜¯å› ä¸º \",[\"$r\",\"code\",null,{\"children\":\"ref\"}],\" å…·æœ‰ \",[\"$r\",\"strong\",null,{\"children\":\"ç¨³å®š\"}],\" çš„æ ‡è¯†ï¼šReact ç¡®ä¿ä½ åœ¨ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/useRef#returns\",\"children\":[\"æ¯è½®æ¸²æŸ“ä¸­è°ƒç”¨åŒä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"useRef\"}],\" æ—¶ï¼Œæ€»èƒ½è·å¾—ç›¸åŒçš„å¯¹è±¡\"]}],\"ã€‚ref ä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥å®ƒä¸ä¼šå¯¼è‡´é‡æ–°è¿è¡Œ Effectã€‚å› æ­¤ï¼Œåœ¨ä¾èµ–æ•°ç»„ä¸­å®ƒå¯æœ‰å¯æ— ã€‚æŠŠå®ƒåŠ è¿›å»ä¹Ÿå¯ä»¥ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{9}\",\"children\":\"function VideoPlayer({ src, isPlaying }) {\\r\\n  const ref = useRef(null);\\r\\n  useEffect(() => {\\r\\n    if (isPlaying) {\\r\\n      ref.current.play();\\r\\n    } else {\\r\\n      ref.current.pause();\\r\\n    }\\r\\n  }, [isPlaying, ref]);\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"useState\"}],\" è¿”å›çš„ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/useState#setstate\",\"children\":[[\"$r\",\"code\",null,{\"children\":\"set\"}],\" å‡½æ•°\"]}],\" ä¹Ÿå…·æœ‰ç¨³å®šçš„æ ‡è¯†ï¼Œå› æ­¤å®ƒä»¬é€šå¸¸ä¹Ÿä¼šè¢«çœç•¥ã€‚å¦‚æœåœ¨çœç•¥æŸä¸ªä¾èµ–é¡¹æ—¶ linter ä¸ä¼šæŠ¥é”™ï¼Œé‚£ä¹ˆè¿™ä¹ˆåšå°±æ˜¯å®‰å…¨çš„ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"çœç•¥å§‹ç»ˆç¨³å®šçš„ä¾èµ–é¡¹ä»…åœ¨ linter èƒ½â€œçœ‹åˆ°â€å¯¹è±¡æ˜¯ç¨³å®šçš„æ—¶å€™æ‰æœ‰æ•ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœ \",[\"$r\",\"code\",null,{\"children\":\"ref\"}],\" æ˜¯ä»çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„ï¼Œåˆ™å¿…é¡»åœ¨ä¾èµ–æ•°ç»„ä¸­æŒ‡å®šå®ƒã€‚è¿™å¾ˆæœ‰å¿…è¦ï¼Œå› ä¸ºä½ æ— æ³•ç¡®å®šçˆ¶ç»„ä»¶æ˜¯ä¸€ç›´ä¼ é€’ç›¸åŒçš„ refï¼Œè¿˜æ˜¯æ ¹æ®æ¡ä»¶ä¼ é€’ä¸åŒçš„ refã€‚æ‰€ä»¥ï¼Œä½ çš„ Effect ä¼šä¾èµ–äºè¢«ä¼ é€’çš„æ˜¯å“ªä¸ª refã€‚\"]}]]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"step-3-add-cleanup-if-needed\",\"children\":\"ç¬¬ä¸‰æ­¥ï¼šæŒ‰éœ€æ·»åŠ æ¸…ç†ï¼ˆcleanupï¼‰å‡½æ•° \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è€ƒè™‘ä¸€ä¸ªä¸åŒçš„ä¾‹å­ã€‚å‡å¦‚ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" ç»„ä»¶ï¼Œè¯¥ç»„ä»¶åœ¨æ˜¾ç¤ºæ—¶éœ€è¦è¿æ¥åˆ°èŠå¤©æœåŠ¡å™¨ã€‚ç°åœ¨ä¸ºä½ æä¾›äº† \",[\"$r\",\"code\",null,{\"children\":\"createConnection()\"}],\" APIï¼Œè¯¥ API è¿”å›ä¸€ä¸ªåŒ…å« \",[\"$r\",\"code\",null,{\"children\":\"connect()\"}],\" ä¸ \",[\"$r\",\"code\",null,{\"children\":\"disconnection()\"}],\" æ–¹æ³•çš„å¯¹è±¡ã€‚å¦‚ä½•ç¡®ä¿ç»„ä»¶åœ¨æ˜¾ç¤ºæ—¶å§‹ç»ˆä¿æŒè¿æ¥ï¼Ÿ\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä»ç¼–å†™ Effect çš„é€»è¾‘å¼€å§‹ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"useEffect(() => {\\r\\n  const connection = createConnection();\\r\\n  connection.connect();\\r\\n});\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å¦‚æœæ¯æ¬¡é‡æ–°æ¸²æŸ“åéƒ½å¾—è¿›è¡Œè¿æ¥ï¼Œè¿™ä¼šå¾ˆæ…¢ï¼Œæ‰€ä»¥ä½ éœ€è¦æ·»åŠ ä¾èµ–æ•°ç»„ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4}\",\"children\":\"useEffect(() => {\\r\\n  const connection = createConnection();\\r\\n  connection.connect();\\r\\n}, []);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":[\"ç”±äº Effect ä¸­çš„ä»£ç æ²¡æœ‰ä½¿ç”¨ä»»ä½• props æˆ– stateï¼Œæ‰€ä»¥ä¾èµ–æ•°ç»„ä¸ºç©ºæ•°ç»„ \",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ã€‚è¿™å‘Šè¯‰ React ä»…åœ¨ç»„ä»¶â€œæŒ‚è½½â€ï¼ˆå³é¦–æ¬¡æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼‰æ—¶è¿è¡Œæ­¤ä»£ç \"]}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¯•è¯•è¿è¡Œä¸‹é¢çš„ä»£ç ï¼š\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useEffect } from 'react';\\r\\nimport { createConnection } from './chat.js';\\r\\n\\r\\nexport default function ChatRoom() {\\r\\n  useEffect(() => {\\r\\n    const connection = createConnection();\\r\\n    connection.connect();\\r\\n  }, []);\\r\\n  return <h1>æ¬¢è¿æ¥åˆ°èŠå¤©å®¤ï¼</h1>;\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection() {\\r\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\r\\n  return {\\r\\n    connect() {\\r\\n      console.log('âœ… è¿æ¥ä¸­â€¦â€¦');\\r\\n    },\\r\\n    disconnect() {\\r\\n      console.log('âŒ è¿æ¥æ–­å¼€ã€‚');\\r\\n    }\\r\\n  };\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input { display: block; margin-bottom: 20px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"144\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™é‡Œçš„ Effect ä»…åœ¨ç»„ä»¶æŒ‚è½½æ—¶è¿è¡Œï¼Œæ‰€ä»¥ä½ å¯èƒ½ä»¥ä¸º \",[\"$r\",\"code\",null,{\"children\":\"\\\"âœ… è¿æ¥ä¸­â€¦â€¦\\\"\"}],\" åªä¼šåœ¨æ§åˆ¶å°ä¸­è¢«æ‰“å°ä¸€æ¬¡ã€‚\",[\"$r\",\"strong\",null,{\"children\":[\"ç„¶è€Œå®é™…æƒ…å†µæ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"\\\"âœ… è¿æ¥ä¸­â€¦â€¦\\\"\"}],\" è¢«æ‰“å°äº†ä¸¤æ¬¡ï¼ä¸ºä»€ä¹ˆä¼šè¿™æ ·\"]}],\"ï¼Ÿ\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å‡è®¾ \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" ç»„ä»¶æ˜¯ä¸€ä¸ªå¤§å‹å¤šé¡µé¢åº”ç”¨ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ç”¨æˆ·æœ€åˆåœ¨ \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" é¡µé¢ä¸Šã€‚ç»„ä»¶æŒ‚è½½å¹¶è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"connection.connect()\"}],\" ã€‚æ¥ç€ç”¨æˆ·å¯èƒ½ä¼šå¯¼èˆªåˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œæ¯”å¦‚åˆ‡æ¢åˆ°â€œè®¾ç½®â€é¡µé¢ï¼Œäºæ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" ç»„ä»¶è¢«å¸è½½ã€‚æœ€åï¼Œå½“ç”¨æˆ·ç‚¹å‡»â€œè¿”å›â€æ—¶ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" ç»„ä»¶å†æ¬¡æŒ‚è½½ã€‚è¿™å°†å»ºç«‹ç¬¬äºŒä¸ªè¿æ¥â€”â€”ä½†ç¬¬ä¸€ä¸ªè¿æ¥ä»æœªè¢«é”€æ¯ï¼éšç€ç”¨æˆ·åœ¨åº”ç”¨ä¸­æ¥å›åˆ‡æ¢ï¼Œè¿æ¥å°†ä¼šä¸æ–­ç´¯ç§¯ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™ç±» bug åœ¨æ²¡æœ‰å¤§é‡æ‰‹åŠ¨æµ‹è¯•çš„æƒ…å†µä¸‹å¾ˆå®¹æ˜“è¢«å¿½ç•¥ã€‚ä¸ºäº†å¸®åŠ©ä½ å¿«é€Ÿå‘ç°å®ƒä»¬ï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸­ï¼ŒReact ä¼šåœ¨ç»„ä»¶é¦–æ¬¡æŒ‚è½½åç«‹å³é‡æ–°æŒ‚è½½ä¸€æ¬¡ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä¸¤æ¬¡å‡ºç° \",[\"$r\",\"code\",null,{\"children\":\"\\\"âœ… è¿æ¥ä¸­â€¦â€¦\\\"\"}],\" èƒ½å¤Ÿå¸®åŠ©ä½ æ³¨æ„åˆ°çœŸæ­£çš„é—®é¢˜ï¼šåœ¨ä»£ç ä¸­ï¼Œç»„ä»¶è¢«å¸è½½æ—¶æ²¡æœ‰å…³é—­è¿æ¥ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åœ¨ Effect ä¸­è¿”å›ä¸€ä¸ª \",[\"$r\",\"strong\",null,{\"children\":\"æ¸…ç†ï¼ˆcleanupï¼‰å‡½æ•°\"}],\" ã€‚\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4-6}\",\"children\":\"  useEffect(() => {\\r\\n    const connection = createConnection();\\r\\n    connection.connect();\\r\\n    return () => {\\r\\n      connection.disconnect();\\r\\n    };\\r\\n  }, []);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"React ä¼šåœ¨æ¯æ¬¡ Effect é‡æ–°è¿è¡Œä¹‹å‰è°ƒç”¨æ¸…ç†å‡½æ•°ï¼Œå¹¶åœ¨ç»„ä»¶å¸è½½ï¼ˆè¢«ç§»é™¤ï¼‰æ—¶æœ€åä¸€æ¬¡è°ƒç”¨æ¸…ç†å‡½æ•°ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ç°æ¸…ç†å‡½æ•°åä¼šå‘ç”Ÿä»€ä¹ˆï¼š\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\r\\nimport { createConnection } from './chat.js';\\r\\n\\r\\nexport default function ChatRoom() {\\r\\n  useEffect(() => {\\r\\n    const connection = createConnection();\\r\\n    connection.connect();\\r\\n    return () => connection.disconnect();\\r\\n  }, []);\\r\\n  return <h1>æ¬¢è¿æ¥åˆ°èŠå¤©å®¤ï¼</h1>;\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/chat.js\",\"children\":\"export function createConnection() {\\r\\n  // çœŸæ­£çš„å®ç°å®é™…ä¸Šä¼šè¿æ¥åˆ°æœåŠ¡å™¨\\r\\n  return {\\r\\n    connect() {\\r\\n      console.log('âœ… è¿æ¥ä¸­â€¦â€¦');\\r\\n    },\\r\\n    disconnect() {\\r\\n      console.log('âŒ è¿æ¥æ–­å¼€ã€‚');\\r\\n    }\\r\\n  };\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"input { display: block; margin-bottom: 20px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"252\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ç°åœ¨åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œä½ ä¼šçœ‹åˆ°ä¸‰æ¡æ§åˆ¶å°æ—¥å¿—ï¼š\"}],\"\\n\",[\"$r\",\"ol\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"$r\",\"code\",null,{\"children\":\"\\\"âœ… è¿æ¥ä¸­â€¦â€¦\\\"\"}]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"$r\",\"code\",null,{\"children\":\"\\\"âŒ è¿æ¥æ–­å¼€ã€‚\\\"\"}]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"$r\",\"code\",null,{\"children\":\"\\\"âœ… è¿æ¥ä¸­â€¦â€¦\\\"\"}]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œè¿™æ˜¯æ­£ç¡®çš„è¡Œä¸º\"}],\"ã€‚é€šè¿‡é‡æ–°æŒ‚è½½ä½ çš„ç»„ä»¶ï¼ŒReact éªŒè¯äº†ç¦»å¼€é¡µé¢å†è¿”å›ä¸ä¼šå¯¼è‡´ä»£ç å‡ºé”™ã€‚å› ä¸ºæœ¬å°±åº”è¯¥å…ˆæ–­å¼€ç„¶åå†é‡æ–°è¿æ¥ï¼å¦‚æœä½ å¾ˆå¥½åœ°å®ç°äº†æ¸…ç†å‡½æ•°ï¼Œé‚£ä¹ˆæ— è®ºæ˜¯åªæ‰§è¡Œä¸€æ¬¡ Effect ï¼Œè¿˜æ˜¯æ‰§è¡Œã€æ¸…ç†ã€å†æ‰§è¡Œï¼Œéƒ½åº”è¯¥æ²¡æœ‰ç”¨æˆ·å¯è§çš„åŒºåˆ«ã€‚ä¹‹æ‰€ä»¥ä¼šæœ‰é¢å¤–çš„ä¸€æ¬¡ connect/disconnect è°ƒç”¨ï¼Œæ˜¯å› ä¸ºåœ¨å¼€å‘ç¯å¢ƒä¸‹ React åœ¨æ£€æµ‹ä½ ä»£ç ä¸­çš„ bugã€‚å› æ­¤è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œä¸è¦å»è¯•å›¾æ¶ˆé™¤å®ƒï¼\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":[\"åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œä½ åªä¼šçœ‹åˆ° \",[\"$r\",\"code\",null,{\"children\":\"\\\"âœ… è¿æ¥ä¸­â€¦â€¦\\\"\"}],\" æ‰“å°ä¸€æ¬¡\"]}],\"ã€‚è¿™æ˜¯å› ä¸ºé‡æ–°æŒ‚è½½ç»„ä»¶åªä¼šåœ¨å¼€å‘ç¯å¢ƒä¸‹å‘ç”Ÿï¼Œä»¥æ­¤å¸®åŠ©ä½ æ‰¾åˆ°éœ€è¦æ¸…ç†çš„ Effectã€‚ä½ å¯ä»¥é€šè¿‡å…³é—­ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/StrictMode\",\"children\":\"ä¸¥æ ¼æ¨¡å¼\"}],\" æ¥ç¦ç”¨è¿™ä¸ªè¡Œä¸ºï¼Œä½†æˆ‘ä»¬å»ºè®®ä¿ç•™å®ƒã€‚å®ƒå¯ä»¥å¸®åŠ©ä½ å‘ç°è®¸å¤šç±»ä¼¼ä¸Šè¿°çš„ bugã€‚\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"how-to-handle-the-effect-firing-twice-in-development\",\"children\":\"å¦‚ä½•å¤„ç†åœ¨å¼€å‘ç¯å¢ƒä¸‹ Effect è¿è¡Œäº†ä¸¤æ¬¡ï¼Ÿ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"React æœ‰æ„åœ¨å¼€å‘ç¯å¢ƒä¸‹é‡æ–°æŒ‚è½½ä½ çš„ç»„ä»¶ï¼Œæ¥æ‰¾åˆ°ç±»ä¼¼ä¸Šä¾‹ä¸­çš„ bugã€‚\",[\"$r\",\"strong\",null,{\"children\":\"ä½ éœ€è¦æ€è€ƒçš„ä¸æ˜¯â€œå¦‚ä½•åªè¿è¡Œä¸€æ¬¡ Effectâ€ï¼Œè€Œæ˜¯â€œå¦‚ä½•ä¿®å¤æˆ‘çš„ Effect æ¥è®©å®ƒåœ¨é‡æ–°æŒ‚è½½åæ­£å¸¸è¿è¡Œâ€\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"é€šå¸¸ï¼Œç­”æ¡ˆæ˜¯å®ç°æ¸…ç†å‡½æ•°ã€‚æ¸…ç†å‡½æ•°åº”è¯¥åœæ­¢æˆ–æ’¤é”€ Effect æ‰€åšçš„ä¸€åˆ‡ã€‚åŸåˆ™æ˜¯ç”¨æˆ·ä¸åº”è¯¥æ„Ÿå—åˆ° Effect åªæ‰§è¡Œä¸€æ¬¡ï¼ˆåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼‰å’Œè¿ç»­æ‰§è¡Œâ€œæŒ‚è½½ â†’ æ¸…ç† â†’ æŒ‚è½½â€ï¼ˆåœ¨å¼€å‘ç¯å¢ƒä¸­ï¼‰ä¹‹é—´çš„åŒºåˆ«ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä½ å°†ç¼–å†™çš„å¤§å¤šæ•° Effect éƒ½ä¼šç¬¦åˆä¸‹åˆ—çš„å¸¸è§æ¨¡å¼ä¹‹ä¸€ã€‚\"}],\"\\n\",[\"$r\",\"Pitfall\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"dont-use-refs-to-prevent-effects-from-firing\",\"children\":\"ä¸è¦ä½¿ç”¨ ref æ¥é˜²æ­¢è§¦å‘ Effect \"}],[\"$r\",\"p\",null,{\"children\":[\"ä¸ºäº†é˜²æ­¢ Effect åœ¨å¼€å‘ç¯å¢ƒä¸­è§¦å‘ä¸¤æ¬¡ï¼Œä¸€ä¸ªå¸¸è§é”™è¯¯æ˜¯ä½¿ç”¨ \",[\"$r\",\"code\",null,{\"children\":\"ref\"}],\" æ¥è®© Effect åªè¿è¡Œä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šç”¨ \",[\"$r\",\"code\",null,{\"children\":\"useRef\"}],\" â€œä¿®å¤â€ä¸Šè¿°çš„ bugï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{1,3-4}\",\"children\":\"  const connectionRef = useRef(null);\\r\\n  useEffect(() => {\\r\\n    // ğŸš© è¿™å¹¶ä¸èƒ½ä¿®å¤è¿™ä¸ª bugï¼ï¼ï¼\\r\\n    if (!connectionRef.current) {\\r\\n      connectionRef.current = createConnection();\\r\\n      connectionRef.current.connect();\\r\\n    }\\r\\n  }, []);\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"å®ƒè™½ç„¶ä½¿ä½ åœ¨å¼€å‘ç¯å¢ƒä¸‹åªçœ‹åˆ°ä¸€æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"â€œâœ… æ­£åœ¨è¿æ¥...â€\"}],\"ï¼Œä½†å¹¶æ²¡æœ‰ä¿®å¤è¿™ä¸ª bugã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"å½“ç”¨æˆ·ç¦»å¼€æ—¶ï¼Œè¿æ¥æ²¡æœ‰è¢«å…³é—­ï¼Œå½“ç”¨æˆ·è¿”å›æ—¶ï¼Œåˆä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ã€‚éšç€ç”¨æˆ·æµè§ˆåº”ç”¨ï¼Œè¿æ¥ä¼šä¸æ–­ç´¯ç§¯ï¼Œå°±åƒâ€œä¿®å¤â€ä¹‹å‰ä¸€æ ·ã€‚\"}],[\"$r\",\"p\",null,{\"children\":\"è¦ä¿®å¤è¿™ä¸ª bugï¼Œä»…ä»…è®© Effect åªè¿è¡Œä¸€æ¬¡æ˜¯ä¸å¤Ÿçš„ã€‚æƒ³è¦ Effect åœ¨é‡æ–°æŒ‚è½½åæ­£å¸¸è¿è¡Œï¼Œå°±å¾—æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•æ¸…é™¤è¿æ¥ã€‚\"}],[\"$r\",\"p\",null,{\"children\":\"è¯·çœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼Œäº†è§£å¦‚ä½•å¤„ç†å¸¸è§æ¨¡å¼ã€‚\"}]]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"controlling-non-react-widgets\",\"children\":\"ç®¡ç†é React å°éƒ¨ä»¶ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æœ‰æ—¶ä½ éœ€è¦æ·»åŠ ä¸æ˜¯ç”¨ React å®ç°çš„ UI å°éƒ¨ä»¶ã€‚æ¯”å¦‚è¯´ä½ æƒ³åœ¨ä½ çš„é¡µé¢æ·»åŠ ä¸€ä¸ªåœ°å›¾ç»„ä»¶ã€‚å®ƒæœ‰ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"setZoomLevel()\"}],\" æ–¹æ³•ï¼Œç„¶åä½ å¸Œæœ›åœ°å›¾çš„ç¼©æ”¾æ¯”ä¾‹å’Œä»£ç ä¸­çš„ \",[\"$r\",\"code\",null,{\"children\":\"zoomLevel\"}],\" state ä¿æŒåŒæ­¥ã€‚ä½ çš„ Effect åº”è¯¥ç±»ä¼¼äºï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"useEffect(() => {\\r\\n  const map = mapRef.current;\\r\\n  map.setZoomLevel(zoomLevel);\\r\\n}, [zoomLevel]);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¯·æ³¨æ„ï¼Œè¿™ç§æƒ…å†µä¸‹ä¸éœ€è¦æ¸…ç†æ“ä½œã€‚åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œè™½ç„¶ React ä¼šè°ƒç”¨ Effect ä¸¤æ¬¡ï¼Œä½†è¿™æ²¡å…³ç³»ï¼Œå› ä¸ºç”¨ç›¸åŒçš„å€¼è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setZoomLevel\"}],\" ä¸¤æ¬¡ä¸ä¼šé€ æˆä»»ä½•å½±å“ã€‚è™½ç„¶åœ¨å¼€å‘ç¯å¢ƒä¸‹å®ƒå¯èƒ½ä¼šç¨å¾®æ…¢ä¸€äº›ï¼Œä½†é—®é¢˜ä¸å¤§ï¼Œå› ä¸ºåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å®ƒä¸ä¼šå¤šä½™åœ°é‡æ–°æŒ‚è½½ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æœ‰äº› API å¯èƒ½ä¸å…è®¸ä½ è¿ç»­è°ƒç”¨ä¸¤æ¬¡ã€‚ä¾‹å¦‚ï¼Œå†…ç½®çš„ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLDialogElement\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"<dialog>\"}]}],\" å…ƒç´ çš„ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLDialogElement/showModal\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"showModal\"}]}],\" æ–¹æ³•åœ¨è¿ç»­è¢«è°ƒç”¨ä¸¤æ¬¡æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚æ­¤æ—¶å¯ä»¥é€šè¿‡å®ç°æ¸…ç†å‡½æ•°æ¥ä½¿å…¶å…³é—­å¯¹è¯æ¡†ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4}\",\"children\":\"useEffect(() => {\\r\\n  const dialog = dialogRef.current;\\r\\n  dialog.showModal();\\r\\n  return () => dialog.close();\\r\\n}, []);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œä½ çš„ Effect ä¼šå…ˆè°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"showModal()\"}],\"ï¼Œç„¶åç«‹å³è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"close()\"}],\"ï¼Œä¹‹åå†æ¬¡è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"showModal()\"}],\"ã€‚è¿™ä¸åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åªè°ƒç”¨ä¸€æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"showModal()\"}],\" çš„ç”¨æˆ·å¯è§è¡Œä¸ºæ˜¯ç›¸åŒçš„ã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"subscribing-to-events\",\"children\":\"è®¢é˜…äº‹ä»¶ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å¦‚æœä½ çš„ Effect è®¢é˜…äº†æŸäº›äº‹ä»¶ï¼Œæ¸…ç†å‡½æ•°åº”é€€è®¢è¿™äº›äº‹ä»¶ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{6}\",\"children\":\"useEffect(() => {\\r\\n  function handleScroll(e) {\\r\\n    console.log(window.scrollX, window.scrollY);\\r\\n  }\\r\\n  window.addEventListener('scroll', handleScroll);\\r\\n  return () => window.removeEventListener('scroll', handleScroll);\\r\\n}, []);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œä½ çš„ Effect ä¼šå…ˆè°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"addEventListener()\"}],\"ï¼Œç„¶åç«‹å³è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"removeEventListener()\"}],\"ï¼Œæ¥ç€å†æ¬¡ä½¿ç”¨ç›¸åŒçš„å¤„ç†å‡½æ•°è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"addEventListener()\"}],\"ã€‚å› æ­¤ï¼Œæ¯æ¬¡åªä¼šæœ‰ä¸€ä¸ªæœ‰æ•ˆè®¢é˜…ã€‚è¿™ä¸åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åªè°ƒç”¨ä¸€æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"addEventListener()\"}],\" æ‰€äº§ç”Ÿçš„ç”¨æˆ·å¯è§è¡Œä¸ºæ˜¯ç›¸åŒçš„ã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"triggering-animations\",\"children\":\"è§¦å‘åŠ¨ç”» \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"å¦‚æœä½ çš„ Effect è§¦å‘äº†ä¸€äº›åŠ¨ç”»ï¼Œæ¸…ç†å‡½æ•°åº”å°†åŠ¨ç”»é‡ç½®ä¸ºåˆå§‹çŠ¶æ€ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{4-6}\",\"children\":\"useEffect(() => {\\r\\n  const node = ref.current;\\r\\n  node.style.opacity = 1; // è§¦å‘åŠ¨ç”»\\r\\n  return () => {\\r\\n    node.style.opacity = 0; // é‡ç½®ä¸ºåˆå§‹å€¼\\r\\n  };\\r\\n}, []);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œé€æ˜åº¦ç”± \",[\"$r\",\"code\",null,{\"children\":\"1\"}],\" å˜ä¸º \",[\"$r\",\"code\",null,{\"children\":\"0\"}],\"ï¼Œå†å˜ä¸º \",[\"$r\",\"code\",null,{\"children\":\"1\"}],\"ã€‚è¿™ä¸åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç›´æ¥å°†å…¶è®¾ç½®ä¸º \",[\"$r\",\"code\",null,{\"children\":\"1\"}],\" å…·æœ‰ç›¸åŒçš„ç”¨æˆ·å¯è§è¡Œä¸ºã€‚å¦‚æœä½ ä½¿ç”¨äº†æ”¯æŒè¡¥é—´åŠ¨ç”»çš„ç¬¬ä¸‰æ–¹åŠ¨ç”»åº“ï¼Œä½ çš„æ¸…ç†å‡½æ•°åº”å°†æ—¶é—´è½´é‡ç½®ä¸ºåˆå§‹çŠ¶æ€ã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"fetching-data\",\"children\":\"è·å–æ•°æ® \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"å¦‚æœä½ çš„ Effect éœ€è¦è·å–æ•°æ®ï¼Œæ¸…ç†å‡½æ•°åº” \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"ä¸­æ­¢è¯·æ±‚\"}],\" æˆ–å¿½ç•¥å…¶ç»“æœï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2,6,13-15}\",\"children\":\"useEffect(() => {\\r\\n  let ignore = false;\\r\\n\\r\\n  async function startFetching() {\\r\\n    const json = await fetchTodos(userId);\\r\\n    if (!ignore) {\\r\\n      setTodos(json);\\r\\n    }\\r\\n  }\\r\\n\\r\\n  startFetching();\\r\\n\\r\\n  return () => {\\r\\n    ignore = true;\\r\\n  };\\r\\n}, [userId]);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½ æ— æ³•â€œæ’¤é”€â€å·²ç»å‘ç”Ÿçš„ç½‘ç»œè¯·æ±‚ï¼Œä½†æ˜¯ä½ çš„æ¸…ç†å‡½æ•°åº”å½“ç¡®ä¿é‚£äº›ä¸å†ç›¸å…³çš„è¯·æ±‚ä¸ä¼šç»§ç»­å½±å“ä½ çš„åº”ç”¨ã€‚å¦‚æœ \",[\"$r\",\"code\",null,{\"children\":\"userId\"}],\" ä» \",[\"$r\",\"code\",null,{\"children\":\"'Alice'\"}],\" å˜ä¸º \",[\"$r\",\"code\",null,{\"children\":\"'Bob'\"}],\"ï¼Œé‚£ä¹ˆè¯·ç¡®ä¿ \",[\"$r\",\"code\",null,{\"children\":\"'Alice'\"}],\" çš„å“åº”æ•°æ®è¢«å¿½ç•¥ï¼Œå³ä½¿å®ƒåœ¨ \",[\"$r\",\"code\",null,{\"children\":\"'Bob'\"}],\" ä¹‹ååˆ°è¾¾ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œä½ ä¼šåœ¨æµè§ˆå™¨è°ƒè¯•å·¥å…·çš„â€œç½‘ç»œâ€é€‰é¡¹å¡ä¸­çœ‹åˆ°ä¸¤æ¡è¯·æ±‚\"}],\"ã€‚è¿™æ˜¯æ­£å¸¸çš„ã€‚ä½¿ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ª Effect å°†ç«‹å³è¢«æ¸…ç†ï¼Œæ‰€ä»¥å®ƒçš„ \",[\"$r\",\"code\",null,{\"children\":\"ignore\"}],\" å˜é‡ä¼šè¢«è®¾ç½®ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\"ã€‚å› æ­¤ï¼Œå³ä½¿æœ‰é¢å¤–çš„è¯·æ±‚ï¼Œç”±äºæœ‰ \",[\"$r\",\"code\",null,{\"children\":\"if (!ignore)\"}],\" çš„æ£€æŸ¥ï¼Œä¹Ÿä¸ä¼šå½±å“ stateã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåªä¼šæœ‰ä¸€æ¡è¯·æ±‚\"}],\"ã€‚å¦‚æœå¼€å‘ç¯å¢ƒä¸­çš„ç¬¬äºŒæ¬¡è¯·æ±‚ç»™ä½ é€ æˆäº†å›°æ‰°ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªèƒ½å¤Ÿå¯¹è¯·æ±‚å»é‡å¹¶ç¼“å­˜å“åº”çš„æ–¹æ¡ˆï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"function TodoList() {\\r\\n  const todos = useSomeDataLibrary(`/api/user/${userId}/todos`);\\r\\n  // ...\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™ä¸ä»…å¯ä»¥æé«˜å¼€å‘ä½“éªŒï¼Œè¿˜å¯ä»¥è®©ä½ çš„åº”ç”¨ç¨‹åºå“åº”æ›´å¿«ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·ç‚¹å‡»è¿”å›æŒ‰é’®æ—¶ï¼Œä¸ç”¨å†ç­‰å¾…æ•°æ®é‡æ–°åŠ è½½ï¼Œå› ä¸ºå®ƒå·²ç»è¢«ç¼“å­˜ã€‚ä½ å¯ä»¥è‡ªå·±æ„å»ºè¿™æ ·çš„ç¼“å­˜æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¾ˆå¤šåœ¨ Effect ä¸­æ‰‹åŠ¨è·å–æ•°æ®çš„æ›¿ä»£æ–¹æ³•ã€‚\"}],\"\\n\",[\"$r\",\"DeepDive\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"what-are-good-alternatives-to-data-fetching-in-effects\",\"children\":\"åœ¨ Effect ä¸­è¿›è¡Œæ•°æ®è¯·æ±‚çš„æ›¿ä»£æ–¹æ¡ˆ \"}],[\"$r\",\"p\",null,{\"children\":[\"åœ¨ Effect ä¸­ç›´æ¥ç¼–å†™ \",[\"$r\",\"code\",null,{\"children\":\"fetch\"}],\" è¯·æ±‚ \",[\"$r\",\"a\",null,{\"href\":\"https://www.robinwieruch.de/react-hooks-fetch-data/\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"æ˜¯ä¸€ç§å¸¸è§çš„æ•°æ®è·å–æ–¹å¼\"}],\"ï¼Œç‰¹åˆ«æ˜¯åœ¨å®Œå…¨å®¢æˆ·ç«¯æ¸²æŸ“çš„åº”ç”¨ä¸­ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•éå¸¸æ‰‹åŠ¨åŒ–ï¼Œå¹¶ä¸”æœ‰æ˜æ˜¾çš„å¼Šç«¯ï¼š\"]}],[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"Effect ä¸ä¼šåœ¨æœåŠ¡ç«¯è¿è¡Œ\"}],\"ã€‚è¿™æ„å‘³ç€æœ€åˆç”±æœåŠ¡å™¨æ¸²æŸ“çš„ HTML åªä¼šåŒ…å«åŠ è½½çŠ¶æ€ï¼Œè€Œæ²¡æœ‰å®é™…æ•°æ®ã€‚å®¢æˆ·ç«¯å¿…é¡»å…ˆä¸‹è½½æ‰€æœ‰çš„ JavaScript å¹¶æ¸²æŸ“åº”ç”¨ï¼Œæ‰ä¼šå‘ç°å®ƒéœ€è¦åŠ è½½æ•°æ®â€”â€”è¿™å¹¶ä¸é«˜æ•ˆã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"ç›´æ¥åœ¨ Effect ä¸­è¿›è¡Œæ•°æ®è¯·æ±‚ï¼Œå®¹æ˜“äº§ç”Ÿâ€œç½‘ç»œç€‘å¸ƒï¼ˆnetwork waterfallï¼‰â€\"}],\"ã€‚é¦–å…ˆçˆ¶ç»„ä»¶æ¸²æŸ“æ—¶è¯·æ±‚ä¸€äº›æ•°æ®ï¼Œéšåæ¸²æŸ“å­ç»„ä»¶ï¼Œæ¥ç€å­ç»„ä»¶å¼€å§‹è¯·æ±‚å®ƒä»¬çš„æ•°æ®ã€‚å¦‚æœç½‘ç»œé€Ÿåº¦ä¸å¿«ï¼Œè¿™ç§æ–¹å¼ä¼šæ¯”å¹¶è¡Œè·å–æ‰€æœ‰æ•°æ®æ…¢å¾—å¤šã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"ç›´æ¥åœ¨ Effect ä¸­è¿›è¡Œæ•°æ®è¯·æ±‚å¾€å¾€æ— æ³•é¢„åŠ è½½æˆ–ç¼“å­˜æ•°æ®\"}],\"ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç»„ä»¶å¸è½½åé‡æ–°æŒ‚è½½ï¼Œå®ƒå¿…é¡»é‡æ–°è·å–æ•°æ®ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"ä¸å¤Ÿç®€æ´\"}],\"ã€‚ç¼–å†™ fecth è¯·æ±‚æ—¶ä¸ºäº†é¿å… \",[\"$r\",\"a\",null,{\"href\":\"https://maxrozen.com/race-conditions-fetching-data-react-with-useeffect\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"ç«æ€æ¡ä»¶ï¼ˆrace conditionï¼‰\"}],\" ç­‰é—®é¢˜ï¼Œä¼šéœ€è¦å¾ˆå¤šæ ·æ¿ä»£ç ã€‚\"]}],\"\\n\"]}],[\"$r\",\"p\",null,{\"children\":\"è¿™äº›å¼Šç«¯å¹¶ä¸ä»…é™äº Reactã€‚ä»»ä½•åº“åœ¨ç»„ä»¶æŒ‚è½½æ—¶è¿›è¡Œæ•°æ®è·å–éƒ½ä¼šé‡åˆ°è¿™äº›é—®é¢˜ã€‚ä¸è·¯ç”±å¤„ç†ä¸€æ ·ï¼Œè¦åšå¥½æ•°æ®è·å–å¹¶éæ˜“äº‹ï¼Œå› æ­¤æˆ‘ä»¬æ¨èä»¥ä¸‹æ–¹æ³•ï¼š\"}],[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":[\"å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ \",[\"$r\",\"a\",null,{\"href\":\"/learn/start-a-new-react-project#production-grade-react-frameworks\",\"children\":\"æ¡†æ¶\"}],\" ï¼Œè¯·ä½¿ç”¨å…¶å†…ç½®çš„æ•°æ®è·å–æœºåˆ¶\"]}],\"ã€‚ç°ä»£ React æ¡†æ¶é›†æˆäº†é«˜æ•ˆçš„æ•°æ®è·å–æœºåˆ¶ï¼Œä¸ä¼šå‡ºç°ä¸Šè¿°é—®é¢˜ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"å¦åˆ™ï¼Œè¯·è€ƒè™‘ä½¿ç”¨æˆ–æ„å»ºå®¢æˆ·ç«¯ç¼“å­˜\"}],\"ã€‚æµè¡Œçš„å¼€æºè§£å†³æ–¹æ¡ˆåŒ…æ‹¬ \",[\"$r\",\"a\",null,{\"href\":\"https://tanstack.com/query/latest\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"React Query\"}],\"ã€\",[\"$r\",\"a\",null,{\"href\":\"https://swr.vercel.app/\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"useSWR\"}],\" å’Œ \",[\"$r\",\"a\",null,{\"href\":\"https://beta.reactrouter.com/en/main/start/overview\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"React Router v6.4+\"}],\"ã€‚ä½ ä¹Ÿå¯ä»¥è‡ªå·±æ„å»ºè§£å†³æ–¹æ¡ˆï¼šåœ¨åº•å±‚ä½¿ç”¨ Effectï¼Œä½†æ·»åŠ å¯¹è¯·æ±‚çš„å»é‡ã€ç¼“å­˜å“åº”ä»¥åŠé¿å…ç½‘ç»œç€‘å¸ƒï¼ˆé€šè¿‡é¢„åŠ è½½æ•°æ®æˆ–å°†æ•°æ®è¯·æ±‚æå‡åˆ°è·¯ç”±å±‚æ¬¡ï¼‰çš„é€»è¾‘ã€‚\"]}],\"\\n\"]}],[\"$r\",\"p\",null,{\"children\":\"å¦‚æœè¿™äº›æ–¹æ³•éƒ½ä¸é€‚åˆä½ ï¼Œä½ å¯ä»¥ç»§ç»­ç›´æ¥åœ¨ Effect ä¸­è·å–æ•°æ®ã€‚\"}]]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"sending-analytics\",\"children\":\"å‘é€åˆ†ææŠ¥å‘Š \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼Œå®ƒåœ¨é¡µé¢è®¿é—®æ—¶å‘é€ä¸€ä¸ªåˆ†æäº‹ä»¶ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"useEffect(() => {\\r\\n  logVisit(url); // å‘é€ POST è¯·æ±‚\\r\\n}, [url]);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œå¯¹äºæ¯ä¸ª URLï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"logVisit\"}],\" éƒ½ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ï¼Œå› æ­¤ä½ å¯èƒ½ä¼šå°è¯•ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚\",[\"$r\",\"strong\",null,{\"children\":\"æˆ‘ä»¬å»ºè®®ä¿æŒä¸åŠ¨\"}],\"ã€‚ä¸ä¹‹å‰ç¤ºä¾‹ç±»ä¼¼ï¼Œè¿è¡Œä¸€æ¬¡è¿˜æ˜¯è¿è¡Œä¸¤æ¬¡ï¼Œåœ¨ç”¨æˆ·å¯è§çš„è¡Œä¸ºä¸Šæ²¡æœ‰åŒºåˆ«ã€‚ä»å®é™…è§’åº¦æ¥çœ‹ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"logVisit\"}],\" ä¸åº”è¯¥åœ¨å¼€å‘ç¯å¢ƒä¸­æ‰§è¡Œä»»ä½•æ“ä½œï¼Œå› ä¸ºä½ ä¸ä¼šæƒ³è®©å¼€å‘è®¾å¤‡çš„æ—¥å¿—å½±å“ç”Ÿäº§ç¯å¢ƒçš„ç»Ÿè®¡æ•°æ®ã€‚æ¯æ¬¡ä¿å­˜æ–‡ä»¶æ—¶ç»„ä»¶éƒ½ä¼šé‡æ–°æŒ‚è½½ï¼Œå› æ­¤åœ¨å¼€å‘ç¯å¢ƒä¸­ä¼šè®°å½•é¢å¤–çš„è®¿é—®æ—¥å¿—ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸ä¼šæœ‰é‡å¤çš„è®¿é—®æ—¥å¿—\"}],\"ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä¸ºäº†è°ƒè¯•å‘é€çš„åˆ†æäº‹ä»¶ï¼Œä½ å¯ä»¥å°†åº”ç”¨éƒ¨ç½²åˆ°ä¸€ä¸ªè¿è¡Œåœ¨ç”Ÿäº§æ¨¡å¼ä¸‹çš„æš‚å­˜ç¯å¢ƒï¼Œæˆ–è€…æš‚æ—¶ç¦ç”¨ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/StrictMode\",\"children\":\"ä¸¥æ ¼æ¨¡å¼\"}],\" åŠå…¶ä»…åœ¨å¼€å‘ç¯å¢ƒä¸­çš„é‡æ–°æŒ‚è½½æ£€æŸ¥ã€‚ä½ è¿˜å¯ä»¥åœ¨è·¯ç”±æ›´æ”¹çš„äº‹ä»¶å¤„ç†ç¨‹åºä¸­å‘é€åˆ†ææ•°æ®ï¼Œè€Œä¸æ˜¯åœ¨ Effect ä¸­å‘é€ã€‚å¯¹äºæ›´ç²¾ç¡®çš„åˆ†æï¼Œå¯ä»¥ä½¿ç”¨\",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"äº¤å‰è§‚å¯Ÿå™¨\"}],\" æ¥è·Ÿè¸ªå“ªäº›ç»„ä»¶ä½äºè§†å£ä¸­ä»¥åŠå®ƒä»¬ä¿æŒå¯è§çš„æ—¶é—´ã€‚\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"not-an-effect-initializing-the-application\",\"children\":\"ä¸é€‚ç”¨äº Effectï¼šåˆå§‹åŒ–åº”ç”¨ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"æŸäº›é€»è¾‘åº”è¯¥åªåœ¨åº”ç”¨å¯åŠ¨æ—¶è¿è¡Œä¸€æ¬¡ã€‚ä½ å¯ä»¥å°†å®ƒæ”¾åœ¨ç»„ä»¶å¤–éƒ¨ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-3}\",\"children\":\"if (typeof window !== 'undefined') { // æ£€æŸ¥æ˜¯å¦åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ\\r\\n  checkAuthToken();\\r\\n  loadDataFromLocalStorage();\\r\\n}\\r\\n\\r\\nfunction App() {\\r\\n  // â€¦â€¦\\r\\n}\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™å¯ä»¥ç¡®ä¿æ­¤ç±»é€»è¾‘åªåœ¨æµè§ˆå™¨åŠ è½½é¡µé¢åè¿è¡Œä¸€æ¬¡ã€‚\"}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"not-an-effect-buying-a-product\",\"children\":\"ä¸é€‚ç”¨äº Effectï¼šè´­ä¹°å•†å“ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"æœ‰æ—¶ï¼Œå³ä½¿ä½ ç¼–å†™äº†æ¸…ç†å‡½æ•°ï¼Œä¹Ÿæ— æ³•é¿å…ç”¨æˆ·è§‚å¯Ÿåˆ° Effect è¿è¡Œäº†ä¸¤æ¬¡ã€‚æ¯”å¦‚ä½ çš„ Effect å‘é€äº†ä¸€ä¸ªåƒè´­ä¹°å•†å“è¿™æ ·çš„ POST è¯·æ±‚ï¼š\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-3}\",\"children\":\"useEffect(() => {\\r\\n  // ğŸ”´ é”™è¯¯ï¼šæ­¤å¤„çš„ Effect åœ¨å¼€å‘ç¯å¢ƒä¸­ä¼šè§¦å‘ä¸¤æ¬¡ï¼Œæš´éœ²å‡ºä»£ç ä¸­çš„é—®é¢˜ã€‚\\r\\n  fetch('/api/buy', { method: 'POST' });\\r\\n}, []);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"ä½ è‚¯å®šä¸å¸Œæœ›è´­ä¹°ä¸¤æ¬¡å•†å“ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½ ä¸åº”è¯¥æŠŠè¿™ç§é€»è¾‘æ”¾åœ¨ Effect ä¸­ã€‚å¦‚æœç”¨æˆ·è·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œç„¶åæŒ‰ä¸‹â€œè¿”å›â€æŒ‰é’®ï¼Œä½ çš„ Effect å°±ä¼šå†æ¬¡è¿è¡Œã€‚ä½ ä¸å¸Œæœ›ç”¨æˆ·åœ¨è®¿é—®é¡µé¢æ—¶å°±è´­ä¹°äº§å“ï¼Œè€Œæ˜¯åœ¨ä»–ä»¬ç‚¹å‡»â€œè´­ä¹°â€æŒ‰é’®æ—¶æ‰è´­ä¹°ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è´­ä¹°æ“ä½œå¹¶ä¸æ˜¯ç”±æ¸²æŸ“å¼•èµ·çš„ï¼Œè€Œæ˜¯ç”±ç‰¹å®šçš„äº¤äº’å¼•èµ·çš„ã€‚å®ƒåº”è¯¥åªåœ¨ç”¨æˆ·æŒ‰ä¸‹æŒ‰é’®æ—¶æ‰§è¡Œã€‚å› æ­¤ï¼Œ\",[\"$r\",\"strong\",null,{\"children\":[\"å®ƒä¸åº”è¯¥å†™åœ¨ Effect ä¸­ï¼Œåº”å½“æŠŠ \",[\"$r\",\"code\",null,{\"children\":\"/api/buy\"}],\" è¯·æ±‚ç§»åŠ¨åˆ°â€œè´­ä¹°â€æŒ‰é’®çš„äº‹ä»¶å¤„ç†ç¨‹åºä¸­\"]}],\"ï¼š\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"{2-3}\",\"children\":\"  function handleClick() {\\r\\n    // âœ… è´­ä¹°è¡Œä¸ºæ˜¯ä¸€ä¸ªäº‹ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯ç”±ç‰¹å®šçš„äº¤äº’å¼•èµ·çš„ã€‚\\r\\n    fetch('/api/buy', { method: 'POST' });\\r\\n  }\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"è¿™è¯´æ˜äº†å¦‚æœé‡æ–°æŒ‚è½½ç ´åäº†åº”ç”¨çš„é€»è¾‘ï¼Œé€šå¸¸ä¾¿æš´éœ²äº†å­˜åœ¨çš„ bug\"}],\"ã€‚å¯¹ç”¨æˆ·è€Œè¨€ï¼Œè®¿é—®ä¸€ä¸ªé¡µé¢ä¸åº”è¯¥ä¸è®¿é—®é¡µé¢åç‚¹å‡»é“¾æ¥ã€å†æŒ‰ä¸‹â€œè¿”å›â€æŒ‰é’®æŸ¥çœ‹é¡µé¢æœ‰åŒºåˆ«ã€‚React é€šè¿‡åœ¨å¼€å‘ç¯å¢ƒä¸­é‡æ–°æŒ‚è½½ç»„ä»¶æ¥éªŒè¯ä½ çš„ç»„ä»¶æ˜¯å¦éµå®ˆè¿™ä¸€åŸåˆ™ã€‚\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"putting-it-all-together\",\"children\":\"ç»¼åˆä»¥ä¸Šå†…å®¹ \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"è¿™ä¸ªæ¼”ç»ƒåœºå¯ä»¥å¸®åŠ©ä½ â€œæ„Ÿå—â€ Effect åœ¨å®é™…ä¸­çš„å·¥ä½œæ–¹å¼ã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"è¿™ä¸ªä¾‹å­ä½¿ç”¨ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/setTimeout\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"setTimeout\"}]}],\" è°ƒåº¦ä¸€ä¸ªæ—¥å¿—è®°å½•ï¼Œæ—¥å¿—ä¼šåœ¨ Effect è¿è¡Œä¸‰ç§’åæ˜¾ç¤ºè¾“å…¥çš„æ–‡æœ¬ã€‚æ¸…ç†å‡½æ•°ä¼šå–æ¶ˆæŒ‚èµ·çš„å»¶æ—¶å™¨ã€‚ä»æŒ‰ä¸‹â€œæŒ‚è½½ç»„ä»¶â€å¼€å§‹ï¼š\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState, useEffect } from 'react';\\r\\n\\r\\nfunction Playground() {\\r\\n  const [text, setText] = useState('a');\\r\\n\\r\\n  useEffect(() => {\\r\\n    function onTimeout() {\\r\\n      console.log('â° ' + text);\\r\\n    }\\r\\n\\r\\n    console.log('ğŸ”µ è°ƒåº¦ \\\"' + text + '\\\" æ—¥å¿—');\\r\\n    const timeoutId = setTimeout(onTimeout, 3000);\\r\\n\\r\\n    return () => {\\r\\n      console.log('ğŸŸ¡ å–æ¶ˆ \\\"' + text + '\\\" æ—¥å¿—');\\r\\n      clearTimeout(timeoutId);\\r\\n    };\\r\\n  }, [text]);\\r\\n\\r\\n  return (\\r\\n    <>\\r\\n      <label>\\r\\n        æ—¥å¿—å†…å®¹ï¼š{' '}\\r\\n        <input\\r\\n          value={text}\\r\\n          onChange={e => setText(e.target.value)}\\r\\n        />\\r\\n      </label>\\r\\n      <h1>{text}</h1>\\r\\n    </>\\r\\n  );\\r\\n}\\r\\n\\r\\nexport default function App() {\\r\\n  const [show, setShow] = useState(false);\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setShow(!show)}>\\r\\n        {show ? 'å¸è½½' : 'æŒ‚è½½'}ç»„ä»¶\\r\\n      </button>\\r\\n      {show && <hr />}\\r\\n      {show && <Playground />}\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}]}],[\"$r\",\"MaxWidth\",\"268\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä½ é¦–å…ˆä¼šçœ‹åˆ°ä¸‰æ¡æ—¥å¿—ï¼š\",[\"$r\",\"code\",null,{\"children\":\"è°ƒåº¦ \\\"a\\\" æ—¥å¿—\"}],\"ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"å–æ¶ˆ \\\"a\\\" æ—¥å¿—\"}],\"ï¼Œå†ä¸€æ¡ \",[\"$r\",\"code\",null,{\"children\":\"è°ƒåº¦ \\\"a\\\" æ—¥å¿—\"}],\"ã€‚ä¸‰ç§’åï¼Œä½ è¿˜ä¼šçœ‹åˆ°ä¸€æ¡æ—¥å¿—ï¼š\",[\"$r\",\"code\",null,{\"children\":\"a\"}],\"ã€‚æ­£å¦‚ä½ å…ˆå‰æ‰€å­¦ï¼Œé¢å¤–çš„è°ƒåº¦/å–æ¶ˆæ—¥å¿—æ˜¯å› ä¸º React åœ¨å¼€å‘ç¯å¢ƒä¸­ä¼šé‡æ–°æŒ‚è½½ç»„ä»¶ä¸€æ¬¡ï¼Œä»¥éªŒè¯ä½ æ˜¯å¦æ­£ç¡®å®ç°äº†æ¸…ç†æ“ä½œã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ç°åœ¨ç¼–è¾‘è¾“å…¥æ¡†ï¼Œè¾“å…¥ \",[\"$r\",\"code\",null,{\"children\":\"abc\"}],\"ã€‚å¦‚æœè¾“å…¥é€Ÿåº¦è¶³å¤Ÿå¿«ï¼Œä½ ä¼šçœ‹åˆ° \",[\"$r\",\"code\",null,{\"children\":\"è°ƒåº¦ \\\"ab\\\" æ—¥å¿—\"}],\"ï¼Œç´§æ¥ç€ \",[\"$r\",\"code\",null,{\"children\":\"å–æ¶ˆ \\\"ab\\\" æ—¥å¿—\"}],\" å’Œ \",[\"$r\",\"code\",null,{\"children\":\"è°ƒåº¦ \\\"abc\\\" æ—¥å¿—\"}],\"ã€‚\",[\"$r\",\"strong\",null,{\"children\":\"React æ€»æ˜¯åœ¨æ‰§è¡Œä¸‹ä¸€è½®æ¸²æŸ“çš„ Effect ä¹‹å‰æ¸…ç†ä¸Šä¸€è½®æ¸²æŸ“çš„ Effect\"}],\"ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå³ä½¿ä½ å¿«é€Ÿè¾“å…¥ï¼Œæœ€å¤šä¹Ÿåªæœ‰ä¸€ä¸ªå»¶æ—¶å™¨è¢«è°ƒåº¦ã€‚è¯•è¯•å¤šæ¬¡ç¼–è¾‘è¾“å…¥æ¡†ï¼Œå¹¶è§‚å¯Ÿæ§åˆ¶å°ä»¥äº†è§£ Effect æ˜¯å¦‚ä½•è¢«æ¸…ç†çš„ã€‚\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ä¸€äº›å†…å®¹ï¼Œç„¶åç«‹å³æŒ‰ä¸‹â€œå¸è½½ç»„ä»¶â€ã€‚æ³¨æ„å¸è½½ç»„ä»¶æ—¶æ˜¯å¦‚ä½•æ¸…ç†æœ€åä¸€è½®æ¸²æŸ“çš„ Effect çš„ã€‚åœ¨è¿™é‡Œï¼Œå®ƒä¼šåœ¨æœ€åä¸€ä¸ªå»¶è¿Ÿå™¨è¦è§¦å‘ä¹‹å‰å–æ¶ˆå®ƒã€‚\"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"æœ€åï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­æ³¨é‡Šæ‰æ¸…ç†å‡½æ•°ï¼Œè¿™æ ·å»¶æ—¶å™¨å°±ä¸ä¼šè¢«å–æ¶ˆã€‚å°è¯•å¿«é€Ÿè¾“å…¥ \",[\"$r\",\"code\",null,{\"children\":\"abcde\"}],\"ã€‚ä½ è§‰å¾—ä¸‰ç§’åä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå»¶æ—¶å™¨ä¸­çš„ \",[\"$r\",\"code\",null,{\"children\":\"console.log(text)\"}],\" ä¼šæ‰“å° \",[\"$r\",\"strong\",null,{\"children\":\"æœ€æ–°\"}],\" çš„ \",[\"$r\",\"code\",null,{\"children\":\"text\"}],\" å€¼å¹¶ç”Ÿæˆäº”æ¡ \",[\"$r\",\"code\",null,{\"children\":\"abcde\"}],\" æ—¥å¿—å—ï¼Ÿè¯•è¯•çœ‹å§ï¼ŒéªŒè¯ä¸€ä¸‹ä½ çš„ç›´è§‰ï¼\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"ä¸‰ç§’åï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°ä¸€ç³»åˆ—çš„æ—¥å¿—ï¼š\",[\"$r\",\"code\",null,{\"children\":\"a\"}],\"ã€\",[\"$r\",\"code\",null,{\"children\":\"ab\"}],\"ã€\",[\"$r\",\"code\",null,{\"children\":\"abc\"}],\"ã€\",[\"$r\",\"code\",null,{\"children\":\"abcd\"}],\" ä¸ \",[\"$r\",\"code\",null,{\"children\":\"abcde\"}],\"ï¼Œè€Œä¸æ˜¯äº”æ¡ \",[\"$r\",\"code\",null,{\"children\":\"abcde\"}],\" æ—¥å¿—ã€‚è¿™æ˜¯å› ä¸º \",[\"$r\",\"strong\",null,{\"children\":[\"æ¯ä¸ª Effect éƒ½ä¼šâ€œæ•è·â€å®ƒå¯¹åº”æ¸²æŸ“æ—¶çš„ \",[\"$r\",\"code\",null,{\"children\":\"text\"}],\" å€¼\"]}],\"ã€‚å³ä½¿ \",[\"$r\",\"code\",null,{\"children\":\"text\"}],\" çš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œæ¸²æŸ“æ—¶ \",[\"$r\",\"code\",null,{\"children\":\"text = 'ab'\"}],\" çš„ Effect æ€»æ˜¯ä¼šå¾—åˆ° \",[\"$r\",\"code\",null,{\"children\":\"'ab'\"}],\"ã€‚æ¢å¥è¯è¯´ï¼Œæ¯ä¸ªæ¸²æŸ“çš„ Effect éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚å¦‚æœä½ å¯¹è¿™ç§æœºåˆ¶æ„Ÿå…´è¶£ï¼Œå¯ä»¥é˜…è¯»æœ‰å…³ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"é—­åŒ…\"}],\" çš„å†…å®¹ã€‚\"]}],\"\\n\",[\"$r\",\"DeepDive\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"each-render-has-its-own-effects\",\"children\":\"æ¯ä¸€è½®æ¸²æŸ“éƒ½æœ‰å…¶è‡ªå·±çš„ Effect \"}],[\"$r\",\"p\",null,{\"children\":[\"ä½ å¯ä»¥å°† \",[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\" ç†è§£ä¸ºâ€œé™„åŠ â€ä¸€æ®µè¡Œä¸ºåˆ°æ¸²æŸ“è¾“å‡ºä¸­ã€‚è€ƒè™‘ä¸‹é¢è¿™ä¸ª Effectï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"export default function ChatRoom({ roomId }) {\\r\\n  useEffect(() => {\\r\\n    const connection = createConnection(roomId);\\r\\n    connection.connect();\\r\\n    return () => connection.disconnect();\\r\\n  }, [roomId]);\\r\\n\\r\\n  return <h1>æ¬¢è¿æ¥åˆ° {roomId}ï¼</h1>;\\r\\n}\\n\"}]}],[\"$r\",\"p\",null,{\"children\":\"è®©æˆ‘ä»¬çœ‹çœ‹å½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¸­åˆ‡æ¢é¡µé¢æ—¶åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚\"}],[\"$r\",\"h4\",null,{\"id\":\"initial-render\",\"children\":\"åˆæ¬¡æ¸²æŸ“ \"}],[\"$r\",\"p\",null,{\"children\":[\"ç”¨æˆ·è®¿é—® \",[\"$r\",\"code\",null,{\"children\":\"<ChatRoom roomId=\\\"general\\\" />\"}],\"ã€‚æˆ‘ä»¬ \",[\"$r\",\"a\",null,{\"href\":\"/learn/state-as-a-snapshot#rendering-takes-a-snapshot-in-time\",\"children\":\"å‡è®¾\"}],\" \",[\"$r\",\"code\",null,{\"children\":\"roomId\"}],\" çš„å€¼ä¸º \",[\"$r\",\"code\",null,{\"children\":\"'general'\"}],\" ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"  // é¦–æ¬¡æ¸²æŸ“æ—¶çš„ JSXï¼ˆroomId ä¸º \\\"general\\\"ï¼‰\\r\\n  return <h1>æ¬¢è¿æ¥åˆ° generalï¼</h1>;\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"Effect ä¹Ÿæ˜¯æ¸²æŸ“è¾“å‡ºçš„ä¸€éƒ¨åˆ†\"}],\"ã€‚é¦–æ¬¡æ¸²æŸ“çš„ Effect å˜ä¸ºï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"  //é¦–å…ˆæ¸²æŸ“æ—¶çš„ Effectï¼ˆroomId ä¸º \\\"general\\\"ï¼‰\\r\\n  () => {\\r\\n    const connection = createConnection('general');\\r\\n    connection.connect();\\r\\n    return () => connection.disconnect();\\r\\n  },\\r\\n  // é¦–æ¬¡æ¸²æŸ“æ—¶çš„ä¾èµ–é¡¹ï¼ˆroomId ä¸º \\\"general\\\"ï¼‰\\r\\n  ['general']\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"React è¿è¡Œè¿™ä¸ª Effect æ¥è¿æ¥åˆ° \",[\"$r\",\"code\",null,{\"children\":\"'general'\"}],\" èŠå¤©å®¤ã€‚\"]}],[\"$r\",\"h4\",null,{\"id\":\"re-render-with-same-dependencies\",\"children\":\"ä¾èµ–é¡¹ç›¸åŒæ—¶çš„é‡æ–°æ¸²æŸ“ \"}],[\"$r\",\"p\",null,{\"children\":[\"å‡è®¾ \",[\"$r\",\"code\",null,{\"children\":\"<ChatRoom roomId=\\\"general\\\" />\"}],\" é‡æ–°æ¸²æŸ“ã€‚è¾“å‡ºçš„ JSX ä¸å˜ï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"  // ç¬¬äºŒæ¬¡æ¸²æŸ“æ—¶çš„ JSXï¼ˆroomId ä¸º \\\"general\\\"ï¼‰\\r\\n  return <h1>Welcome to general!</h1>;\\n\"}]}],[\"$r\",\"p\",null,{\"children\":\"React çœ‹åˆ°æ¸²æŸ“è¾“å‡ºæ²¡æœ‰æ”¹å˜ï¼Œæ‰€ä»¥ä¸æ›´æ–° DOM ã€‚\"}],[\"$r\",\"p\",null,{\"children\":\"ç¬¬äºŒæ¬¡æ¸²æŸ“çš„ Effect å¦‚ä¸‹æ‰€ç¤ºï¼š\"}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"  // ç¬¬äºŒæ¬¡æ¸²æŸ“æ—¶çš„ Effectï¼ˆroomId ä¸º \\\"general\\\"ï¼‰\\r\\n  () => {\\r\\n    const connection = createConnection('general');\\r\\n    connection.connect();\\r\\n    return () => connection.disconnect();\\r\\n  },\\r\\n  // ç¬¬äºŒæ¬¡æ¸²æŸ“æ—¶çš„ä¾èµ–é¡¹ï¼ˆroomId ä¸º \\\"general\\\"ï¼‰\\r\\n  ['general']\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"React å°†ç¬¬äºŒæ¬¡æ¸²æŸ“æ—¶çš„ \",[\"$r\",\"code\",null,{\"children\":\"['general']\"}],\" ä¸ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶çš„ \",[\"$r\",\"code\",null,{\"children\":\"['general']\"}],\" è¿›è¡Œæ¯”è¾ƒã€‚\",[\"$r\",\"strong\",null,{\"children\":\"å› ä¸ºæ‰€æœ‰çš„ä¾èµ–é¡¹éƒ½ç›¸åŒï¼ŒReact å¿½ç•¥ç¬¬äºŒæ¬¡æ¸²æŸ“æ—¶çš„ Effect\"}],\"ã€‚Effect ä¸ä¼šè¢«è°ƒç”¨ã€‚\"]}],[\"$r\",\"h4\",null,{\"id\":\"re-render-with-different-dependencies\",\"children\":\"ä¾èµ–é¡¹ä¸åŒæ—¶çš„é‡æ–°æ¸²æŸ“ \"}],[\"$r\",\"p\",null,{\"children\":[\"æ¥ç€ï¼Œç”¨æˆ·è®¿é—®äº† \",[\"$r\",\"code\",null,{\"children\":\"<ChatRoom roomId=\\\"travel\\\" />\"}],\"ã€‚è¿™ä¸€æ¬¡ï¼Œç»„ä»¶è¿”å›äº†ä¸åŒçš„ JSXï¼š\"]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"  // ç¬¬ä¸‰æ¬¡æ¸²æŸ“æ—¶çš„ JSXï¼ˆroomId ä¸º \\\"travel\\\"ï¼‰\\r\\n  return <h1>æ¬¢è¿æ¥åˆ° travelï¼</h1>;\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"React æ›´æ–° DOM ï¼Œå°† \",[\"$r\",\"code\",null,{\"children\":\"\\\"æ¬¢è¿æ¥åˆ° general\\\"\"}],\" æ”¹ä¸º \",[\"$r\",\"code\",null,{\"children\":\"\\\"æ¬¢è¿æ¥åˆ° travel\\\"\"}],\"ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"ç¬¬ä¸‰æ¬¡æ¸²æŸ“çš„ Effect å¦‚ä¸‹æ‰€ç¤ºï¼š\"}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"  // ç¬¬ä¸‰æ¬¡æ¸²æŸ“æ—¶çš„ Effectï¼ˆroomId ä¸º \\\"travel\\\"ï¼‰\\r\\n  () => {\\r\\n    const connection = createConnection('travel');\\r\\n    connection.connect();\\r\\n    return () => connection.disconnect();\\r\\n  },\\r\\n  // ç¬¬ä¸‰æ¬¡æ¸²æŸ“æ—¶çš„ä¾èµ–é¡¹ï¼ˆroomId ä¸º \\\"travel\\\"ï¼‰\\r\\n  ['travel']\\n\"}]}],[\"$r\",\"p\",null,{\"children\":[\"React å°†ç¬¬ä¸‰æ¬¡æ¸²æŸ“æ—¶çš„ \",[\"$r\",\"code\",null,{\"children\":\"['travel']\"}],\" ä¸ç¬¬äºŒæ¬¡æ¸²æŸ“æ—¶çš„ \",[\"$r\",\"code\",null,{\"children\":\"['general']\"}],\" ç›¸æ¯”è¾ƒã€‚å‘ç°ä¾èµ–é¡¹ä¸åŒï¼š\",[\"$r\",\"code\",null,{\"children\":\"Object.is('travel', 'general')\"}],\" ä¸º \",[\"$r\",\"code\",null,{\"children\":\"false\"}],\"ã€‚å› æ­¤ Effect ä¸èƒ½è¢«è·³è¿‡ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"åœ¨ React æ‰§è¡Œç¬¬ä¸‰æ¬¡æ¸²æŸ“çš„ Effect ä¹‹å‰ï¼Œå®ƒéœ€è¦æ¸…ç†ä¸Šä¸€ä¸ªè¿è¡Œçš„ Effect\"}],\"ã€‚ç¬¬äºŒæ¬¡æ¸²æŸ“çš„ Effect è¢«è·³è¿‡äº†ã€‚æ‰€ä»¥ React éœ€è¦æ¸…ç†ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶çš„ Effectã€‚å¦‚æœä½ å›çœ‹ç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼Œä½ ä¼šå‘ç°ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶çš„æ¸…ç†å‡½æ•°æ‰€åšçš„äº‹ï¼Œæ˜¯åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"createConnection('general')\"}],\" æ‰€åˆ›å»ºçš„è¿æ¥ä¸Šè°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"disconnect()\"}],\"ã€‚ä¹Ÿå°±æ˜¯ä» \",[\"$r\",\"code\",null,{\"children\":\"'general'\"}],\" èŠå¤©å®¤æ–­å¼€è¿æ¥ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä¹‹åï¼ŒReact æ‰§è¡Œç¬¬ä¸‰æ¬¡æ¸²æŸ“çš„ Effectã€‚å®ƒè¿æ¥åˆ° \",[\"$r\",\"code\",null,{\"children\":\"'travel'\"}],\" èŠå¤©å®¤ã€‚\"]}],[\"$r\",\"h4\",null,{\"id\":\"unmount\",\"children\":\"ç»„ä»¶å¸è½½ \"}],[\"$r\",\"p\",null,{\"children\":[\"æœ€åï¼Œå‡è®¾ç”¨æˆ·ç¦»å¼€äº†å½“å‰é¡µé¢ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"ChatRoom\"}],\" ç»„ä»¶è¢«å¸è½½ã€‚React æ‰§è¡Œä¸Šä¸€ä¸ªè¿è¡Œçš„ Effect çš„æ¸…ç†å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸‰æ¬¡æ¸²æŸ“æ—¶çš„ Effectã€‚è¿™ä¸ªæ¸…ç†å‡½æ•°ä¼šé”€æ¯ \",[\"$r\",\"code\",null,{\"children\":\"createConnection('travel')\"}],\" æ‰€åˆ›å»ºçš„è¿æ¥ã€‚è¿™æ ·ï¼Œåº”ç”¨ä¸ \",[\"$r\",\"code\",null,{\"children\":\"travel\"}],\" æˆ¿é—´æ–­å¼€äº†è¿æ¥ã€‚\"]}],[\"$r\",\"h4\",null,{\"id\":\"development-only-behaviors\",\"children\":\"ä»…å¼€å‘ç¯å¢ƒä¸‹çš„è¡Œä¸º \"}],[\"$r\",\"p\",null,{\"children\":[\"å¼€å¯ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/StrictMode\",\"children\":\"ä¸¥æ ¼æ¨¡å¼\"}],\" æ—¶ï¼ŒReact åœ¨æ¯æ¬¡æŒ‚è½½ç»„ä»¶åéƒ½ä¼šé‡æ–°æŒ‚è½½ç»„ä»¶ï¼ˆç»„ä»¶çš„ state ä¸ åˆ›å»ºçš„ DOM éƒ½ä¼šè¢«ä¿ç•™ï¼‰ã€‚\",[\"$r\",\"a\",null,{\"href\":\"#step-3-add-cleanup-if-needed\",\"children\":\"å®ƒå¯ä»¥å¸®åŠ©ä½ æ‰¾å‡ºéœ€è¦æ·»åŠ æ¸…ç†å‡½æ•°çš„ Effect\"}],\"ï¼Œå¹¶åœ¨æ—©æœŸæš´éœ²ç±»ä¼¼ç«æ€æ¡ä»¶è¿™æ ·çš„ bugã€‚æ­¤å¤–ï¼Œæ¯å½“ä½ åœ¨å¼€å‘ç¯å¢ƒä¸­ä¿å­˜æ–‡ä»¶æ—¶ï¼ŒReact ä¹Ÿä¼šé‡æ–°æŒ‚è½½ Effectã€‚è¿™äº›è¡Œä¸ºéƒ½ä»…é™äºå¼€å‘ç¯å¢ƒã€‚\"]}]]}],\"\\n\",[\"$r\",\"Recap\",null,{\"children\":[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä¸äº‹ä»¶ä¸åŒï¼ŒEffect ç”±æ¸²æŸ“æœ¬èº«å¼•èµ·ï¼Œè€Œéç‰¹å®šçš„äº¤äº’ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"Effect å…è®¸ä½ å°†ç»„ä»¶ä¸æŸäº›å¤–éƒ¨ç³»ç»Ÿï¼ˆç¬¬ä¸‰æ–¹ APIã€ç½‘ç»œç­‰ï¼‰åŒæ­¥ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"é»˜è®¤æƒ…å†µä¸‹ï¼ŒEffect åœ¨æ¯æ¬¡æ¸²æŸ“ï¼ˆåŒ…æ‹¬åˆå§‹æ¸²æŸ“ï¼‰åè¿è¡Œã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å¦‚æœæ‰€æœ‰ä¾èµ–é¡¹éƒ½ä¸ä¸Šä¸€æ¬¡æ¸²æŸ“æ—¶ç›¸åŒï¼ŒReact ä¼šè·³è¿‡æœ¬æ¬¡ Effectã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä½ ä¸èƒ½â€œé€‰æ‹©â€ä¾èµ–é¡¹ï¼Œå®ƒä»¬æ˜¯ç”± Effect å†…éƒ¨çš„ä»£ç æ‰€å†³å®šçš„ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"ç©ºçš„ä¾èµ–æ•°ç»„ï¼ˆ\",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ï¼‰å¯¹åº”äºç»„ä»¶çš„â€œæŒ‚è½½â€ï¼Œå³ç»„ä»¶è¢«æ·»åŠ åˆ°é¡µé¢ä¸Šæ—¶ã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"ä»…åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹çš„å¼€å‘ç¯å¢ƒä¸­ï¼ŒReact ä¼šæŒ‚è½½ä¸¤æ¬¡ç»„ä»¶ï¼Œä»¥å¯¹ Effect è¿›è¡Œå‹åŠ›æµ‹è¯•ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"å¦‚æœä½ çš„ Effect å› ä¸ºé‡æ–°æŒ‚è½½è€Œå‡ºç°é—®é¢˜ï¼Œé‚£ä¹ˆä½ éœ€è¦å®ç°ä¸€ä¸ªæ¸…ç†å‡½æ•°ã€‚\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"React ä¼šåœ¨ Effect å†æ¬¡è¿è¡Œä¹‹å‰å’Œåœ¨ç»„ä»¶å¸è½½æ—¶è°ƒç”¨ä½ çš„æ¸…ç†å‡½æ•°ã€‚\"}],\"\\n\"]}]}],\"\\n\"]}],[\"$r\",\"Challenges\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"focus-a-field-on-mount\",\"children\":\"æŒ‚è½½åèšç„¦äºè¡¨å•å­—æ®µ \"}],[\"$r\",\"p\",null,{\"children\":[\"åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œè¡¨å•ä¸­æ¸²æŸ“äº†ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"<MyInput />\"}],\" ç»„ä»¶ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ä½¿ç”¨è¾“å…¥æ¡†çš„ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/focus\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"focus()\"}]}],\" æ–¹æ³•ï¼Œè®© \",[\"$r\",\"code\",null,{\"children\":\"MyInput\"}],\" åœ¨é¡µé¢ä¸Šå‡ºç°æ—¶è‡ªåŠ¨èšç„¦ã€‚å·²ç»æœ‰ä¸€ä¸ªè¢«æ³¨é‡Šæ‰çš„å®ç°ï¼Œä½†å®ƒå¹¶ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚æ‰¾å‡ºå®ƒä¸ºä»€ä¹ˆä¸èµ·ä½œç”¨ï¼Œå¹¶ä¿®å¤å®ƒã€‚å¦‚æœä½ ç†Ÿæ‚‰ \",[\"$r\",\"code\",null,{\"children\":\"autoFocus\"}],\" å±æ€§ï¼Œè¯·å‡è£…å®ƒä¸å­˜åœ¨ï¼šæˆ‘ä»¬æ­£åœ¨ä»å¤´å¼€å§‹å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/MyInput.js active\",\"children\":\"import { useEffect, useRef } from 'react';\\r\\n\\r\\nexport default function MyInput({ value, onChange }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  // TODOï¼šä¸‹é¢çš„è¿™ç§åšæ³•ä¸ä¼šç”Ÿæ•ˆï¼Œè¯·ä¿®å¤ã€‚\\r\\n  // ref.current.focus()    \\r\\n\\r\\n  return (\\r\\n    <input\\r\\n      ref={ref}\\r\\n      value={value}\\r\\n      onChange={onChange}\\r\\n    />\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js hidden\",\"children\":\"import { useState } from 'react';\\r\\nimport MyInput from './MyInput.js';\\r\\n\\r\\nexport default function Form() {\\r\\n  const [show, setShow] = useState(false);\\r\\n  const [name, setName] = useState('Taylor');\\r\\n  const [upper, setUpper] = useState(false);\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setShow(s => !s)}>{show ? 'éšè—' : 'å±•ç¤º'}è¡¨å•</button>\\r\\n      <br />\\r\\n      <hr />\\r\\n      {show && (\\r\\n        <>\\r\\n          <label>\\r\\n            è¾“å…¥ä½ çš„å§“åï¼š\\r\\n            <MyInput\\r\\n              value={name}\\r\\n              onChange={e => setName(e.target.value)}\\r\\n            />\\r\\n          </label>\\r\\n          <label>\\r\\n            <input\\r\\n              type=\\\"checkbox\\\"\\r\\n              checked={upper}\\r\\n              onChange={e => setUpper(e.target.checked)}\\r\\n            />\\r\\n            å¤§å†™\\r\\n          </label>\\r\\n          <p>ä½ å¥½ï¼Œ <b>{upper ? name.toUpperCase() : name}</b></p>\\r\\n        </>\\r\\n      )}\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label {\\r\\n  display: block;\\r\\n  margin-top: 20px;\\r\\n  margin-bottom: 20px;\\r\\n}\\r\\n\\r\\nbody {\\r\\n  min-height: 150px;\\r\\n}\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":\"è¦éªŒè¯ä½ çš„æ–¹æ³•æ˜¯å¦å¥æ•ˆï¼Œè¯·ç‚¹å‡»â€œå±•ç¤ºè¡¨å•â€ï¼Œå¹¶ç¡®è®¤è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹ï¼ˆé«˜äº®æ˜¾ç¤ºå¹¶ä¸”å…‰æ ‡ä½äºå†…éƒ¨ï¼‰ï¼›å†æ¬¡ç‚¹å‡»â€œéšè—è¡¨å•â€å’Œâ€œå±•ç¤ºè¡¨å•â€ï¼Œç¡®è®¤è¾“å…¥æ¡†æ˜¯å¦å†æ¬¡è¢«é«˜äº®æ˜¾ç¤ºã€‚\"}],[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"MyInput\"}],\" ç»„ä»¶åº”è¯¥åªåœ¨ \",[\"$r\",\"strong\",null,{\"children\":\"æŒ‚è½½\"}],\" æ—¶è·å¾—ç„¦ç‚¹ï¼Œè€Œéæ¯æ¬¡æ¸²æŸ“åã€‚ä¸ºäº†éªŒè¯è¿™ä¸€è¡Œä¸ºæ˜¯å¦æ­£ç¡®ï¼Œç‚¹å‡»â€œå±•ç¤ºè¡¨å•â€ï¼Œç„¶ååå¤ç‚¹å‡»â€œå¤§å†™â€çš„å¤é€‰æ¡†ã€‚ç‚¹å‡»å¤é€‰æ¡†æ—¶ï¼Œä¸Šæ–¹çš„è¾“å…¥æ¡†ä¸åº”è¯¥è·å¾—ç„¦ç‚¹ã€‚\"]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"åœ¨æ¸²æŸ“æœŸé—´è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"ref.current.focus()\"}],\" æ˜¯é”™è¯¯çš„ã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªâ€œå‰¯ä½œç”¨â€ã€‚å‰¯ä½œç”¨åº”è¯¥æ”¾åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­æˆ–é€šè¿‡ \",[\"$r\",\"code\",null,{\"children\":\"useEffect\"}],\" æ¥å£°æ˜ã€‚åœ¨è¿™é‡Œï¼Œè¿™ä¸ªå‰¯ä½œç”¨æ˜¯ç”±ç»„ä»¶æ¸²æŸ“å¼•èµ·çš„ï¼Œè€Œä¸æ˜¯ä»»ä½•ç‰¹å®šçš„äº¤äº’å¼•èµ·çš„ï¼Œå› æ­¤åº”è¯¥å°†å®ƒæ”¾åœ¨ Effect ä¸­ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"è¦ä¿®å¤è¿™ä¸ªé”™è¯¯ï¼Œéœ€è¦å°† \",[\"$r\",\"code\",null,{\"children\":\"ref.current.focus()\"}],\" è°ƒç”¨åŒ…è£¹åœ¨ Effect ä¸­ã€‚ç„¶åï¼Œä¸ºäº†ç¡®ä¿è¿™ä¸ª Effect åªåœ¨ç»„ä»¶æŒ‚è½½æ—¶è¿è¡Œï¼Œè€Œä¸æ˜¯æ¯ä¸€è½®æ¸²æŸ“åéƒ½è¿è¡Œï¼Œå†æ·»åŠ ä¸€ä¸ªç©ºçš„ä¾èµ–æ•°ç»„ \",[\"$r\",\"code\",null,{\"children\":\"[]\"}],\"ã€‚\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/MyInput.js active\",\"children\":\"import { useEffect, useRef } from 'react';\\r\\n\\r\\nexport default function MyInput({ value, onChange }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  useEffect(() => {\\r\\n    ref.current.focus();\\r\\n  }, []);\\r\\n\\r\\n  return (\\r\\n    <input\\r\\n      ref={ref}\\r\\n      value={value}\\r\\n      onChange={onChange}\\r\\n    />\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js hidden\",\"children\":\"import { useState } from 'react';\\r\\nimport MyInput from './MyInput.js';\\r\\n\\r\\nexport default function Form() {\\r\\n  const [show, setShow] = useState(false);\\r\\n  const [name, setName] = useState('Taylor');\\r\\n  const [upper, setUpper] = useState(false);\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setShow(s => !s)}>{show ? 'éšè—' : 'å±•ç¤º'}è¡¨å•</button>\\r\\n      <br />\\r\\n      <hr />\\r\\n      {show && (\\r\\n        <>\\r\\n          <label>\\r\\n            è¾“å…¥ä½ çš„å§“åï¼š\\r\\n            <MyInput\\r\\n              value={name}\\r\\n              onChange={e => setName(e.target.value)}\\r\\n            />\\r\\n          </label>\\r\\n          <label>\\r\\n            <input\\r\\n              type=\\\"checkbox\\\"\\r\\n              checked={upper}\\r\\n              onChange={e => setUpper(e.target.checked)}\\r\\n            />\\r\\n            å¤§å†™\\r\\n          </label>\\r\\n          <p>ä½ å¥½ï¼Œ<b>{upper ? name.toUpperCase() : name}</b></p>\\r\\n        </>\\r\\n      )}\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label {\\r\\n  display: block;\\r\\n  margin-top: 20px;\\r\\n  margin-bottom: 20px;\\r\\n}\\r\\n\\r\\nbody {\\r\\n  min-height: 150px;\\r\\n}\\n\"}]}]]}]]}],[\"$r\",\"h4\",null,{\"id\":\"focus-a-field-conditionally\",\"children\":\"æœ‰æ¡ä»¶åœ°èšç„¦äºè¡¨å•å­—æ®µ \"}],[\"$r\",\"p\",null,{\"children\":[\"ä¸‹é¢çš„è¡¨å•æ¸²æŸ“ä¸¤ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"<MyInput />\"}],\" ç»„ä»¶ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"ç‚¹å‡»â€œå±•ç¤ºè¡¨å•â€åï¼Œæ³¨æ„ç¬¬äºŒä¸ªè¾“å…¥æ¡†ä¼šè‡ªåŠ¨è·å–ç„¦ç‚¹ã€‚è¿™æ˜¯å› ä¸ºä¸¤ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"<MyInput />\"}],\" ç»„ä»¶åœ¨å†…éƒ¨æŠ¢å ç„¦ç‚¹ã€‚å½“ä½ è¿ç»­ä¸ºä¸¤ä¸ªè¾“å…¥æ¡†è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"focus()\"}],\" æ—¶ï¼Œæœ€åä¸€ä¸ªæ€»ä¼šâ€œè·èƒœâ€ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":[\"å‡è®¾ä½ å¸Œæœ›èšç„¦äºç¬¬ä¸€ä¸ªè¾“å…¥æ¡†ã€‚ç°åœ¨ï¼Œç¬¬ä¸€ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"MyInput\"}],\" ç»„ä»¶æ¥æ”¶ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„ \",[\"$r\",\"code\",null,{\"children\":\"shouldFocus\"}],\" å±æ€§ï¼Œä¸”å€¼è®¾ç½®ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\"ã€‚è¯·ä¿®æ”¹ç¨‹åºé€»è¾‘ï¼Œä½¿å¾—ä»…å½“ \",[\"$r\",\"code\",null,{\"children\":\"MyInput\"}],\" æ¥æ”¶åˆ°çš„ \",[\"$r\",\"code\",null,{\"children\":\"shouldFocus\"}],\" å±æ€§ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\" æ—¶æ‰è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"focus()\"}],\" ã€‚\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/MyInput.js active\",\"children\":\"import { useEffect, useRef } from 'react';\\r\\n\\r\\nexport default function MyInput({ shouldFocus, value, onChange }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  // TODOï¼šåªåœ¨ shouldFocus ä¸º true æ—¶æ‰è°ƒç”¨ focus()\\r\\n  useEffect(() => {\\r\\n    ref.current.focus();\\r\\n  }, []);\\r\\n\\r\\n  return (\\r\\n    <input\\r\\n      ref={ref}\\r\\n      value={value}\\r\\n      onChange={onChange}\\r\\n    />\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js hidden\",\"children\":\"import { useState } from 'react';\\r\\nimport MyInput from './MyInput.js';\\r\\n\\r\\nexport default function Form() {\\r\\n  const [show, setShow] = useState(false);\\r\\n  const [firstName, setFirstName] = useState('Taylor');\\r\\n  const [lastName, setLastName] = useState('Swift');\\r\\n  const [upper, setUpper] = useState(false);\\r\\n  const name = firstName + ' ' + lastName;\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setShow(s => !s)}>{show ? 'éšè—' : 'å±•ç¤º'}è¡¨å•</button>\\r\\n      <br />\\r\\n      <hr />\\r\\n      {show && (\\r\\n        <>\\r\\n          <label>\\r\\n            è¾“å…¥ä½ çš„åï¼š\\r\\n            <MyInput\\r\\n              value={firstName}\\r\\n              onChange={e => setFirstName(e.target.value)}\\r\\n              shouldFocus={true}\\r\\n            />\\r\\n          </label>\\r\\n          <label>\\r\\n            è¾“å…¥ä½ çš„å§“ï¼š\\r\\n            <MyInput\\r\\n              value={lastName}\\r\\n              onChange={e => setLastName(e.target.value)}\\r\\n              shouldFocus={false}\\r\\n            />\\r\\n          </label>\\r\\n          <p>ä½ å¥½ï¼Œ<b>{upper ? name.toUpperCase() : name}</b></p>\\r\\n        </>\\r\\n      )}\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label {\\r\\n  display: block;\\r\\n  margin-top: 20px;\\r\\n  margin-bottom: 20px;\\r\\n}\\r\\n\\r\\nbody {\\r\\n  min-height: 150px;\\r\\n}\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"è¦éªŒè¯ä½ çš„æ–¹æ³•æ˜¯å¦å¥æ•ˆï¼Œè¯·é‡å¤ç‚¹å‡»â€œå±•ç¤ºè¡¨å•â€å’Œâ€œéšè—è¡¨å•â€ã€‚å½“è¡¨å•æ˜¾ç¤ºæ—¶ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†è¯¥è·å¾—ç„¦ç‚¹ã€‚å› ä¸ºçˆ¶ç»„ä»¶åœ¨æ¸²æŸ“ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†æ—¶ä¼ å…¥äº† \",[\"$r\",\"code\",null,{\"children\":\"shouldFocus={true}\"}],\"ï¼Œè€Œæ¸²æŸ“ç¬¬äºŒä¸ªè¾“å…¥æ¡†æ—¶ä¼ å…¥äº† \",[\"$r\",\"code\",null,{\"children\":\"shouldFocus={false}\"}],\"ã€‚åŒæ—¶ï¼Œè¯·ç¡®è®¤ä¸¤ä¸ªè¾“å…¥æ¡†éƒ½èƒ½æ­£å¸¸å·¥ä½œå¹¶ä¸”ä½ éƒ½èƒ½åœ¨å…¶ä¸­è¾“å…¥ã€‚\"]}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"ä½ ä¸èƒ½æœ‰æ¡ä»¶åœ°å£°æ˜ Effectï¼Œä½†ä½ çš„ Effect ä¸­å¯ä»¥åŒ…å«æ¡ä»¶é€»è¾‘ã€‚\"}]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"åœ¨ Effect ä¸­åŠ å…¥æ¡ä»¶é€»è¾‘ã€‚ç”±äºä½ åœ¨ Effect ä¸­ä½¿ç”¨äº† \",[\"$r\",\"code\",null,{\"children\":\"shouldFocus\"}],\"ï¼Œå› æ­¤éœ€è¦å°†å®ƒæŒ‡å®šä¸ºä¾èµ–é¡¹ã€‚è¿™æ„å‘³ç€å¦‚æœæŸä¸ªè¾“å…¥æ¡†çš„ \",[\"$r\",\"code\",null,{\"children\":\"shouldFocus\"}],\" ç”± \",[\"$r\",\"code\",null,{\"children\":\"false\"}],\" å˜ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\"ï¼Œå®ƒå°†åœ¨æŒ‚è½½åè·å¾—ç„¦ç‚¹ã€‚\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/MyInput.js active\",\"children\":\"import { useEffect, useRef } from 'react';\\r\\n\\r\\nexport default function MyInput({ shouldFocus, value, onChange }) {\\r\\n  const ref = useRef(null);\\r\\n\\r\\n  useEffect(() => {\\r\\n    if (shouldFocus) {\\r\\n      ref.current.focus();\\r\\n    }\\r\\n  }, [shouldFocus]);\\r\\n\\r\\n  return (\\r\\n    <input\\r\\n      ref={ref}\\r\\n      value={value}\\r\\n      onChange={onChange}\\r\\n    />\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js hidden\",\"children\":\"import { useState } from 'react';\\r\\nimport MyInput from './MyInput.js';\\r\\n\\r\\nexport default function Form() {\\r\\n  const [show, setShow] = useState(false);\\r\\n  const [firstName, setFirstName] = useState('Taylor');\\r\\n  const [lastName, setLastName] = useState('Swift');\\r\\n  const [upper, setUpper] = useState(false);\\r\\n  const name = firstName + ' ' + lastName;\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setShow(s => !s)}>{show ? 'éšè—' : 'å±•ç¤º'}è¡¨å•</button>\\r\\n      <br />\\r\\n      <hr />\\r\\n      {show && (\\r\\n        <>\\r\\n          <label>\\r\\n            è¾“å…¥ä½ çš„åï¼š\\r\\n            <MyInput\\r\\n              value={firstName}\\r\\n              onChange={e => setFirstName(e.target.value)}\\r\\n              shouldFocus={true}\\r\\n            />\\r\\n          </label>\\r\\n          <label>\\r\\n            è¾“å…¥ä½ çš„å§“ï¼š\\r\\n            <MyInput\\r\\n              value={lastName}\\r\\n              onChange={e => setLastName(e.target.value)}\\r\\n              shouldFocus={false}\\r\\n            />\\r\\n          </label>\\r\\n          <p>ä½ å¥½ï¼Œ<b>{upper ? name.toUpperCase() : name}</b></p>\\r\\n        </>\\r\\n      )}\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label {\\r\\n  display: block;\\r\\n  margin-top: 20px;\\r\\n  margin-bottom: 20px;\\r\\n}\\r\\n\\r\\nbody {\\r\\n  min-height: 150px;\\r\\n}\\n\"}]}]]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-an-interval-that-fires-twice\",\"children\":\"ä¿®å¤ä¼šè§¦å‘ä¸¤æ¬¡çš„å®šæ—¶å™¨ \"}],[\"$r\",\"p\",null,{\"children\":[\"è¿™ä¸ª \",[\"$r\",\"code\",null,{\"children\":\"Counter\"}],\" ç»„ä»¶å±•ç¤ºäº†ä¸€ä¸ªæ¯ç§’é€’å¢çš„è®¡æ•°å™¨ã€‚åœ¨ç»„ä»¶æŒ‚è½½æ—¶ï¼Œå®ƒè°ƒç”¨äº† \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/setInterval\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"setInterval\"}]}],\"ã€‚è¿™ä½¿å¾— \",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" æ¯ç§’è¿è¡Œä¸€æ¬¡ã€‚\",[\"$r\",\"code\",null,{\"children\":\"onTick\"}],\" å‡½æ•°ä¼šé€’å¢è®¡æ•°å™¨ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"ç„¶è€Œï¼Œè®¡æ•°å™¨ä¸æ˜¯æ¯ç§’é€’å¢ä¸€æ¬¡ï¼Œè€Œæ˜¯ä¸¤æ¬¡ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ‰¾å‡º bug çš„åŸå› å¹¶ä¿®å¤å®ƒã€‚\"}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":[\"è¯·è®°ä½ï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"setInterval\"}],\" è¿”å›ä¸€ä¸ª interval IDï¼Œä½ å¯ä»¥å°†å®ƒä¼ é€’ç»™ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/clearInterval\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"clearInterval\"}]}],\" æ¥åœæ­¢è¿™ä¸ªå®šæ—¶å™¨ã€‚\"]}]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/Counter.js active\",\"children\":\"import { useState, useEffect } from 'react';\\r\\n\\r\\nexport default function Counter() {\\r\\n  const [count, setCount] = useState(0);\\r\\n\\r\\n  useEffect(() => {\\r\\n    function onTick() {\\r\\n      setCount(c => c + 1);\\r\\n    }\\r\\n\\r\\n    setInterval(onTick, 1000);\\r\\n  }, []);\\r\\n\\r\\n  return <h1>{count}</h1>;\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js hidden\",\"children\":\"import { useState } from 'react';\\r\\nimport Counter from './Counter.js';\\r\\n\\r\\nexport default function Form() {\\r\\n  const [show, setShow] = useState(false);\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setShow(s => !s)}>{show ? 'éšè—' : 'å±•ç¤º'}è®¡æ•°å™¨</button>\\r\\n      <br />\\r\\n      <hr />\\r\\n      {show && <Counter />}\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label {\\r\\n  display: block;\\r\\n  margin-top: 20px;\\r\\n  margin-bottom: 20px;\\r\\n}\\r\\n\\r\\nbody {\\r\\n  min-height: 150px;\\r\\n}\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"å½“å¼€å¯ \",[\"$r\",\"a\",null,{\"href\":\"/reference/react/StrictMode\",\"children\":\"ä¸¥æ ¼æ¨¡å¼\"}],\" æ—¶ï¼ˆä¾‹å¦‚åœ¨æœ¬ç«™çš„ç¤ºä¾‹æ²™ç›’ï¼ˆsandboxï¼‰ä¸­ï¼‰ï¼ŒReact åœ¨å¼€å‘ç¯å¢ƒä¸­ä¼šå°†æ¯ä¸ªç»„ä»¶é‡æ–°æŒ‚è½½ä¸€æ¬¡ã€‚è¿™ä½¿å¾—è®¡æ•°å™¨ç»„ä»¶è¢«æŒ‚è½½äº†ä¸¤æ¬¡ï¼Œäºæ˜¯å®šæ—¶å™¨ä¹Ÿè¢«è®¾ç½®äº†ä¸¤æ¬¡ï¼Œå› æ­¤è®¡æ•°å™¨ä¼šæ¯ç§’å¢åŠ ä¸¤æ¬¡ã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"ç„¶è€Œï¼ŒReact çš„è¡Œä¸ºå¹¶ä¸æ˜¯å¯¼è‡´è¿™ä¸ª bug çš„æ ¹æœ¬åŸå› ï¼šä»£ç ä¸­æœ¬å°±å­˜åœ¨è¿™ä¸ª bugã€‚React çš„è¡Œä¸ºåªæ˜¯è®©è¿™ä¸ª bug æ›´åŠ æ˜æ˜¾ã€‚çœŸæ­£çš„åŸå› æ˜¯è¿™ä¸ª Effect å¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹ä½†æ²¡æœ‰æä¾›æ¸…ç†å®ƒçš„æ–¹å¼ã€‚\"}],[\"$r\",\"p\",null,{\"children\":[\"è¦ä¿®å¤è¿™æ®µä»£ç ï¼Œä¿å­˜ \",[\"$r\",\"code\",null,{\"children\":\"setInterval\"}],\" è¿”å›çš„ interval IDï¼Œå¹¶ä½¿ç”¨ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/clearInterval\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"clearInterval\"}]}],\" å®ç°ä¸€ä¸ªæ¸…ç†å‡½æ•°ï¼š\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/Counter.js active\",\"children\":\"import { useState, useEffect } from 'react';\\r\\n\\r\\nexport default function Counter() {\\r\\n  const [count, setCount] = useState(0);\\r\\n\\r\\n  useEffect(() => {\\r\\n    function onTick() {\\r\\n      setCount(c => c + 1);\\r\\n    }\\r\\n\\r\\n    const intervalId = setInterval(onTick, 1000);\\r\\n    return () => clearInterval(intervalId);\\r\\n  }, []);\\r\\n\\r\\n  return <h1>{count}</h1>;\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js hidden\",\"children\":\"import { useState } from 'react';\\r\\nimport Counter from './Counter.js';\\r\\n\\r\\nexport default function App() {\\r\\n  const [show, setShow] = useState(false);\\r\\n  return (\\r\\n    <>\\r\\n      <button onClick={() => setShow(s => !s)}>{show ? 'éšè—' : 'å±•ç¤º'}è®¡æ•°å™¨</button>\\r\\n      <br />\\r\\n      <hr />\\r\\n      {show && <Counter />}\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"label {\\r\\n  display: block;\\r\\n  margin-top: 20px;\\r\\n  margin-bottom: 20px;\\r\\n}\\r\\n\\r\\nbody {\\r\\n  min-height: 150px;\\r\\n}\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼ŒReact ä»ç„¶ä¼šé‡æ–°æŒ‚è½½ä¸€æ¬¡ä½ çš„ç»„ä»¶ï¼Œä»¥ç¡®ä¿ä½ å·²ç»æ­£ç¡®åœ°å®ç°äº†æ¸…ç†å‡½æ•°ã€‚å› æ­¤ï¼Œåœ¨è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setInterval\"}],\" åä¼šç´§æ¥ç€è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"clearInterval\"}],\"ï¼Œç„¶åå†è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setInterval\"}],\"ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåˆ™åªè°ƒç”¨ä¸€æ¬¡ \",[\"$r\",\"code\",null,{\"children\":\"setInterval\"}],\"ã€‚ä¸¤ç§æƒ…å†µä¸‹ç”¨æˆ·å¯è§çš„è¡Œä¸ºéƒ½æ˜¯ç›¸åŒçš„ï¼šè®¡æ•°å™¨æ¯ç§’é€’å¢ä¸€æ¬¡ã€‚\"]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-fetching-inside-an-effect\",\"children\":\"è§£å†³åœ¨ Effect ä¸­è·å–æ•°æ®çš„é—®é¢˜ \"}],[\"$r\",\"p\",null,{\"children\":[\"ä¸‹é¢è¿™ä¸ªç»„ä»¶æ˜¾ç¤ºæ‰€é€‰äººç‰©çš„ä¼ è®°ã€‚å®ƒåœ¨æŒ‚è½½æ—¶å’Œæ¯å½“ \",[\"$r\",\"code\",null,{\"children\":\"person\"}],\" æ”¹å˜æ—¶ï¼Œé€šè¿‡è°ƒç”¨ä¸€ä¸ªå¼‚æ­¥å‡½æ•° \",[\"$r\",\"code\",null,{\"children\":\"fetchBio(person)\"}],\" æ¥åŠ è½½ä¼ è®°ã€‚è¯¥å¼‚æ­¥å‡½æ•°è¿”å›ä¸€ä¸ª \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"Promise\"}],\"ï¼Œæœ€ç»ˆè§£æä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å½“è¯·æ±‚ç»“æŸæ—¶ï¼Œå®ƒè°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setBio\"}],\" ä»¥å°†è¯¥å­—ç¬¦ä¸²æ˜¾ç¤ºåœ¨é€‰æ‹©æ¡†ä¸‹æ–¹ã€‚\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState, useEffect } from 'react';\\r\\nimport { fetchBio } from './api.js';\\r\\n\\r\\nexport default function Page() {\\r\\n  const [person, setPerson] = useState('Alice');\\r\\n  const [bio, setBio] = useState(null);\\r\\n\\r\\n  useEffect(() => {\\r\\n    setBio(null);\\r\\n    fetchBio(person).then(result => {\\r\\n      setBio(result);\\r\\n    });\\r\\n  }, [person]);\\r\\n\\r\\n  return (\\r\\n    <>\\r\\n      <select value={person} onChange={e => {\\r\\n        setPerson(e.target.value);\\r\\n      }}>\\r\\n        <option value=\\\"Alice\\\">Alice</option>\\r\\n        <option value=\\\"Bob\\\">Bob</option>\\r\\n        <option value=\\\"Taylor\\\">Taylor</option>\\r\\n      </select>\\r\\n      <hr />\\r\\n      <p><i>{bio ?? 'åŠ è½½ä¸­â€¦â€¦'}</i></p>\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/api.js hidden\",\"children\":\"export async function fetchBio(person) {\\r\\n  const delay = person === 'Bob' ? 2000 : 200;\\r\\n  return new Promise(resolve => {\\r\\n    setTimeout(() => {\\r\\n      resolve('è¿™æ˜¯' + person + 'çš„ä¼ è®°ã€‚');\\r\\n    }, delay);\\r\\n  })\\r\\n}\\r\\n\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™æ®µä»£ç ä¸­æœ‰ä¸€ä¸ª bugã€‚è¯•è¯•å…ˆé€‰æ‹© \",[\"$r\",\"code\",null,{\"children\":\"Alice\"}],\"ï¼Œå†é€‰æ‹© \",[\"$r\",\"code\",null,{\"children\":\"Bob\"}],\"ï¼Œæ¥ç€ç«‹å³é€‰æ‹© \",[\"$r\",\"code\",null,{\"children\":\"Taylor\"}],\"ã€‚å¦‚æœæ“ä½œå¾—è¶³å¤Ÿå¿«ï¼Œä½ ä¼šè§‚å¯Ÿåˆ°è¿™ä¸ª bugï¼šè™½ç„¶ Taylor è¢«é€‰ä¸­äº†ï¼Œä½†ä¸‹é¢çš„ä¸€æ®µå´è¯´ï¼šâ€œè¿™æ˜¯ Bob çš„ä¼ è®°ã€‚â€\"]}],[\"$r\",\"p\",null,{\"children\":\"ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿè¯•è¯•ä¿®å¤è¿™ä¸ª Effect ä¸­çš„ bugã€‚\"}],[\"$r\",\"Hint\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"å¦‚æœ Effect éœ€è¦å¼‚æ­¥è·å–æŸäº›æ•°æ®ï¼Œå®ƒå¾€å¾€éœ€è¦æ¸…ç†å‡½æ•°ã€‚\"}]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":\"è¦è§¦å‘è¿™ä¸ª bugï¼Œäº‹æƒ…éœ€è¦æŒ‰ä»¥ä¸‹é¡ºåºå‘ç”Ÿï¼š\"}],[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"é€‰ä¸­ \",[\"$r\",\"code\",null,{\"children\":\"'Bob'\"}],\" è§¦å‘ \",[\"$r\",\"code\",null,{\"children\":\"fetchBio('Bob')\"}]]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"é€‰ä¸­ \",[\"$r\",\"code\",null,{\"children\":\"'Taylor'\"}],\" è§¦å‘ \",[\"$r\",\"code\",null,{\"children\":\"fetchBio('Taylor')\"}]]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"fetchBio('Taylor')\"}],\" åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"fetchBio('Bob')\"}],\" ä¹‹å‰å®Œæˆã€‚\"]}]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"æ¸²æŸ“ \",[\"$r\",\"code\",null,{\"children\":\"'Taylor'\"}],\" æ—¶çš„ Effect è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setBio('è¿™æ˜¯Taylorçš„ä¼ è®°')\"}]]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"fetchBio('Bob')\"}],\" è¯·æ±‚å®Œæˆ\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"æ¸²æŸ“ \",[\"$r\",\"code\",null,{\"children\":\"'Bob'\"}],\" æ—¶çš„ Effect è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setBio('è¿™æ˜¯Bobçš„ä¼ è®°')\"}]]}],\"\\n\"]}],[\"$r\",\"p\",null,{\"children\":[\"è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå³ä½¿é€‰æ‹©äº† Taylorï¼Œä½†æ˜¾ç¤ºçš„ä»ç„¶æ˜¯ Bob çš„ä¼ è®°ã€‚åƒè¿™æ ·çš„ bug è¢«ç§°ä¸º \",[\"$r\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/Race_condition\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"ç«æ€æ¡ä»¶\"}],\"ï¼Œå› ä¸ºä¸¤ä¸ªå¼‚æ­¥æ“ä½œåœ¨â€œç«é€Ÿâ€ï¼Œå¹¶ä¸”å¯èƒ½ä¼šä»¥æ„å¤–çš„é¡ºåºå®Œæˆã€‚\"]}],[\"$r\",\"p\",null,{\"children\":\"è¦ä¿®å¤è¿™ä¸ª bugï¼Œæ·»åŠ ä¸€ä¸ªæ¸…ç†å‡½æ•°ï¼š\"}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState, useEffect } from 'react';\\r\\nimport { fetchBio } from './api.js';\\r\\n\\r\\nexport default function Page() {\\r\\n  const [person, setPerson] = useState('Alice');\\r\\n  const [bio, setBio] = useState(null);\\r\\n  useEffect(() => {\\r\\n    let ignore = false;\\r\\n    setBio(null);\\r\\n    fetchBio(person).then(result => {\\r\\n      if (!ignore) {\\r\\n        setBio(result);\\r\\n      }\\r\\n    });\\r\\n    return () => {\\r\\n      ignore = true;\\r\\n    }\\r\\n  }, [person]);\\r\\n\\r\\n  return (\\r\\n    <>\\r\\n      <select value={person} onChange={e => {\\r\\n        setPerson(e.target.value);\\r\\n      }}>\\r\\n        <option value=\\\"Alice\\\">Alice</option>\\r\\n        <option value=\\\"Bob\\\">Bob</option>\\r\\n        <option value=\\\"Taylor\\\">Taylor</option>\\r\\n      </select>\\r\\n      <hr />\\r\\n      <p><i>{bio ?? 'åŠ è½½ä¸­â€¦â€¦'}</i></p>\\r\\n    </>\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/api.js hidden\",\"children\":\"export async function fetchBio(person) {\\r\\n  const delay = person === 'Bob' ? 2000 : 200;\\r\\n  return new Promise(resolve => {\\r\\n    setTimeout(() => {\\r\\n      resolve('è¿™æ˜¯' + person + 'çš„ä¼ è®°ã€‚');\\r\\n    }, delay);\\r\\n  })\\r\\n}\\r\\n\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":[\"æ¯è½®æ¸²æŸ“çš„ Effect éƒ½æœ‰å…¶ç‹¬ç«‹çš„ \",[\"$r\",\"code\",null,{\"children\":\"ignore\"}],\" å˜é‡ã€‚æœ€åˆï¼Œ\",[\"$r\",\"code\",null,{\"children\":\"ignore\"}],\" å˜é‡è¢«è®¾ç½®ä¸º \",[\"$r\",\"code\",null,{\"children\":\"false\"}],\"ã€‚ä½†å¦‚æœä¸€ä¸ª Effect è¢«æ¸…ç†ï¼ˆä¾‹å¦‚ï¼Œå½“ä½ é€‰æ‹©ä¸åŒçš„äººæ—¶ï¼‰ï¼Œå®ƒçš„ \",[\"$r\",\"code\",null,{\"children\":\"ignore\"}],\" å˜é‡ä¼šå˜ä¸º \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\"ã€‚å› æ­¤ï¼Œè¯·æ±‚å®Œæˆçš„é¡ºåºå·²ç»ä¸å†é‡è¦ã€‚åªæœ‰æœ€åé€‰ä¸­çš„äººçš„ Effect çš„ \",[\"$r\",\"code\",null,{\"children\":\"ignore\"}],\" å˜é‡ä¼šæ˜¯ \",[\"$r\",\"code\",null,{\"children\":\"false\"}],\"ï¼Œå› æ­¤å®ƒå°†ä¼šè°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setBio(result)\"}],\"ã€‚è€Œä¹‹å‰çš„ Effect å·²ç»è¢«æ¸…ç†ï¼Œæ‰€ä»¥ \",[\"$r\",\"code\",null,{\"children\":\"if (!ignore)\"}],\" çš„æ£€æŸ¥ä¼šé˜»æ­¢å®ƒä»¬è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setBio\"}],\"ï¼š\"]}],[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"é€‰ä¸­ \",[\"$r\",\"code\",null,{\"children\":\"'Bob'\"}],\" è§¦å‘ \",[\"$r\",\"code\",null,{\"children\":\"fetchBio('Bob')\"}]]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"é€‰ä¸­ \",[\"$r\",\"code\",null,{\"children\":\"'Taylor'\"}],\" è§¦å‘ \",[\"$r\",\"code\",null,{\"children\":\"fetchBio('Taylor')\"}],\"ï¼Œ\",[\"$r\",\"strong\",null,{\"children\":\"å¹¶æ¸…ç†ä¹‹å‰çš„ï¼ˆBob çš„ï¼‰ Effect\"}]]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"fetchBio('Taylor')\"}],\" åœ¨ \",[\"$r\",\"code\",null,{\"children\":\"fetchBio('Bob')\"}],\" \",[\"$r\",\"strong\",null,{\"children\":\"ä¹‹å‰\"}],\" å®Œæˆã€‚\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"æ¸²æŸ“ \",[\"$r\",\"code\",null,{\"children\":\"'Taylor'\"}],\" æ—¶çš„ Effect è°ƒç”¨ \",[\"$r\",\"code\",null,{\"children\":\"setBio('è¿™æ˜¯Taylorçš„ä¼ è®°')\"}]]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"fetchBio('Bob')\"}],\" è¯·æ±‚å®Œæˆ\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"æ¸²æŸ“ \",[\"$r\",\"code\",null,{\"children\":\"'Bob'\"}],\" æ—¶çš„ Effect ä¸ä¼šåšä»»ä½•äº‹æƒ…ï¼Œå› ä¸ºå®ƒçš„ \",[\"$r\",\"code\",null,{\"children\":\"ignore\"}],\" å˜é‡è¢«è®¾ä¸ºäº† \",[\"$r\",\"code\",null,{\"children\":\"true\"}],\"ã€‚\"]}],\"\\n\"]}],[\"$r\",\"p\",null,{\"children\":[\"é™¤äº†å¿½ç•¥è¿‡æ—¶ API è°ƒç”¨çš„ç»“æœå¤–ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"AbortController\"}]}],\" æ¥å–æ¶ˆä¸å†éœ€è¦çš„è¯·æ±‚ã€‚ç„¶è€Œï¼Œä»…å‡­è¿™ä¸€ç‚¹è¿˜ä¸è¶³ä»¥é˜²æ­¢ç«æ€æ¡ä»¶ã€‚å› ä¸ºå¯èƒ½åœ¨ fetch ä¹‹åè¿˜æœ‰æ›´å¤šçš„å¼‚æ­¥æ“ä½œï¼Œå› æ­¤ä½¿ç”¨åƒ \",[\"$r\",\"code\",null,{\"children\":\"ignore\"}],\" è¿™æ ·çš„æ˜¾å¼æ ‡å¿—æ˜¯è§£å†³è¿™ç±»é—®é¢˜æœ€å¯é çš„æ–¹æ³•ã€‚\"]}]]}]]}]]","meta":{"title":"ä½¿ç”¨ Effect è¿›è¡ŒåŒæ­¥"},"languages":null},"__N_SSG":true}