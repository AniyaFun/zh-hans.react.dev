<!DOCTYPE html><html lang="zh-hans" dir="ltr"><head><meta charSet="utf-8"/><link rel="preconnect" href="https://1FCF9AYYAT-dsn.algolia.net"/><link rel="preload" as="style" href="/_next/static/css/69c3dd7f95e90f41.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B1E83PJ3RT"></script><link rel="preload" as="script" href="/_next/static/chunks/webpack-7aa5606533a0da22.js"/><link rel="preload" as="script" href="/_next/static/chunks/framework-60dbcc17f2b10a40.js"/><link rel="preload" as="script" href="/_next/static/chunks/main-691602c61f9ae952.js"/><link rel="preload" as="script" href="/_next/static/chunks/pages/_app-91cab47494e285be.js"/><link rel="preload" as="script" href="/_next/static/chunks/181-0c884f228c508338.js"/><link rel="preload" as="script" href="/_next/static/chunks/962-d27b3139d5233d22.js"/><link rel="preload" as="script" href="/_next/static/chunks/pages/%5B%5B...markdownPath%5D%5D-3fa615249ba59b83.js"/><link rel="preload" as="script" href="/_next/static/o3sV9gi4zL8eH-vfCdLA_/_buildManifest.js"/><link rel="preload" as="script" href="/_next/static/o3sV9gi4zL8eH-vfCdLA_/_ssgManifest.js"/><link rel="preload" href="/fonts/Source-Code-Pro-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://react.dev/fonts/Optimistic_Display_W_Md.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://react.dev/fonts/Optimistic_Display_W_SBd.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://react.dev/fonts/Optimistic_Display_W_Bd.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://react.dev/fonts/Optimistic_Text_W_Md.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://react.dev/fonts/Optimistic_Text_W_Bd.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://react.dev/fonts/Optimistic_Text_W_Rg.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://react.dev/fonts/Optimistic_Text_W_It.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/69c3dd7f95e90f41.css" as="style"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>更新 state 中的数组 – React 中文文档</title><link rel="canonical" href="https://zh-hans.react.dev/learn/updating-arrays-in-state"/><link rel="alternate" href="https://react.dev/learn/updating-arrays-in-state" hrefLang="x-default"/><link rel="alternate" hrefLang="en" href="https://react.dev/learn/updating-arrays-in-state"/><link rel="alternate" hrefLang="zh-hans" href="https://zh-hans.react.dev/learn/updating-arrays-in-state"/><link rel="alternate" hrefLang="es" href="https://es.react.dev/learn/updating-arrays-in-state"/><link rel="alternate" hrefLang="fr" href="https://fr.react.dev/learn/updating-arrays-in-state"/><link rel="alternate" hrefLang="ja" href="https://ja.react.dev/learn/updating-arrays-in-state"/><link rel="alternate" hrefLang="tr" href="https://tr.react.dev/learn/updating-arrays-in-state"/><link rel="alternate" hrefLang="ko" href="https://ko.react.dev/learn/updating-arrays-in-state"/><meta property="fb:app_id" content="623268441017527"/><meta property="og:type" content="website"/><meta property="og:url" content="https://zh-hans.react.dev/learn/updating-arrays-in-state"/><meta property="og:title" content="更新 state 中的数组 – React 中文文档"/><meta property="og:description" content="The library for web and native user interfaces"/><meta property="og:image" content="https://zh-hans.react.dev/images/og-learn.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@reactjs"/><meta name="twitter:creator" content="@reactjs"/><meta name="twitter:title" content="更新 state 中的数组 – React 中文文档"/><meta name="twitter:description" content="The library for web and native user interfaces"/><meta name="twitter:image" content="https://zh-hans.react.dev/images/og-learn.png"/><meta name="google-site-verification" content="sIlAGs48RulR4DdP95YSWNKZIEtCqQmRjzn-Zq-CcD0"/><meta name="algolia-search-order" content="31"/><meta name="next-head-count" content="36"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#404756"/><meta name="msapplication-TileColor" content="#2b5797"/><meta name="theme-color" content="#23272f"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=%2Fimages%2Fuwu.png&amp;w=64&amp;q=75 1x, /_next/image?url=%2Fimages%2Fuwu.png&amp;w=128&amp;q=75 2x" fetchPriority="high"/><link rel="stylesheet" href="/_next/static/css/69c3dd7f95e90f41.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-7aa5606533a0da22.js" defer=""></script><script src="/_next/static/chunks/framework-60dbcc17f2b10a40.js" defer=""></script><script src="/_next/static/chunks/main-691602c61f9ae952.js" defer=""></script><script src="/_next/static/chunks/pages/_app-91cab47494e285be.js" defer=""></script><script src="/_next/static/chunks/181-0c884f228c508338.js" defer=""></script><script src="/_next/static/chunks/962-d27b3139d5233d22.js" defer=""></script><script src="/_next/static/chunks/pages/%5B%5B...markdownPath%5D%5D-3fa615249ba59b83.js" defer=""></script><script src="/_next/static/o3sV9gi4zL8eH-vfCdLA_/_buildManifest.js" defer=""></script><script src="/_next/static/o3sV9gi4zL8eH-vfCdLA_/_ssgManifest.js" defer=""></script></head><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-B1E83PJ3RT');</script><body class="font-text font-medium antialiased text-lg bg-wash dark:bg-wash-dark text-secondary dark:text-secondary-dark leading-base"><script>
              (function () {
                try {
                  let logShown = false;
                  function setUwu(isUwu) {
                    try {
                      if (isUwu) {
                        localStorage.setItem('uwu', true);
                        document.documentElement.classList.add('uwu');
                        if (!logShown) {
                          console.log('uwu mode! turn off with ?uwu=0');
                          console.log('logo credit to @sawaratsuki1004 via https://github.com/SAWARATSUKI/ServiceLogos');
                          logShown = true;
                        }
                      } else {
                        localStorage.removeItem('uwu');
                        document.documentElement.classList.remove('uwu');
                        console.log('uwu mode off. turn on with ?uwu');
                      }
                    } catch (err) { }
                  }
                  window.__setUwu = setUwu;
                  function checkQueryParam() {
                    const params = new URLSearchParams(window.location.search);
                    const value = params.get('uwu');
                    switch(value) {
                      case '':
                      case 'true':
                      case '1':
                        return true;
                      case 'false':
                      case '0':
                        return false;
                      default:
                        return null;
                    }
                  }
                  function checkLocalStorage() {
                    try {
                      return localStorage.getItem('uwu') === 'true';
                    } catch (err) {
                      return false;
                    }
                  }
                  const uwuQueryParam = checkQueryParam();
                  if (uwuQueryParam != null) {
                    setUwu(uwuQueryParam);
                  } else if (checkLocalStorage()) {
                    document.documentElement.classList.add('uwu');
                  }
                } catch (err) { }
              })();
            </script><script>
                (function () {
                  function setTheme(newTheme) {
                    window.__theme = newTheme;
                    if (newTheme === 'dark') {
                      document.documentElement.classList.add('dark');
                    } else if (newTheme === 'light') {
                      document.documentElement.classList.remove('dark');
                    }
                  }

                  var preferredTheme;
                  try {
                    preferredTheme = localStorage.getItem('theme');
                  } catch (err) { }

                  window.__setPreferredTheme = function(newTheme) {
                    preferredTheme = newTheme;
                    setTheme(newTheme);
                    try {
                      localStorage.setItem('theme', newTheme);
                    } catch (err) { }
                  };

                  var initialTheme = preferredTheme;
                  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');

                  if (!initialTheme) {
                    initialTheme = darkQuery.matches ? 'dark' : 'light';
                  }
                  setTheme(initialTheme);

                  darkQuery.addEventListener('change', function (e) {
                    if (!preferredTheme) {
                      setTheme(e.matches ? 'dark' : 'light');
                    }
                  });

                  // Detect whether the browser is Mac to display platform specific content
                  // An example of such content can be the keyboard shortcut displayed in the search bar
                  document.documentElement.classList.add(
                      window.navigator.platform.includes('Mac')
                      ? "platform-mac" 
                      : "platform-win"
                  );
                })();
              </script><div id="__next"><div></div><div class="z-40 sticky top-0"><nav class="duration-300 backdrop-filter backdrop-blur-lg backdrop-saturate-200 transition-shadow bg-opacity-90 items-center w-full flex justify-between bg-wash dark:bg-wash-dark dark:bg-opacity-95 px-1.5 lg:pe-5 lg:ps-4 z-40"><div class="flex items-center justify-between w-full h-16 gap-0 sm:gap-3"><div class="flex flex-row 3xl:flex-1 items-centers"><button type="button" aria-label="Menu" class="active:scale-95 transition-transform flex lg:hidden w-12 h-12 rounded-full items-center justify-center hover:bg-primary/5 hover:dark:bg-primary-dark/5 outline-link"><svg width="1.33em" height="1.33em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button><span data-state="closed" class="flex items-center" style="-webkit-touch-callout:none"><div class="flex items-center"><div class="uwu-visible flex items-center justify-center h-full"><a href="/"><img alt="logo by @sawaratsuki1004" title="logo by @sawaratsuki1004" fetchPriority="high" width="63" height="32" decoding="async" data-nimg="1" class="h-8" style="color:transparent" srcSet="/_next/image?url=%2Fimages%2Fuwu.png&amp;w=64&amp;q=75 1x, /_next/image?url=%2Fimages%2Fuwu.png&amp;w=128&amp;q=75 2x" src="/_next/image?url=%2Fimages%2Fuwu.png&amp;w=128&amp;q=75"/></a></div><div class="uwu-hidden"><a class="active:scale-95 overflow-hidden transition-transform relative items-center text-primary dark:text-primary-dark p-1 whitespace-nowrap outline-link rounded-full 3xl:rounded-xl inline-flex text-lg font-normal gap-2" href="/"><svg width="100%" height="100%" viewBox="-10.5 -9.45 21 18.9" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-sm me-0 w-10 h-10 text-brand dark:text-brand-dark flex origin-center transition-all ease-in-out"><circle cx="0" cy="0" r="2" fill="currentColor"></circle><g stroke="currentColor" stroke-width="1" fill="none"><ellipse rx="10" ry="4.5"></ellipse><ellipse rx="10" ry="4.5" transform="rotate(60)"></ellipse><ellipse rx="10" ry="4.5" transform="rotate(120)"></ellipse></g></svg><span class="sr-only 3xl:not-sr-only">React</span></a></div></div></span><div class="flex flex-column justify-center items-center"><a class=" flex py-2 flex-column justify-center items-center text-gray-50 dark:text-gray-30 hover:text-link hover:dark:text-link-dark hover:underline text-sm ms-1 cursor-pointer" href="/versions">v<!-- -->18.3.1</a></div></div><div class="items-center justify-center flex-1 hidden w-full md:flex 3xl:w-auto 3xl:shrink-0 3xl:justify-center"><button type="button" class="flex 3xl:w-[56rem] 3xl:mx-0 relative ps-4 pe-1 py-1 h-10 bg-gray-30/20 dark:bg-gray-40/20 outline-none focus:outline-link betterhover:hover:bg-opacity-80 pointer items-center text-start w-full text-gray-30 rounded-full align-middle text-base"><svg width="1em" height="1em" viewBox="0 0 20 20" class="align-middle me-3 text-gray-30 shrink-0 group-betterhover:hover:text-gray-70"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" stroke-width="2" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>搜索<span class="hidden ms-auto sm:flex item-center me-1"><kbd class="w-5 h-5 border border-transparent me-1 bg-wash dark:bg-wash-dark text-gray-30 align-middle p-0 inline-flex justify-center items-center text-xs text-center rounded-md" data-platform="mac">⌘</kbd><kbd class="w-10 h-5 border border-transparent me-1 bg-wash dark:bg-wash-dark text-gray-30 align-middle p-0 inline-flex justify-center items-center text-xs text-center rounded-md" data-platform="win">Ctrl</kbd><kbd class="w-5 h-5 border border-transparent me-1 bg-wash dark:bg-wash-dark text-gray-30 align-middle p-0 inline-flex justify-center items-center text-xs text-center rounded-md">K</kbd></span></button></div><div class="text-base justify-center items-center gap-1.5 flex 3xl:flex-1 flex-row 3xl:justify-end"><div class="mx-2.5 gap-1.5 hidden lg:flex"></div><div class="flex w-full md:hidden"></div><div class="flex items-center -space-x-2.5 xs:space-x-0 "><div class="flex md:hidden"><button aria-label="Search" type="button" class="flex items-center justify-center w-12 h-12 transition-transform rounded-full active:scale-95 md:hidden hover:bg-secondary-button hover:dark:bg-secondary-button-dark outline-link"><svg width="1em" height="1em" viewBox="0 0 20 20" class="w-5 h-5 align-middle"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" stroke-width="2" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div><div class="flex dark:hidden"><button type="button" aria-label="Use Dark Mode" class="flex items-center justify-center w-12 h-12 transition-transform rounded-full active:scale-95 hover:bg-primary/5 hover:dark:bg-primary-dark/5 outline-link"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 32 32"><g fill="none" fill-rule="evenodd" transform="translate(-440 -200)"><path fill="currentColor" fill-rule="nonzero" stroke="currentColor" stroke-width="0.5" d="M102,21 C102,18.1017141 103.307179,15.4198295 105.51735,13.6246624 C106.001939,13.2310647 105.821611,12.4522936 105.21334,12.3117518 C104.322006,12.1058078 103.414758,12 102.5,12 C95.8722864,12 90.5,17.3722864 90.5,24 C90.5,30.6277136 95.8722864,36 102.5,36 C106.090868,36 109.423902,34.4109093 111.690274,31.7128995 C112.091837,31.2348572 111.767653,30.5041211 111.143759,30.4810139 C106.047479,30.2922628 102,26.1097349 102,21 Z M102.5,34.5 C96.7007136,34.5 92,29.7992864 92,24 C92,18.2007136 96.7007136,13.5 102.5,13.5 C102.807386,13.5 103.113925,13.5136793 103.419249,13.5407785 C101.566047,15.5446378 100.5,18.185162 100.5,21 C100.5,26.3198526 104.287549,30.7714322 109.339814,31.7756638 L109.516565,31.8092927 C107.615276,33.5209452 105.138081,34.5 102.5,34.5 Z" transform="translate(354.5 192)"></path><polygon points="444 228 468 228 468 204 444 204"></polygon></g></svg></button></div><div class="hidden dark:flex"><button type="button" aria-label="Use Light Mode" class="flex items-center justify-center w-12 h-12 transition-transform rounded-full active:scale-95 hover:bg-primary/5 hover:dark:bg-primary-dark/5 outline-link"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><g fill="none" fill-rule="evenodd" transform="translate(-442 -200)"><g fill="currentColor" transform="translate(356 144)"><path fill-rule="nonzero" d="M108.5 24C108.5 27.5902136 105.590214 30.5 102 30.5 98.4097864 30.5 95.5 27.5902136 95.5 24 95.5 20.4097864 98.4097864 17.5 102 17.5 105.590214 17.5 108.5 20.4097864 108.5 24zM107 24C107 21.2382136 104.761786 19 102 19 99.2382136 19 97 21.2382136 97 24 97 26.7617864 99.2382136 29 102 29 104.761786 29 107 26.7617864 107 24zM101 12.75L101 14.75C101 15.1642136 101.335786 15.5 101.75 15.5 102.164214 15.5 102.5 15.1642136 102.5 14.75L102.5 12.75C102.5 12.3357864 102.164214 12 101.75 12 101.335786 12 101 12.3357864 101 12.75zM95.7255165 14.6323616L96.7485165 16.4038616C96.9556573 16.7625614 97.4143618 16.8854243 97.7730616 16.6782835 98.1317614 16.4711427 98.2546243 16.0124382 98.0474835 15.6537384L97.0244835 13.8822384C96.8173427 13.5235386 96.3586382 13.4006757 95.9999384 13.6078165 95.6412386 13.8149573 95.5183757 14.2736618 95.7255165 14.6323616zM91.8822384 19.0244835L93.6537384 20.0474835C94.0124382 20.2546243 94.4711427 20.1317614 94.6782835 19.7730616 94.8854243 19.4143618 94.7625614 18.9556573 94.4038616 18.7485165L92.6323616 17.7255165C92.2736618 17.5183757 91.8149573 17.6412386 91.6078165 17.9999384 91.4006757 18.3586382 91.5235386 18.8173427 91.8822384 19.0244835zM90.75 25L92.75 25C93.1642136 25 93.5 24.6642136 93.5 24.25 93.5 23.8357864 93.1642136 23.5 92.75 23.5L90.75 23.5C90.3357864 23.5 90 23.8357864 90 24.25 90 24.6642136 90.3357864 25 90.75 25zM92.6323616 30.2744835L94.4038616 29.2514835C94.7625614 29.0443427 94.8854243 28.5856382 94.6782835 28.2269384 94.4711427 27.8682386 94.0124382 27.7453757 93.6537384 27.9525165L91.8822384 28.9755165C91.5235386 29.1826573 91.4006757 29.6413618 91.6078165 30.0000616 91.8149573 30.3587614 92.2736618 30.4816243 92.6323616 30.2744835zM97.0244835 34.1177616L98.0474835 32.3462616C98.2546243 31.9875618 98.1317614 31.5288573 97.7730616 31.3217165 97.4143618 31.1145757 96.9556573 31.2374386 96.7485165 31.5961384L95.7255165 33.3676384C95.5183757 33.7263382 95.6412386 34.1850427 95.9999384 34.3921835 96.3586382 34.5993243 96.8173427 34.4764614 97.0244835 34.1177616zM103 35.25L103 33.25C103 32.8357864 102.664214 32.5 102.25 32.5 101.835786 32.5 101.5 32.8357864 101.5 33.25L101.5 35.25C101.5 35.6642136 101.835786 36 102.25 36 102.664214 36 103 35.6642136 103 35.25zM108.274483 33.3676384L107.251483 31.5961384C107.044343 31.2374386 106.585638 31.1145757 106.226938 31.3217165 105.868239 31.5288573 105.745376 31.9875618 105.952517 32.3462616L106.975517 34.1177616C107.182657 34.4764614 107.641362 34.5993243 108.000062 34.3921835 108.358761 34.1850427 108.481624 33.7263382 108.274483 33.3676384zM112.117762 28.9755165L110.346262 27.9525165C109.987562 27.7453757 109.528857 27.8682386 109.321717 28.2269384 109.114576 28.5856382 109.237439 29.0443427 109.596138 29.2514835L111.367638 30.2744835C111.726338 30.4816243 112.185043 30.3587614 112.392183 30.0000616 112.599324 29.6413618 112.476461 29.1826573 112.117762 28.9755165zM113.25 23L111.25 23C110.835786 23 110.5 23.3357864 110.5 23.75 110.5 24.1642136 110.835786 24.5 111.25 24.5L113.25 24.5C113.664214 24.5 114 24.1642136 114 23.75 114 23.3357864 113.664214 23 113.25 23zM111.367638 17.7255165L109.596138 18.7485165C109.237439 18.9556573 109.114576 19.4143618 109.321717 19.7730616 109.528857 20.1317614 109.987562 20.2546243 110.346262 20.0474835L112.117762 19.0244835C112.476461 18.8173427 112.599324 18.3586382 112.392183 17.9999384 112.185043 17.6412386 111.726338 17.5183757 111.367638 17.7255165zM106.975517 13.8822384L105.952517 15.6537384C105.745376 16.0124382 105.868239 16.4711427 106.226938 16.6782835 106.585638 16.8854243 107.044343 16.7625614 107.251483 16.4038616L108.274483 14.6323616C108.481624 14.2736618 108.358761 13.8149573 108.000062 13.6078165 107.641362 13.4006757 107.182657 13.5235386 106.975517 13.8822384z" transform="translate(0 48)" stroke="currentColor" stroke-width="0.25"></path><path d="M98.6123,60.1372 C98.6123,59.3552 98.8753,58.6427 99.3368,58.0942 C99.5293,57.8657 99.3933,57.5092 99.0943,57.5017 C99.0793,57.5012 99.0633,57.5007 99.0483,57.5007 C97.1578,57.4747 95.5418,59.0312 95.5008,60.9217 C95.4578,62.8907 97.0408,64.5002 98.9998,64.5002 C99.7793,64.5002 100.4983,64.2452 101.0798,63.8142 C101.3183,63.6372 101.2358,63.2627 100.9478,63.1897 C99.5923,62.8457 98.6123,61.6072 98.6123,60.1372" transform="translate(3 11)"></path></g><polygon points="444 228 468 228 468 204 444 204"></polygon></g></svg></button></div><div class="flex"><a class="active:scale-95 transition-transform flex w-12 h-12 rounded-full items-center justify-center hover:bg-primary/5 hover:dark:bg-primary-dark/5 outline-link" aria-label="Translations" href="/community/translations"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d=" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z "></path></svg></a></div><div class="flex"></div></div></div></div></nav></div><div class="grid grid-cols-only-content lg:grid-cols-sidebar-content 2xl:grid-cols-sidebar-content-toc"><div class="lg:-mt-16 z-10"><div class="fixed top-0 py-0 shadow lg:pt-16 lg:sticky start-0 end-0 lg:shadow-none"><div class="sticky top-0 lg:bottom-0 lg:h-[calc(100vh-4rem)] flex flex-col"><div class="overflow-y-scroll no-bg-scrollbar lg:w-[342px] grow bg-wash dark:bg-wash-dark" style="overscroll-behavior:contain"><aside class="lg:grow flex-col w-full pb-8 lg:pb-0 lg:max-w-custom-xs z-10 hidden lg:block"><nav role="navigation" style="--bg-opacity:.2" class="w-full pt-6 scrolling-touch lg:h-auto grow pe-0 lg:pe-5 lg:pb-16 md:pt-4 lg:pt-4 scrolling-gpu"><!--$--><ul><h3 class="mb-1 text-sm font-bold ms-5 text-tertiary dark:text-tertiary-dark">起步</h3><li><a title="快速入门" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between ps-5 text-base font-bold text-primary dark:text-primary-dark" href="/learn"><div>快速入门<!-- --> </div><span class="pe-1 text-tertiary dark:text-tertiary-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" class="duration-100 ease-in transition -rotate-90 rtl:rotate-90" style="min-width:20px;min-height:20px"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></span></a><div class="opacity-50" style="transition:opacity 250ms ease-in-out"><div id="react-collapsed-panel-:R8im6:" aria-hidden="true" role="region" style="box-sizing:border-box;display:none;height:0px;overflow:hidden"><ul><li><a title="教程：井字棋游戏" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/tutorial-tic-tac-toe"><div>教程：井字棋游戏<!-- --> </div></a></li><li><a title="React 哲学" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/thinking-in-react"><div>React 哲学<!-- --> </div></a></li></ul></div></div></li><li><a title="安装" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between ps-5 text-base font-bold text-primary dark:text-primary-dark" href="/learn/installation"><div>安装<!-- --> </div><span class="pe-1 text-tertiary dark:text-tertiary-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" class="duration-100 ease-in transition -rotate-90 rtl:rotate-90" style="min-width:20px;min-height:20px"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></span></a><div class="opacity-50" style="transition:opacity 250ms ease-in-out"><div id="react-collapsed-panel-:R8qm6:" aria-hidden="true" role="region" style="box-sizing:border-box;display:none;height:0px;overflow:hidden"><ul><li><a title="启动一个新的 React 项目" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/start-a-new-react-project"><div>启动一个新的 React 项目<!-- --> </div></a></li><li><a title="将 React 添加到现有项目中" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/add-react-to-an-existing-project"><div>将 React 添加到现有项目中<!-- --> </div></a></li><li><a title="编辑器设置" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/editor-setup"><div>编辑器设置<!-- --> </div></a></li><li><a title="使用 TypeScript" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/typescript"><div>使用 TypeScript<!-- --> </div></a></li><li><a title="React 开发者工具" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/react-developer-tools"><div>React 开发者工具<!-- --> </div></a></li><li><a title="React Compiler" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/react-compiler"><div>React Compiler<!-- --> <svg class="ms-2 text-gray-30 dark:text-gray-60 inline-block w-4 h-4 align-[-3px]" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg"><title> - This feature is available in the latest Canary</title><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="noun-labs-1201738-(2)" transform="translate(2, 0)" fill="currentColor" fill-rule="nonzero"><path d="M10.2865804,5.55665262 L10.2865804,2.22331605 L10.8591544,2.22331605 C11.0103911,2.22244799 11.1551447,2.16342155 11.2617505,2.05914367 C11.3684534,1.95486857 11.4282767,1.81370176 11.4282767,1.66667106 L11.4282767,0.556642208 C11.4282767,0.40907262 11.3678934,0.26747526 11.2605218,0.16308627 C11.1531503,0.0587028348 11.0074938,0 10.8556998,0 L5.14338868,0 C4.9915947,0 4.84594391,0.0587028348 4.73856664,0.16308627 C4.63119507,0.267469704 4.57081178,0.40907262 4.57081178,0.556642208 L4.57081178,1.66667106 C4.57081178,1.81434899 4.63119507,1.95594912 4.73856664,2.06033811 C4.8459382,2.16472155 4.9915947,2.22331605 5.14338868,2.22331605 L5.71596273,2.22331605 L5.71596273,5.55665262 C5.71596273,8.38665538 2.97295619,9.88999017 0.651686904,15.5566623 C-0.0957823782,17.360053 -2.00560068,20 7.99951567,20 C18.004632,20 16.0948137,17.3600252 15.3507732,15.5566623 C13.0124432,9.88999017 10.2865804,8.38665538 10.2865804,5.55665262 Z M9.89570197,10.709991 C10.0921412,10.709991 10.2805515,10.7858383 10.4193876,10.9209301 C10.5583466,11.0559135 10.6363652,11.2390693 10.6363652,11.4300417 C10.6363652,11.6210141 10.5583466,11.8040698 10.4193876,11.9391533 C10.2805401,12.0741367 10.0921412,12.1499813 9.89570197,12.1499813 C9.6992627,12.1499813 9.51096673,12.074134 9.37201631,11.9391533 C9.23316875,11.8040615 9.15515307,11.6210141 9.15515307,11.4300417 C9.15515307,11.2390693 9.2331716,11.0559024 9.37201631,10.9209301 C9.57264221,10.7258996 9.61239426,10.709991 9.89570197,10.709991 Z M8.98919546,9.04212824 C9.09790709,9.14792278 9.15884755,9.29158681 9.1585213,9.44110085 C9.15829001,9.59073155 9.09678989,9.73407335 8.98763252,9.83954568 C8.87847514,9.945018 8.73069852,10.0039347 8.57678157,10.0033977 C8.42286747,10.0027392 8.27565088,9.94273467 8.16727355,9.83639845 C8.05900765,9.73006224 7.99873866,9.58628988 7.99963013,9.43664806 C8.00052304,9.28788403 8.0620221,9.14542556 8.17051087,9.04048101 C8.27911107,8.93555591 8.42599335,8.87663641 8.57913312,8.87663641 C8.73291864,8.87665585 8.88047525,8.93622535 8.98919546,9.04212824 Z M7.99965585,17.9999981 C4.91377349,17.9999981 3.29882839,17.7332867 2.51364277,17.4999976 C2.37780966,17.4476975 2.26954376,17.3439641 2.21396931,17.2125528 C2.15838628,17.0811499 2.16006066,16.9334692 2.21876871,16.8033858 C2.6144474,15.5921346 3.14916224,14.4280501 3.81316983,13.3333824 C5.980145,9.82337899 8.22941036,13.8867718 10.0980836,13.8867718 C11.9666996,13.8867718 11.4695868,12.1534924 12.1827971,13.3333824 C12.8511505,14.4269112 13.3916656,15.5896902 13.794259,16.8000524 C13.8533022,16.9322137 13.8537479,17.0822749 13.7952635,17.2147751 C13.7368889,17.3472613 13.6248314,17.4504531 13.4856467,17.5000531 C12.6833967,17.7332867 11.0855382,17.9999981 7.99965585,17.9999981 Z" id="Shape"></path></g></g></svg></div></a></li></ul></div></div></li><li role="separator" class="mt-4 mb-2 ms-5 border-b border-border dark:border-border-dark"></li><h3 class="mb-1 text-sm font-bold ms-5 text-tertiary dark:text-tertiary-dark mt-2">学习 React</h3><li><a title="描述 UI" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between ps-5 text-base font-bold text-primary dark:text-primary-dark" href="/learn/describing-the-ui"><div>描述 UI<!-- --> </div><span class="pe-1 text-tertiary dark:text-tertiary-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" class="duration-100 ease-in transition -rotate-90 rtl:rotate-90" style="min-width:20px;min-height:20px"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></span></a><div class="opacity-50" style="transition:opacity 250ms ease-in-out"><div id="react-collapsed-panel-:R9am6:" aria-hidden="true" role="region" style="box-sizing:border-box;display:none;height:0px;overflow:hidden"><ul><li><a title="你的第一个组件" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/your-first-component"><div>你的第一个组件<!-- --> </div></a></li><li><a title="组件的导入与导出" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/importing-and-exporting-components"><div>组件的导入与导出<!-- --> </div></a></li><li><a title="使用 JSX 书写标签语言" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/writing-markup-with-jsx"><div>使用 JSX 书写标签语言<!-- --> </div></a></li><li><a title="在 JSX 中通过大括号使用 JavaScript" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/javascript-in-jsx-with-curly-braces"><div>在 JSX 中通过大括号使用 JavaScript<!-- --> </div></a></li><li><a title="将 Props 传递给组件" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/passing-props-to-a-component"><div>将 Props 传递给组件<!-- --> </div></a></li><li><a title="条件渲染" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/conditional-rendering"><div>条件渲染<!-- --> </div></a></li><li><a title="渲染列表" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/rendering-lists"><div>渲染列表<!-- --> </div></a></li><li><a title="保持组件纯粹" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/keeping-components-pure"><div>保持组件纯粹<!-- --> </div></a></li><li><a title="将 UI 视为树" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/understanding-your-ui-as-a-tree"><div>将 UI 视为树<!-- --> </div></a></li></ul></div></div></li><li><a title="添加交互" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between ps-5 text-base font-bold text-primary dark:text-primary-dark" href="/learn/adding-interactivity"><div>添加交互<!-- --> </div><span class="pe-1 text-link dark:text-link-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" class="duration-100 ease-in transition rotate-0" style="min-width:20px;min-height:20px"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></span></a><div class="opacity-100" style="transition:opacity 250ms ease-in-out"><div id="react-collapsed-panel-:R9im6:" aria-hidden="false" role="region" style="box-sizing:border-box"><ul><li><a title="响应事件" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/responding-to-events"><div>响应事件<!-- --> </div></a></li><li><a title="state：组件的记忆" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/state-a-components-memory"><div>state：组件的记忆<!-- --> </div></a></li><li><a title="渲染和提交" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/render-and-commit"><div>渲染和提交<!-- --> </div></a></li><li><a title="state 如同一张快照" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/state-as-a-snapshot"><div>state 如同一张快照<!-- --> </div></a></li><li><a title="把一系列 state 更新加入队列" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/queueing-a-series-of-state-updates"><div>把一系列 state 更新加入队列<!-- --> </div></a></li><li><a title="更新 state 中的对象" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/updating-objects-in-state"><div>更新 state 中的对象<!-- --> </div></a></li><li><a title="更新 state 中的数组" target="" aria-current="page" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-link dark:text-link-dark bg-highlight dark:bg-highlight-dark border-blue-40 hover:bg-highlight hover:text-link dark:hover:bg-highlight-dark dark:hover:text-link-dark" href="/learn/updating-arrays-in-state"><div>更新 state 中的数组<!-- --> </div></a></li></ul></div></div></li><li><a title="状态管理" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between ps-5 text-base font-bold text-primary dark:text-primary-dark" href="/learn/managing-state"><div>状态管理<!-- --> </div><span class="pe-1 text-tertiary dark:text-tertiary-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" class="duration-100 ease-in transition -rotate-90 rtl:rotate-90" style="min-width:20px;min-height:20px"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></span></a><div class="opacity-50" style="transition:opacity 250ms ease-in-out"><div id="react-collapsed-panel-:R9qm6:" aria-hidden="true" role="region" style="box-sizing:border-box;display:none;height:0px;overflow:hidden"><ul><li><a title="用 State 响应输入" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/reacting-to-input-with-state"><div>用 State 响应输入<!-- --> </div></a></li><li><a title="选择 State 结构" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/choosing-the-state-structure"><div>选择 State 结构<!-- --> </div></a></li><li><a title="在组件间共享状态" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/sharing-state-between-components"><div>在组件间共享状态<!-- --> </div></a></li><li><a title="对 state 进行保留和重置" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/preserving-and-resetting-state"><div>对 state 进行保留和重置<!-- --> </div></a></li><li><a title="迁移状态逻辑至 Reducer 中" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/extracting-state-logic-into-a-reducer"><div>迁移状态逻辑至 Reducer 中<!-- --> </div></a></li><li><a title="使用 Context 深层传递参数" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/passing-data-deeply-with-context"><div>使用 Context 深层传递参数<!-- --> </div></a></li><li><a title="使用 Reducer 和 Context 拓展你的应用" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/scaling-up-with-reducer-and-context"><div>使用 Reducer 和 Context 拓展你的应用<!-- --> </div></a></li></ul></div></div></li><li><a title="脱围机制" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between ps-5 text-base font-bold text-primary dark:text-primary-dark" href="/learn/escape-hatches"><div>脱围机制<!-- --> </div><span class="pe-1 text-tertiary dark:text-tertiary-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" class="duration-100 ease-in transition -rotate-90 rtl:rotate-90" style="min-width:20px;min-height:20px"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></span></a><div class="opacity-50" style="transition:opacity 250ms ease-in-out"><div id="react-collapsed-panel-:Ra2m6:" aria-hidden="true" role="region" style="box-sizing:border-box;display:none;height:0px;overflow:hidden"><ul><li><a title="使用 ref 引用值" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/referencing-values-with-refs"><div>使用 ref 引用值<!-- --> </div></a></li><li><a title="使用 ref 操作 DOM" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/manipulating-the-dom-with-refs"><div>使用 ref 操作 DOM<!-- --> </div></a></li><li><a title="使用 Effect 进行同步" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/synchronizing-with-effects"><div>使用 Effect 进行同步<!-- --> </div></a></li><li><a title="你可能不需要 Effect" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/you-might-not-need-an-effect"><div>你可能不需要 Effect<!-- --> </div></a></li><li><a title="响应式 Effect 的生命周期" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/lifecycle-of-reactive-effects"><div>响应式 Effect 的生命周期<!-- --> </div></a></li><li><a title="将事件从 Effect 中分开" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/separating-events-from-effects"><div>将事件从 Effect 中分开<!-- --> </div></a></li><li><a title="移除 Effect 依赖" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/removing-effect-dependencies"><div>移除 Effect 依赖<!-- --> </div></a></li><li><a title="使用自定义 Hook 复用逻辑" target="" class="p-2 pe-2 w-full rounded-none lg:rounded-e-2xl text-start hover:bg-gray-5 dark:hover:bg-gray-80 relative flex items-center justify-between text-sm ps-6 ps-5 text-base text-secondary dark:text-secondary-dark" href="/learn/reusing-logic-with-custom-hooks"><div>使用自定义 Hook 复用逻辑<!-- --> </div></a></li></ul></div></div></li></ul><!--/$--><div class="h-20"></div></nav><div class="fixed bottom-0 hidden lg:block"><div class="max-w-custom-xs w-80 lg:w-auto py-3 shadow-lg rounded-lg m-4 bg-wash dark:bg-gray-95 px-4 flex"><p class="w-full text-lg font-bold text-primary dark:text-primary-dark me-4">这个页面对你有帮助吗？</p><button aria-label="Yes" class="px-3 rounded-lg bg-secondary-button dark:bg-secondary-button-dark text-primary dark:text-primary-dark me-2"><svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.36603 0.384603C9.36605 0.384617 9.36601 0.384588 9.36603 0.384603L9.45902 0.453415C9.99732 0.851783 10.3873 1.42386 10.5654 2.07648C10.7435 2.72909 10.6993 3.42385 10.44 4.04763L9.27065 6.86008H12.6316C13.5249 6.86008 14.3817 7.22121 15.0134 7.86402C15.6451 8.50683 16 9.37868 16 10.2877V13.7154C16 14.8518 15.5564 15.9416 14.7668 16.7451C13.9771 17.5486 12.9062 18 11.7895 18H5.05263C3.71259 18 2.42743 17.4583 1.47988 16.4941C0.532325 15.5299 0 14.2221 0 12.8585V11.2511C2.40928e-06 9.87711 0.463526 8.54479 1.31308 7.47688L6.66804 0.745592C6.98662 0.345136 7.44414 0.08434 7.94623 0.0171605C8.4483 -0.0500155 8.95656 0.0815891 9.36603 0.384603ZM8.37542 1.77064C8.31492 1.72587 8.23987 1.70646 8.16579 1.71637C8.09171 1.72628 8.02415 1.76477 7.97708 1.82393L2.62213 8.55522C2.0153 9.31801 1.68421 10.2697 1.68421 11.2511V12.8585C1.68421 13.7676 2.03909 14.6394 2.67079 15.2822C3.30249 15.925 4.15927 16.2862 5.05263 16.2862H11.7895C12.4595 16.2862 13.1021 16.0153 13.5759 15.5332C14.0496 15.0511 14.3158 14.3972 14.3158 13.7154V10.2877C14.3158 9.83321 14.1383 9.39729 13.8225 9.07588C13.5066 8.75448 13.0783 8.57392 12.6316 8.57392H8C7.71763 8.57392 7.45405 8.4299 7.29806 8.19039C7.14206 7.95087 7.11442 7.64774 7.22445 7.38311L8.88886 3.37986C9 3.11253 9.01896 2.81477 8.94262 2.53507C8.8663 2.25541 8.69921 2.01027 8.46853 1.83954L8.37542 1.77064Z" fill="currentColor"></path></svg></button><button aria-label="No" class="px-3 rounded-lg bg-secondary-button dark:bg-secondary-button-dark text-primary dark:text-primary-dark"><svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.63397 17.6154C6.63395 17.6154 6.63399 17.6154 6.63397 17.6154L6.54098 17.5466C6.00268 17.1482 5.61269 16.5761 5.43458 15.9235C5.25648 15.2709 5.30069 14.5761 5.56004 13.9524L6.72935 11.1399L3.36842 11.1399C2.47506 11.1399 1.61829 10.7788 0.986585 10.136C0.354883 9.49316 8.1991e-07 8.62132 8.99384e-07 7.71225L1.19904e-06 4.28458C1.29838e-06 3.14824 0.443605 2.05844 1.23323 1.25492C2.02286 0.451403 3.09383 -1.12829e-06 4.21053 -1.03067e-06L10.9474 -4.41715e-07C12.2874 -3.24565e-07 13.5726 0.541687 14.5201 1.50591C15.4677 2.47013 16 3.77789 16 5.1415L16 6.74893C16 8.12289 15.5365 9.45521 14.6869 10.5231L9.33196 17.2544C9.01338 17.6549 8.55586 17.9157 8.05377 17.9828C7.5517 18.05 7.04344 17.9184 6.63397 17.6154ZM7.62458 16.2294C7.68508 16.2741 7.76013 16.2935 7.83421 16.2836C7.90829 16.2737 7.97585 16.2352 8.02292 16.1761L13.3779 9.44478C13.9847 8.68199 14.3158 7.73033 14.3158 6.74892L14.3158 5.1415C14.3158 4.23242 13.9609 3.36058 13.3292 2.71777C12.6975 2.07496 11.8407 1.71383 10.9474 1.71383L4.21053 1.71383C3.5405 1.71383 2.89793 1.98468 2.42415 2.46679C1.95038 2.94889 1.68421 3.60277 1.68421 4.28458L1.68421 7.71225C1.68421 8.16679 1.86166 8.60271 2.1775 8.92411C2.49335 9.24552 2.92174 9.42608 3.36842 9.42608L8 9.42608C8.28237 9.42608 8.54595 9.5701 8.70195 9.80961C8.85794 10.0491 8.88558 10.3523 8.77555 10.6169L7.11114 14.6201C7 14.8875 6.98105 15.1852 7.05738 15.4649C7.1337 15.7446 7.30079 15.9897 7.53147 16.1605L7.62458 16.2294Z" fill="currentColor"></path></svg></button></div></div></aside></div></div></div></div><!--$--><main class="min-w-0 isolate"><article class="font-normal break-words text-primary dark:text-primary-dark"><div class="ps-0"><div class=""><div class="px-5 sm:px-12 pt-3.5"><div class="max-w-4xl ms-0 2xl:mx-auto"><div class="flex flex-wrap"><div class="flex mb-3 mt-0.5 items-center"><a class="text-link dark:text-link-dark text-sm tracking-wide font-bold uppercase me-1 hover:underline" href="/learn">学习 React</a><span class="inline-block me-1 text-link dark:text-link-dark text-lg rtl:rotate-180"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.86612 13.6161C6.37796 14.1043 6.37796 14.8957 6.86612 15.3839C7.35427 15.872 8.14572 15.872 8.63388 15.3839L13.1339 10.8839C13.622 10.3957 13.622 9.60428 13.1339 9.11612L8.63388 4.61612C8.14572 4.12797 7.35427 4.12797 6.86612 4.61612C6.37796 5.10428 6.37796 5.89573 6.86612 6.38388L10.4822 10L6.86612 13.6161Z" fill="currentColor"></path></svg></span></div><div class="flex mb-3 mt-0.5 items-center"><a class="text-link dark:text-link-dark text-sm tracking-wide font-bold uppercase me-1 hover:underline" href="/learn/adding-interactivity">添加交互</a><span class="inline-block me-1 text-link dark:text-link-dark text-lg rtl:rotate-180"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.86612 13.6161C6.37796 14.1043 6.37796 14.8957 6.86612 15.3839C7.35427 15.872 8.14572 15.872 8.63388 15.3839L13.1339 10.8839C13.622 10.3957 13.622 9.60428 13.1339 9.11612L8.63388 4.61612C8.14572 4.12797 7.35427 4.12797 6.86612 4.61612C6.37796 5.10428 6.37796 5.89573 6.86612 6.38388L10.4822 10L6.86612 13.6161Z" fill="currentColor"></path></svg></span></div></div><h1 class="mdx-heading mt-0 text-primary dark:text-primary-dark -mx-.5 break-words text-5xl font-display font-bold leading-tight">更新 state 中的数组<a href="#undefined" aria-label="Link for this heading" title="Link for this heading" class="mdx-header-anchor hidden"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h1></div></div></div><div class="px-5 sm:px-12"><div class="max-w-7xl mx-auto"><div class="max-w-4xl ms-0 2xl:mx-auto"><div class="font-display text-xl text-primary dark:text-primary-dark leading-relaxed"><p class="whitespace-pre-wrap my-4">数组是另外一种可以存储在 state 中的 JavaScript 对象，它虽然是可变的，但是却应该被视为不可变。同对象一样，当你想要更新存储于 state 中的数组时，你需要创建一个新的数组（或者创建一份已有数组的拷贝值），并使用新数组设置 state。</p></div>
<div class="p-6 xl:p-8 pb-4 xl:pb-6 bg-card dark:bg-card-dark rounded-2xl shadow-inner-border dark:shadow-inner-border-dark text-base text-secondary dark:text-secondary-dark my-8"><h3 class="mdx-heading text-primary dark:text-primary-dark mt-0 mb-3 leading-tight text-2xl font-display leading-9 text-primary dark:text-primary-dark font-bold my-6">你将会学习到</h3><ul class="ms-6 my-3 list-disc">
<li class="leading-relaxed mb-1">如何添加、删除或者修改 React state 中的数组中的元素</li>
<li class="leading-relaxed mb-1">如何更新数组内部的对象</li>
<li class="leading-relaxed mb-1">如何通过 Immer 降低数组拷贝的重复度</li>
</ul></div>
<h2 id="updating-arrays-without-mutation" class="mdx-heading text-3xl font-display leading-10 text-primary dark:text-primary-dark font-bold my-6">在没有 mutation 的前提下更新数组 <a href="#updating-arrays-without-mutation" aria-label="Link for 在没有 mutation 的前提下更新数组 " title="Link for 在没有 mutation 的前提下更新数组 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h2>
<p class="whitespace-pre-wrap my-4">在 JavaScript 中，数组只是另一种对象。<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="/learn/updating-objects-in-state">同对象一样</a>，<strong class="font-bold">你需要将 React state 中的数组视为只读的</strong>。这意味着你不应该使用类似于 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">arr[0] = &#x27;bird&#x27;</code> 这样的方式来重新分配数组中的元素，也不应该使用会直接修改原始数组的方法，例如 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">push()</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">pop()</code>。</p>
<p class="whitespace-pre-wrap my-4">相反，每次要更新一个数组时，你需要把一个<strong class="font-bold">新</strong>的数组传入 state 的 setting 方法中。为此，你可以通过使用像 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">filter()</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map()</code> 这样不会直接修改原始值的方法，从原始数组生成一个新的数组。然后你就可以将 state 设置为这个新生成的数组。</p>
<p class="whitespace-pre-wrap my-4">下面是常见数组操作的参考表。当你操作 React state 中的数组时，你需要避免使用左列的方法，而首选右列的方法：</p>
<table><thead><tr><th></th><th>避免使用 (会改变原始数组)</th><th>推荐使用 (会返回一个新数组）</th></tr></thead><tbody><tr><td>添加元素</td><td><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">push</code>，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">unshift</code></td><td><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">concat</code>，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">[...arr]</code> 展开语法（<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="#adding-to-an-array">例子</a>）</td></tr><tr><td>删除元素</td><td><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">pop</code>，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">shift</code>，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">splice</code></td><td><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">filter</code>，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">slice</code>（<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="#removing-from-an-array">例子</a>）</td></tr><tr><td>替换元素</td><td><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">splice</code>，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">arr[i] = ...</code> 赋值</td><td><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map</code>（<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="#replacing-items-in-an-array">例子</a>）</td></tr><tr><td>排序</td><td><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">reverse</code>，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">sort</code></td><td>先将数组复制一份（<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="#making-other-changes-to-an-array">例子</a>）</td></tr></tbody></table>
<p class="whitespace-pre-wrap my-4">或者，你可以<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="#write-concise-update-logic-with-immer">使用 Immer</a> ，这样你便可以使用表格中的所有方法了。</p>
<div class="expandable-callout pt-8 pb-4 px-5 sm:px-8 my-8 relative rounded-none shadow-inner-border -mx-5 sm:mx-auto sm:rounded-2xl bg-yellow-5 dark:bg-yellow-60 dark:bg-opacity-20"><h3 class="text-2xl font-display font-bold text-yellow-50 dark:text-yellow-40"><svg class="inline me-3 mb-1 text-lg text-yellow-50 dark:text-yellow-40" width="2em" height="2em" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_738_836)"><path fill-rule="evenodd" clip-rule="evenodd" d="M27 48L27 57.3409L40.0772 48L55.6975 48C57.1595 48 58.1986 47.0112 58.3851 45.8604C59.1824 40.9398 60 34.619 60 29.625C60 24.7282 59.2125 18.7546 58.4302 14.0813C58.2445 12.9721 57.2326 12 55.7805 12L16.2195 12C14.7674 12 13.7555 12.9721 13.5698 14.0813C12.7875 18.7546 12 24.7282 12 29.625C12 34.619 12.8176 40.9398 13.6149 45.8604C13.8014 47.0112 14.8404 48 16.3025 48H27ZM42 54H55.6975C59.9534 54 63.6271 51.0213 64.3078 46.8201C65.1161 41.8322 66 35.1209 66 29.625C66 24.2196 65.1449 17.8522 64.3478 13.0906C63.6513 8.93026 59.9987 6 55.7805 6H16.2195C12.0013 6 8.34867 8.93026 7.65218 13.0906C6.85505 17.8522 6 24.2196 6 29.625C6 35.1209 6.88391 41.8322 7.69215 46.8201C8.37291 51.0213 12.0466 54 16.3025 54H21L21 63.1704C21 65.6106 23.7581 67.0299 25.7437 65.6116L42 54ZM39 39.3686C39 40.9422 38 41.9912 36 41.9912C34 41.9912 33 40.9422 33 39.3686C33 37.7951 34 36.746 36 36.746C38 36.746 39 37.7951 39 39.3686ZM38.1771 20.2412C38.1771 18.9986 37.1697 17.9912 35.9271 17.9912C34.6845 17.9912 33.6771 18.9986 33.6771 20.2412V31.5956C33.6771 32.8382 34.6845 33.8456 35.9271 33.8456C37.1697 33.8456 38.1771 32.8382 38.1771 31.5956V20.2412Z" fill="currentColor"></path></g><defs><clipPath id="clip0_738_836"><rect width="72" height="72" fill="white"></rect></clipPath></defs></svg>陷阱</h3><div class="relative"><div class="py-2"><p class="whitespace-pre-wrap my-4">不幸的是，虽然 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/slice" target="_blank" rel="nofollow noopener noreferrer" class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal"><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">slice</code></a> 和 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/splice" target="_blank" rel="nofollow noopener noreferrer" class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal"><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">splice</code></a> 的名字相似，但作用却迥然不同：</p><ul class="ms-6 my-3 list-disc">
<li class="leading-relaxed mb-1"><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">slice</code> 让你可以拷贝数组或是数组的一部分。</li>
<li class="leading-relaxed mb-1"><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">splice</code> <strong class="font-bold">会直接修改</strong> 原始数组（插入或者删除元素）。</li>
</ul><p class="whitespace-pre-wrap my-4">在 React 中，更多情况下你会使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">slice</code>（没有 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">p</code> ！），因为你不想改变 state 中的对象或数组。<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="/learn/updating-objects-in-state">更新对象</a>这一章节解释了什么是 mutation，以及为什么不推荐在 state 里这样做。</p></div></div></div>
<h3 id="adding-to-an-array" class="mdx-heading text-2xl font-display leading-9 text-primary dark:text-primary-dark font-bold my-6">向数组中添加元素 <a href="#adding-to-an-array" aria-label="Link for 向数组中添加元素 " title="Link for 向数组中添加元素 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h3>
<p class="whitespace-pre-wrap my-4"><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">push()</code> 会直接修改原始数组，而你不希望这样：</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj52cq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">let</span> <span class="sp-syntax-plain">nextId</span> = <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">List</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">name</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setName</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-string">&#x27;&#x27;</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">artists</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setArtists</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">[</span><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>振奋人心的雕塑家们：<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">input</span>
        <span class="sp-syntax-property">value</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">name</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onChange</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">e</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-definition">setName</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">e</span>.<span class="sp-syntax-property">target</span>.<span class="sp-syntax-property">value</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">/&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">push</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">{</span>
          <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">nextId</span>++<span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">name</span><span class="sp-syntax-punctuation">,</span>
        <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>添加<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artist</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span><span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<p class="whitespace-pre-wrap my-4">相反，你应该创建一个 <strong class="font-bold">新</strong> 数组，其包含了原始数组的所有元素 <strong class="font-bold">以及</strong> 一个在末尾的新元素。这可以通过很多种方法实现，最简单的一种就是使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">...</code> <a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="/a-javascript-refresher#array-spread">数组展开</a> 语法：</p>
<!--$--><div dir="ltr" class="sandpack sandpack--codeblock rounded-2xl h-full w-full overflow-x-auto flex items-center bg-wash dark:bg-gray-95 shadow-lg my-8" style="contain:content"><div class="sp-wrapper"><div class="sp-stack"><div class="sp-code-editor"><pre class="sp-cm sp-pristine sp-javascript flex align-start"><code class="sp-pre-placeholder grow-[2]"><div class="cm-line "><span class="sp-syntax-definition">setArtists</span><span class="sp-syntax-punctuation">(</span> <span class="sp-syntax-comment">// 替换 state</span><br/></div><div class="cm-line ">  <span class="sp-syntax-punctuation">[</span> <span class="sp-syntax-comment">// 是通过传入一个新数组实现的</span><br/></div><div class="cm-line ">    <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">artists</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-comment">// 新数组包含原数组的所有元素</span><br/></div><div class="cm-line ">    <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">nextId</span>++<span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">name</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-comment">// 并在末尾添加了一个新的元素</span><br/></div><div class="cm-line ">  <span class="sp-syntax-punctuation">]</span><br/></div><div class="cm-line "><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span></div></code></pre></div></div></div></div><!--/$-->
<p class="whitespace-pre-wrap my-4">现在代码可以正常运行了：</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj54cq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">let</span> <span class="sp-syntax-plain">nextId</span> = <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">List</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">name</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setName</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-string">&#x27;&#x27;</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">artists</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setArtists</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">[</span><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>振奋人心的雕塑家们：<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">input</span>
        <span class="sp-syntax-property">value</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">name</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onChange</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">e</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-definition">setName</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">e</span>.<span class="sp-syntax-property">target</span>.<span class="sp-syntax-property">value</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">/&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-definition">setArtists</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">[</span>
          <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">artists</span><span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">nextId</span>++<span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">name</span> <span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>添加<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artist</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span><span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<p class="whitespace-pre-wrap my-4">数组展开运算符还允许你把新添加的元素放在原始的 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">...artists</code> 之前：</p>
<!--$--><div dir="ltr" class="sandpack sandpack--codeblock rounded-2xl h-full w-full overflow-x-auto flex items-center bg-wash dark:bg-gray-95 shadow-lg my-8" style="contain:content"><div class="sp-wrapper"><div class="sp-stack"><div class="sp-code-editor"><pre class="sp-cm sp-pristine sp-javascript flex align-start"><code class="sp-pre-placeholder grow-[2]"><div class="cm-line "><span class="sp-syntax-definition">setArtists</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">[</span><br/></div><div class="cm-line ">  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">nextId</span>++<span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">name</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span><br/></div><div class="cm-line ">  <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">artists</span> <span class="sp-syntax-comment">// 将原数组中的元素放在末尾</span><br/></div><div class="cm-line "><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span></div></code></pre></div></div></div></div><!--/$-->
<p class="whitespace-pre-wrap my-4">这样一来，展开操作就可以完成 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">push()</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">unshift()</code> 的工作，将新元素添加到数组的末尾和开头。你可以在上面的 sandbox 中尝试一下！</p>
<h3 id="removing-from-an-array" class="mdx-heading text-2xl font-display leading-9 text-primary dark:text-primary-dark font-bold my-6">从数组中删除元素 <a href="#removing-from-an-array" aria-label="Link for 从数组中删除元素 " title="Link for 从数组中删除元素 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h3>
<p class="whitespace-pre-wrap my-4">从数组中删除一个元素最简单的方法就是将它<strong class="font-bold">过滤出去</strong>。换句话说，你需要生成一个不包含该元素的新数组。这可以通过 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">filter</code> 方法实现，例如：</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj56cq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">let</span> <span class="sp-syntax-plain">initialArtists</span> = <span class="sp-syntax-punctuation">[</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Marta Colvin Andrade&#x27;</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Lamidi Olonade Fakeye&#x27;</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">2</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Louise Nevelson&#x27;</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">List</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">artists</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setArtists</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-plain">initialArtists</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>振奋人心的雕塑家们：<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artist</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
            <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">{</span><span class="sp-syntax-string">&#x27; &#x27;</span><span class="sp-syntax-punctuation">}</span>
            <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
              <span class="sp-syntax-definition">setArtists</span><span class="sp-syntax-punctuation">(</span>
                <span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">filter</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">a</span> <span class="sp-syntax-punctuation">=&gt;</span>
                  <span class="sp-syntax-plain">a</span>.<span class="sp-syntax-property">id</span> !== <span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">id</span>
                <span class="sp-syntax-punctuation">)</span>
              <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
            <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
              删除
            <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
          <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<p class="whitespace-pre-wrap my-4">点击“删除”按钮几次，并且查看按钮处理点击事件的代码。</p>
<!--$--><div dir="ltr" class="sandpack sandpack--codeblock rounded-2xl h-full w-full overflow-x-auto flex items-center bg-wash dark:bg-gray-95 shadow-lg my-8" style="contain:content"><div class="sp-wrapper"><div class="sp-stack"><div class="sp-code-editor"><pre class="sp-cm sp-pristine sp-javascript flex align-start"><code class="sp-pre-placeholder grow-[2]"><div class="cm-line "><span class="sp-syntax-definition">setArtists</span><span class="sp-syntax-punctuation">(</span><br/></div><div class="cm-line ">  <span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">filter</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">a</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-plain">a</span>.<span class="sp-syntax-property">id</span> !== <span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">)</span><br/></div><div class="cm-line "><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span></div></code></pre></div></div></div></div><!--/$-->
<p class="whitespace-pre-wrap my-4">这里，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">artists.filter(s =&gt; s.id !== artist.id)</code> 表示“创建一个新的数组，该数组由那些 ID 与 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">artists.id</code> 不同的 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">artists</code> 组成”。换句话说，每个 artist 的“删除”按钮会把 <em>那一个</em> artist 从原始数组中过滤掉，并使用过滤后的数组再次进行渲染。注意，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">filter</code> 并不会改变原始数组。</p>
<h3 id="transforming-an-array" class="mdx-heading text-2xl font-display leading-9 text-primary dark:text-primary-dark font-bold my-6">转换数组 <a href="#transforming-an-array" aria-label="Link for 转换数组 " title="Link for 转换数组 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h3>
<p class="whitespace-pre-wrap my-4">如果你想改变数组中的某些或全部元素，你可以用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map()</code> 创建一个<strong class="font-bold">新</strong>数组。你传入 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map</code> 的函数决定了要根据每个元素的值或索引（或二者都要）对元素做何处理。</p>
<p class="whitespace-pre-wrap my-4">在下面的例子中，一个数组记录了两个圆形和一个正方形的坐标。当你点击按钮时，仅有两个圆形会向下移动 100 像素。这是通过使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map()</code> 生成一个新数组实现的。</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj58cq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">let</span> <span class="sp-syntax-plain">initialShapes</span> = <span class="sp-syntax-punctuation">[</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">type</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;circle&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">x</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">50</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">y</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">100</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">type</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;square&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">x</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">150</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">y</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">100</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">2</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">type</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;circle&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">x</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">250</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">y</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">100</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">ShapeEditor</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">shapes</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setShapes</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-plain">initialShapes</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleClick</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">nextShapes</span> = <span class="sp-syntax-plain">shapes</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">shape</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
      <span class="sp-syntax-keyword">if</span> <span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">shape</span>.<span class="sp-syntax-property">type</span> === <span class="sp-syntax-string">&#x27;square&#x27;</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-comment">// 不作改变</span>
        <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-plain">shape</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">else</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-comment">// 返回一个新的圆形，位置在下方 50px 处</span>
        <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">{</span>
          <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">shape</span><span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-property">y</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">shape</span>.<span class="sp-syntax-property">y</span> + <span class="sp-syntax-static">50</span><span class="sp-syntax-punctuation">,</span>
        <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-comment">// 使用新的数组进行重渲染</span>
    <span class="sp-syntax-definition">setShapes</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">nextShapes</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">handleClick</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
        所有圆形向下移动！
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">shapes</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">shape</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">div</span>
          <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">shape</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span>
          <span class="sp-syntax-property">style</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">{</span>
          <span class="sp-syntax-property">background</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;purple&#x27;</span><span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-property">position</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;absolute&#x27;</span><span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-property">left</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">shape</span>.<span class="sp-syntax-property">x</span><span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-property">top</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">shape</span>.<span class="sp-syntax-property">y</span><span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-property">borderRadius</span><span class="sp-syntax-punctuation">:</span>
            <span class="sp-syntax-plain">shape</span>.<span class="sp-syntax-property">type</span> === <span class="sp-syntax-string">&#x27;circle&#x27;</span>
              ? <span class="sp-syntax-string">&#x27;50%&#x27;</span> : <span class="sp-syntax-string">&#x27;&#x27;</span><span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-property">width</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">20</span><span class="sp-syntax-punctuation">,</span>
          <span class="sp-syntax-property">height</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">20</span><span class="sp-syntax-punctuation">,</span>
        <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-punctuation">/&gt;</span>
      <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<h3 id="replacing-items-in-an-array" class="mdx-heading text-2xl font-display leading-9 text-primary dark:text-primary-dark font-bold my-6">替换数组中的元素 <a href="#replacing-items-in-an-array" aria-label="Link for 替换数组中的元素 " title="Link for 替换数组中的元素 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h3>
<p class="whitespace-pre-wrap my-4">想要替换数组中一个或多个元素是非常常见的。类似 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">arr[0] = &#x27;bird&#x27;</code> 这样的赋值语句会直接修改原始数组，所以在这种情况下，你也应该使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map</code>。</p>
<p class="whitespace-pre-wrap my-4">要替换一个元素，请使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map</code> 创建一个新数组。在你的 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map</code> 回调里，第二个参数是元素的索引。使用索引来判断最终是返回原始的元素（即回调的第一个参数）还是替换成其他值：</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj5acq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">let</span> <span class="sp-syntax-plain">initialCounters</span> = <span class="sp-syntax-punctuation">[</span>
  <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-static">0</span>
<span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">CounterList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">counters</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setCounters</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-plain">initialCounters</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleIncrementClick</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">index</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">nextCounters</span> = <span class="sp-syntax-plain">counters</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">c</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">i</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
      <span class="sp-syntax-keyword">if</span> <span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">i</span> === <span class="sp-syntax-plain">index</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-comment">// 递增被点击的计数器数值</span>
        <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-plain">c</span> + <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">else</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-comment">// 其余部分不发生变化</span>
        <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-plain">c</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-definition">setCounters</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">nextCounters</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">counters</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">counter</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">i</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">i</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
          <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">counter</span><span class="sp-syntax-punctuation">}</span>
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
            <span class="sp-syntax-definition">handleIncrementClick</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">i</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
          <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>+1<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<h3 id="inserting-into-an-array" class="mdx-heading text-2xl font-display leading-9 text-primary dark:text-primary-dark font-bold my-6">向数组中插入元素 <a href="#inserting-into-an-array" aria-label="Link for 向数组中插入元素 " title="Link for 向数组中插入元素 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h3>
<p class="whitespace-pre-wrap my-4">有时，你也许想向数组特定位置插入一个元素，这个位置既不在数组开头，也不在末尾。为此，你可以将数组展开运算符 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">...</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">slice()</code> 方法一起使用。<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">slice()</code> 方法让你从数组中切出“一片”。为了将元素插入数组，你需要先展开原数组在插入点之前的切片，然后插入新元素，最后展开原数组中剩下的部分。</p>
<p class="whitespace-pre-wrap my-4">下面的例子中，插入按钮总是会将元素插入到数组中索引为 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">1</code> 的位置。</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj5ccq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">let</span> <span class="sp-syntax-plain">nextId</span> = <span class="sp-syntax-static">3</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">initialArtists</span> = <span class="sp-syntax-punctuation">[</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Marta Colvin Andrade&#x27;</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Lamidi Olonade Fakeye&#x27;</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">2</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Louise Nevelson&#x27;</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">List</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">name</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setName</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-string">&#x27;&#x27;</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">artists</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setArtists</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-plain">initialArtists</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleClick</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">insertAt</span> = <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">;</span> <span class="sp-syntax-comment">// 可能是任何索引</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">nextArtists</span> = <span class="sp-syntax-punctuation">[</span>
      <span class="sp-syntax-comment">// 插入点之前的元素：</span>
      <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">slice</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">insertAt</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">,</span>
      <span class="sp-syntax-comment">// 新的元素：</span>
      <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">nextId</span>++<span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">name</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
      <span class="sp-syntax-comment">// 插入点之后的元素：</span>
      <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">slice</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">insertAt</span><span class="sp-syntax-punctuation">)</span>
    <span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-definition">setArtists</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">nextArtists</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-definition">setName</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-string">&#x27;&#x27;</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>振奋人心的雕塑家们：<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">input</span>
        <span class="sp-syntax-property">value</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">name</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onChange</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">e</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-definition">setName</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">e</span>.<span class="sp-syntax-property">target</span>.<span class="sp-syntax-property">value</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">/&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">handleClick</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
        插入
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artists</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artist</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span><span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artist</span>.<span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<h3 id="making-other-changes-to-an-array" class="mdx-heading text-2xl font-display leading-9 text-primary dark:text-primary-dark font-bold my-6">其他改变数组的情况 <a href="#making-other-changes-to-an-array" aria-label="Link for 其他改变数组的情况 " title="Link for 其他改变数组的情况 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h3>
<p class="whitespace-pre-wrap my-4">总会有一些事，是你仅仅依靠展开运算符和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map()</code> 或者 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">filter()</code> 等不会直接修改原值的方法所无法做到的。例如，你可能想翻转数组，或是对数组排序。而 JavaScript 中的 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">reverse()</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">sort()</code> 方法会改变原数组，所以你无法直接使用它们。</p>
<p class="whitespace-pre-wrap my-4"><strong class="font-bold">然而，你可以先拷贝这个数组，再改变这个拷贝后的值。</strong></p>
<p class="whitespace-pre-wrap my-4">例如：</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj5ecq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">initialList</span> = <span class="sp-syntax-punctuation">[</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Big Bellies&#x27;</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Lunar Landscape&#x27;</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">2</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Terracotta Army&#x27;</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">List</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">list</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setList</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">initialList</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleClick</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">nextList</span> = <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">list</span><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-plain">nextList</span>.<span class="sp-syntax-property">reverse</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-definition">setList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">nextList</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">handleClick</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
        翻转
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">list</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span><span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
      <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<p class="whitespace-pre-wrap my-4">在这段代码中，你先使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">[...list]</code> 展开运算符创建了一份数组的拷贝值。当你有了这个拷贝值后，你就可以使用像 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">nextList.reverse()</code> 或 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">nextList.sort()</code> 这样直接修改原数组的方法。你甚至可以通过 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">nextList[0] = &quot;something&quot;</code> 这样的方式对数组中的特定元素进行赋值。</p>
<p class="whitespace-pre-wrap my-4">然而，<strong class="font-bold">即使你拷贝了数组，你还是不能直接修改其内部的元素</strong>。这是因为数组的拷贝是浅拷贝——新的数组中依然保留了与原始数组相同的元素。因此，如果你修改了拷贝数组内部的某个对象，其实你正在直接修改当前的 state。举个例子，像下面的代码就会带来问题。</p>
<!--$--><div dir="ltr" class="sandpack sandpack--codeblock rounded-2xl h-full w-full overflow-x-auto flex items-center bg-wash dark:bg-gray-95 shadow-lg my-8" style="contain:content"><div class="sp-wrapper"><div class="sp-stack"><div class="sp-code-editor"><pre class="sp-cm sp-pristine sp-javascript flex align-start"><code class="sp-pre-placeholder grow-[2]"><div class="cm-line "><span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">nextList</span> = <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">list</span><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span><br/></div><div class="cm-line "><span class="sp-syntax-plain">nextList</span><span class="sp-syntax-punctuation">[</span><span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">]</span>.<span class="sp-syntax-property">seen</span> = <span class="sp-syntax-static">true</span><span class="sp-syntax-punctuation">;</span> <span class="sp-syntax-comment">// 问题：直接修改了 list[0] 的值</span><br/></div><div class="cm-line "><span class="sp-syntax-definition">setList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">nextList</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span></div></code></pre></div></div></div></div><!--/$-->
<p class="whitespace-pre-wrap my-4">虽然 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">nextList</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">list</code> 是两个不同的数组，<strong class="font-bold"><code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">nextList[0]</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">list[0]</code> 却指向了同一个对象</strong>。因此，通过改变 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">nextList[0].seen</code>，<code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">list[0].seen</code> 的值也被改变了。这是一种 state 的 mutation 操作，你应该避免这么做！你可以用类似于 <a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="/learn/updating-objects-in-state#updating-a-nested-object">更新嵌套的 JavaScript 对象</a> 的方式解决这个问题——拷贝想要修改的特定元素，而不是直接修改它。下面是具体的操作。</p>
<h2 id="updating-objects-inside-arrays" class="mdx-heading text-3xl font-display leading-10 text-primary dark:text-primary-dark font-bold my-6">更新数组内部的对象 <a href="#updating-objects-inside-arrays" aria-label="Link for 更新数组内部的对象 " title="Link for 更新数组内部的对象 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h2>
<p class="whitespace-pre-wrap my-4">对象并不是 <em>真的</em> 位于数组“内部”。可能他们在代码中看起来像是在数组“内部”，但其实数组中的每个对象都是这个数组“指向”的一个存储于其它位置的值。这就是当你在处理类似 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">list[0]</code> 这样的嵌套字段时需要格外小心的原因。其他人的艺术品清单可能指向了数组的同一个元素！</p>
<p class="whitespace-pre-wrap my-4"><strong class="font-bold">当你更新一个嵌套的 state 时，你需要从想要更新的地方创建拷贝值，一直这样，直到顶层。</strong> 让我们看一下这该怎么做。</p>
<p class="whitespace-pre-wrap my-4">在下面的例子中，两个不同的艺术品清单有着相同的初始 state。他们本应该互不影响，但是因为一次 mutation，他们的 state 被意外地共享了，勾选一个清单中的事项会影响另外一个清单：</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj5gcq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">let</span> <span class="sp-syntax-plain">nextId</span> = <span class="sp-syntax-static">3</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">initialList</span> = <span class="sp-syntax-punctuation">[</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Big Bellies&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">false</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Lunar Landscape&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">false</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">2</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Terracotta Army&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">true</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">BucketList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">myList</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setMyList</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">initialList</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">yourList</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setYourList</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-plain">initialList</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleToggleMyList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">nextSeen</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">myNextList</span> = <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">myList</span><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">artwork</span> = <span class="sp-syntax-plain">myNextList</span>.<span class="sp-syntax-property">find</span><span class="sp-syntax-punctuation">(</span>
      <span class="sp-syntax-plain">a</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-plain">a</span>.<span class="sp-syntax-property">id</span> === <span class="sp-syntax-plain">artworkId</span>
    <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">seen</span> = <span class="sp-syntax-plain">nextSeen</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-definition">setMyList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">myNextList</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleToggleYourList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">nextSeen</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">yourNextList</span> = <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">yourList</span><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">artwork</span> = <span class="sp-syntax-plain">yourNextList</span>.<span class="sp-syntax-property">find</span><span class="sp-syntax-punctuation">(</span>
      <span class="sp-syntax-plain">a</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-plain">a</span>.<span class="sp-syntax-property">id</span> === <span class="sp-syntax-plain">artworkId</span>
    <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">seen</span> = <span class="sp-syntax-plain">nextSeen</span><span class="sp-syntax-punctuation">;</span>
    <span class="sp-syntax-definition">setYourList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">yourNextList</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>艺术愿望清单<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h2</span><span class="sp-syntax-punctuation">&gt;</span>我想看的艺术清单：<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h2</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-definition">ItemList</span>
        <span class="sp-syntax-property">artworks</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">myList</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onToggle</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">handleToggleMyList</span><span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-punctuation">/&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h2</span><span class="sp-syntax-punctuation">&gt;</span>你想看的艺术清单：<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h2</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-definition">ItemList</span>
        <span class="sp-syntax-property">artworks</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">yourList</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onToggle</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">handleToggleYourList</span><span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-punctuation">/&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

<span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">ItemList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">artworks</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">onToggle</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artworks</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">label</span><span class="sp-syntax-punctuation">&gt;</span>
            <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">input</span>
              <span class="sp-syntax-property">type</span>=<span class="sp-syntax-string">&quot;checkbox&quot;</span>
              <span class="sp-syntax-property">checked</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">}</span>
              <span class="sp-syntax-property">onChange</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">e</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
                <span class="sp-syntax-definition">onToggle</span><span class="sp-syntax-punctuation">(</span>
                  <span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">,</span>
                  <span class="sp-syntax-plain">e</span>.<span class="sp-syntax-property">target</span>.<span class="sp-syntax-property">checked</span>
                <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
              <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span>
            <span class="sp-syntax-punctuation">/&gt;</span>
            <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">}</span>
          <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">label</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<p class="whitespace-pre-wrap my-4">问题出在下面这段代码中:</p>
<!--$--><div dir="ltr" class="sandpack sandpack--codeblock rounded-2xl h-full w-full overflow-x-auto flex items-center bg-wash dark:bg-gray-95 shadow-lg my-8" style="contain:content"><div class="sp-wrapper"><div class="sp-stack"><div class="sp-code-editor"><pre class="sp-cm sp-pristine sp-javascript flex align-start"><code class="sp-pre-placeholder grow-[2]"><div class="cm-line "><span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">myNextList</span> = <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">myList</span><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span><br/></div><div class="cm-line "><span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">artwork</span> = <span class="sp-syntax-plain">myNextList</span>.<span class="sp-syntax-property">find</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">a</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-plain">a</span>.<span class="sp-syntax-property">id</span> === <span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span><br/></div><div class="cm-line "><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">seen</span> = <span class="sp-syntax-plain">nextSeen</span><span class="sp-syntax-punctuation">;</span> <span class="sp-syntax-comment">// 问题：直接修改了已有的元素</span><br/></div><div class="cm-line "><span class="sp-syntax-definition">setMyList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">myNextList</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span></div></code></pre></div></div></div></div><!--/$-->
<p class="whitespace-pre-wrap my-4">虽然 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">myNextList</code> 这个数组是新的，但是其<strong class="font-bold">内部的元素本身</strong>与原数组 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">myList</code> 是相同的。因此，修改 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">artwork.seen</code>，其实是在修改<strong class="font-bold">原始的</strong> artwork 对象。而这个 artwork 对象也被 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">yourList</code> 使用，这样就带来了 bug。这样的 bug 可能难以想到，但好在如果你避免直接修改 state，它们就会消失。</p>
<p class="whitespace-pre-wrap my-4"><strong class="font-bold">你可以使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map</code> 在没有 mutation 的前提下将一个旧的元素替换成更新的版本。</strong></p>
<!--$--><div dir="ltr" class="sandpack sandpack--codeblock rounded-2xl h-full w-full overflow-x-auto flex items-center bg-wash dark:bg-gray-95 shadow-lg my-8" style="contain:content"><div class="sp-wrapper"><div class="sp-stack"><div class="sp-code-editor"><pre class="sp-cm sp-pristine sp-javascript flex align-start"><code class="sp-pre-placeholder grow-[2]"><div class="cm-line "><span class="sp-syntax-definition">setMyList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">myList</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span><br/></div><div class="cm-line ">  <span class="sp-syntax-keyword">if</span> <span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">id</span> === <span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span><br/></div><div class="cm-line ">    <span class="sp-syntax-comment">// 创建包含变更的*新*对象</span><br/></div><div class="cm-line ">    <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">artwork</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">nextSeen</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">;</span><br/></div><div class="cm-line ">  <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">else</span> <span class="sp-syntax-punctuation">{</span><br/></div><div class="cm-line ">    <span class="sp-syntax-comment">// 没有变更</span><br/></div><div class="cm-line ">    <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-plain">artwork</span><span class="sp-syntax-punctuation">;</span><br/></div><div class="cm-line ">  <span class="sp-syntax-punctuation">}</span><br/></div><div class="cm-line "><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span></div></code></pre></div></div></div></div><!--/$-->
<p class="whitespace-pre-wrap my-4">此处的 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">...</code> 是一个对象展开语法，被用来<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="/learn/updating-objects-in-state#copying-objects-with-the-spread-syntax">创建一个对象的拷贝</a>.</p>
<p class="whitespace-pre-wrap my-4">通过这种方式，没有任何现有的 state 中的元素会被改变，bug 也就被修复了。</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj5icq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">let</span> <span class="sp-syntax-plain">nextId</span> = <span class="sp-syntax-static">3</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">initialList</span> = <span class="sp-syntax-punctuation">[</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Big Bellies&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">false</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Lunar Landscape&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">false</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">2</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Terracotta Army&#x27;</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">true</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">BucketList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">myList</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setMyList</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">initialList</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-plain">yourList</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">setYourList</span><span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-plain">initialList</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleToggleMyList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">nextSeen</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-definition">setMyList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">myList</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
      <span class="sp-syntax-keyword">if</span> <span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">id</span> === <span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-comment">// 创建包含变更的*新*对象</span>
        <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">artwork</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">nextSeen</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">else</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-comment">// 没有变更</span>
        <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-plain">artwork</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleToggleYourList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-plain">nextSeen</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-definition">setYourList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">yourList</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
      <span class="sp-syntax-keyword">if</span> <span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">id</span> === <span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-comment">// 创建包含变更的*新*对象</span>
        <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-punctuation">...</span><span class="sp-syntax-plain">artwork</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-plain">nextSeen</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">else</span> <span class="sp-syntax-punctuation">{</span>
        <span class="sp-syntax-comment">// 没有变更</span>
        <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-plain">artwork</span><span class="sp-syntax-punctuation">;</span>
      <span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>艺术愿望清单<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h1</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h2</span><span class="sp-syntax-punctuation">&gt;</span>我想看的艺术清单：<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h2</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-definition">ItemList</span>
        <span class="sp-syntax-property">artworks</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">myList</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onToggle</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">handleToggleMyList</span><span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-punctuation">/&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">h2</span><span class="sp-syntax-punctuation">&gt;</span>你想看的艺术清单：<span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">h2</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-definition">ItemList</span>
        <span class="sp-syntax-property">artworks</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">yourList</span><span class="sp-syntax-punctuation">}</span>
        <span class="sp-syntax-property">onToggle</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">handleToggleYourList</span><span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-punctuation">/&gt;</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

<span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">ItemList</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-property">artworks</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-property">onToggle</span> <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artworks</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">artwork</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">label</span><span class="sp-syntax-punctuation">&gt;</span>
            <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">input</span>
              <span class="sp-syntax-property">type</span>=<span class="sp-syntax-string">&quot;checkbox&quot;</span>
              <span class="sp-syntax-property">checked</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">seen</span><span class="sp-syntax-punctuation">}</span>
              <span class="sp-syntax-property">onChange</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">e</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
                <span class="sp-syntax-definition">onToggle</span><span class="sp-syntax-punctuation">(</span>
                  <span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">,</span>
                  <span class="sp-syntax-plain">e</span>.<span class="sp-syntax-property">target</span>.<span class="sp-syntax-property">checked</span>
                <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
              <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span>
            <span class="sp-syntax-punctuation">/&gt;</span>
            <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">title</span><span class="sp-syntax-punctuation">}</span>
          <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">label</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<p class="whitespace-pre-wrap my-4">通常来讲，<strong class="font-bold">你应该只直接修改你刚刚创建的对象</strong>。如果你正在插入一个<strong class="font-bold">新</strong>的 artwork，你可以修改它，但是如果你想要改变的是 state 中已经存在的东西，你就需要先拷贝一份了。</p>
<h3 id="write-concise-update-logic-with-immer" class="mdx-heading text-2xl font-display leading-9 text-primary dark:text-primary-dark font-bold my-6">使用 Immer 编写简洁的更新逻辑 <a href="#write-concise-update-logic-with-immer" aria-label="Link for 使用 Immer 编写简洁的更新逻辑 " title="Link for 使用 Immer 编写简洁的更新逻辑 " class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h3>
<p class="whitespace-pre-wrap my-4">在没有 mutation 的前提下更新嵌套数组可能会变得有点重复。<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="/learn/updating-objects-in-state#write-concise-update-logic-with-immer">就像对对象一样</a>:</p>
<ul class="ms-6 my-3 list-disc">
<li class="leading-relaxed mb-1">通常情况下，你应该不需要更新处于非常深层级的 state 。如果你有此类需求，你或许需要<a class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal" href="/learn/choosing-the-state-structure#avoid-deeply-nested-state">调整一下数据的结构</a>，让数据变得扁平一些。</li>
<li class="leading-relaxed mb-1">如果你不想改变 state 的数据结构，你也许会更喜欢使用 <a href="https://github.com/immerjs/use-immer" target="_blank" rel="nofollow noopener noreferrer" class="inline text-link dark:text-link-dark border-b border-link border-opacity-0 hover:border-opacity-100 duration-100 ease-in transition leading-normal">Immer</a> ，它让你可以继续使用方便的，但会直接修改原值的语法，并负责为你生成拷贝值。</li>
</ul>
<p class="whitespace-pre-wrap my-4">下面是我们用 Immer 来重写的艺术愿望清单的例子：</p>
</div><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/package.json" type="button">package.json</button><button aria-selected="false" class="  sp-tab-button" data-active="false" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:Rj5kcq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">package.json<span class="ms-2"><svg class="rotate-0" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></span></span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" rounded-b-lg overflow-hidden sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for package.json" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-string">&quot;dependencies&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-string">&quot;immer&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;1.7.3&quot;</span><span class="sp-syntax-punctuation">,</span>
    <span class="sp-syntax-string">&quot;react&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;latest&quot;</span><span class="sp-syntax-punctuation">,</span>
    <span class="sp-syntax-string">&quot;react-dom&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;latest&quot;</span><span class="sp-syntax-punctuation">,</span>
    <span class="sp-syntax-string">&quot;react-scripts&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;latest&quot;</span><span class="sp-syntax-punctuation">,</span>
    <span class="sp-syntax-string">&quot;use-immer&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;0.5.1&quot;</span>
  <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-string">&quot;scripts&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-punctuation">{</span>
    <span class="sp-syntax-string">&quot;start&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;react-scripts start&quot;</span><span class="sp-syntax-punctuation">,</span>
    <span class="sp-syntax-string">&quot;build&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;react-scripts build&quot;</span><span class="sp-syntax-punctuation">,</span>
    <span class="sp-syntax-string">&quot;test&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;react-scripts test --env=jsdom&quot;</span><span class="sp-syntax-punctuation">,</span>
    <span class="sp-syntax-string">&quot;eject&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&quot;react-scripts eject&quot;</span>
  <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-string">&quot;devDependencies&quot;</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">}</span>
<span class="sp-syntax-punctuation">}</span></pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div></div></div></div></div><!--/$--><div class="max-w-4xl ms-0 2xl:mx-auto">
<p class="whitespace-pre-wrap my-4">请注意当使用 Immer 时，<strong class="font-bold">类似 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">artwork.seen = nextSeen</code> 这种会产生 mutation 的语法不会再有任何问题了：</strong></p>
<!--$--><div dir="ltr" class="sandpack sandpack--codeblock rounded-2xl h-full w-full overflow-x-auto flex items-center bg-wash dark:bg-gray-95 shadow-lg my-8" style="contain:content"><div class="sp-wrapper"><div class="sp-stack"><div class="sp-code-editor"><pre class="sp-cm sp-pristine sp-javascript flex align-start"><code class="sp-pre-placeholder grow-[2]"><div class="cm-line "><span class="sp-syntax-definition">updateMyTodos</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">draft</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span><br/></div><div class="cm-line ">  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">artwork</span> = <span class="sp-syntax-plain">draft</span>.<span class="sp-syntax-property">find</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">a</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-plain">a</span>.<span class="sp-syntax-property">id</span> === <span class="sp-syntax-plain">artworkId</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span><br/></div><div class="cm-line ">  <span class="sp-syntax-plain">artwork</span>.<span class="sp-syntax-property">seen</span> = <span class="sp-syntax-plain">nextSeen</span><span class="sp-syntax-punctuation">;</span><br/></div><div class="cm-line "><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span></div></code></pre></div></div></div></div><!--/$-->
<p class="whitespace-pre-wrap my-4">这是因为你并不是在直接修改原始的 state，而是在修改 Immer 提供的一个特殊的 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">draft</code> 对象。同理，你也可以为 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">draft</code> 的内容使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">push()</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">pop()</code> 这些会直接修改原值的方法。</p>
<p class="whitespace-pre-wrap my-4">在幕后，Immer 总是会根据你对 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">draft</code> 的修改来从头开始构建下一个 state。这使得你的事件处理程序非常的简洁，同时也不会直接修改 state。</p>
<section><h2 id="recap" class="mdx-heading text-3xl font-display leading-10 text-primary dark:text-primary-dark font-bold my-6">摘要<a href="#recap" aria-label="Link for 摘要" title="Link for 摘要" class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h2><ul class="ms-6 my-3 list-disc">
<li class="leading-relaxed mb-1">你可以把数组放入 state 中，但你不应该直接修改它。</li>
<li class="leading-relaxed mb-1">不要直接修改数组，而是创建它的一份 <strong class="font-bold">新的</strong> 拷贝，然后使用新的数组来更新它的状态。</li>
<li class="leading-relaxed mb-1">你可以使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">[...arr, newItem]</code> 这样的数组展开语法来向数组中添加元素。</li>
<li class="leading-relaxed mb-1">你可以使用 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">filter()</code> 和 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">map()</code> 来创建一个经过过滤或者变换的数组。</li>
<li class="leading-relaxed mb-1">你可以使用 Immer 来保持代码简洁。</li>
</ul></section>
</div><div class="max-w-7xl mx-auto py-4 w-full"><div class="border-gray-10 bg-card dark:bg-card-dark shadow-inner rounded-none -mx-5 sm:mx-auto sm:rounded-2xl"><div class="py-2 px-5 sm:px-8 pb-0 md:pb-0"><h2 id="challenges" class="mdx-heading text-3xl font-display leading-10 text-primary dark:text-primary-dark font-bold my-6 mb-2 leading-10 relative text-3xl text-link">尝试一些挑战<a href="#challenges" aria-label="Link for 尝试一些挑战" title="Link for 尝试一些挑战" class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h2><div class="flex items-center justify-between"><div class="overflow-hidden"><div class="flex relative transition-transform content-box overflow-x-auto"><button class="py-2 me-4 text-base border-b-4 duration-100 ease-in transition whitespace-nowrap text-ellipsis text-link border-link hover:text-link dark:text-link-dark dark:border-link-dark dark:hover:text-link-dark">1<!-- -->. <!-- -->更新购物车中的商品 </button><button class="py-2 me-4 text-base border-b-4 duration-100 ease-in transition whitespace-nowrap text-ellipsis">2<!-- -->. <!-- -->删除购物车中的商品 </button><button class="py-2 me-4 text-base border-b-4 duration-100 ease-in transition whitespace-nowrap text-ellipsis">3<!-- -->. <!-- -->使用不会直接修改原始值的方法修复 mutation 的问题 </button><button class="py-2 me-4 text-base border-b-4 duration-100 ease-in transition whitespace-nowrap text-ellipsis">4<!-- -->. <!-- -->使用 Immer 修复 mutation 的问题 </button></div></div><div class="flex z-10 pb-2 ps-2"><button aria-label="Scroll left" class="bg-secondary-button dark:bg-secondary-button-dark h-8 px-2 rounded-l border-gray-20 border-r rtl:rotate-180 text-gray-30"><svg class="rotate-90 rtl:-rotate-90" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></button><button aria-label="Scroll right" class="bg-secondary-button dark:bg-secondary-button-dark h-8 px-2 rounded-e rtl:rotate-180 text-primary dark:text-primary-dark"><svg class="-rotate-90 rtl:rotate-90" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg></button></div></div></div><div class="p-5 sm:py-8 sm:px-8"><div><h4 id="update-an-item-in-the-shopping-cart" class="mdx-heading text-xl text-primary dark:text-primary-dark mb-2 mt-0 font-medium text-xl font-display font-bold leading-9 my-4"><div class="font-bold block md:inline">第 <!-- -->1<!-- --> 个<!-- -->挑战<!-- --> 共<!-- --> <!-- -->4<!-- --> 个挑战<span class="text-primary dark:text-primary-dark">: </span></div>更新购物车中的商品 <a href="#update-an-item-in-the-shopping-cart" aria-label="Link for this heading" title="Link for this heading" class="mdx-header-anchor inline-block"><svg width="1em" height="1em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg" class="text-gray-70 ms-2 h-5 w-5"><g fill="currentColor" fill-rule="evenodd"><path d="M7.778 7.975a2.5 2.5 0 0 0 .347-3.837L6.017 2.03a2.498 2.498 0 0 0-3.542-.007 2.5 2.5 0 0 0 .006 3.543l1.153 1.15c.07-.29.154-.563.25-.773.036-.077.084-.16.14-.25L3.18 4.85a1.496 1.496 0 0 1 .002-2.12 1.496 1.496 0 0 1 2.12 0l2.124 2.123a1.496 1.496 0 0 1-.333 2.37c.16.246.42.504.685.752z"></path><path d="M5.657 4.557a2.5 2.5 0 0 0-.347 3.837l2.108 2.108a2.498 2.498 0 0 0 3.542.007 2.5 2.5 0 0 0-.006-3.543L9.802 5.815c-.07.29-.154.565-.25.774-.036.076-.084.16-.14.25l.842.84c.585.587.59 1.532 0 2.122-.587.585-1.532.59-2.12 0L6.008 7.68a1.496 1.496 0 0 1 .332-2.372c-.16-.245-.42-.503-.685-.75z"></path></g></svg></a></h4><p class="whitespace-pre-wrap my-4">填写 <code dir="ltr" class="inline text-code text-secondary dark:text-secondary-dark px-1 rounded-md no-underline bg-gray-30 bg-opacity-10 py-px">handleIncreaseClick</code> 的逻辑，以便按下“+”时递增对应数字：</p><!--$--><div class="sandpack sandpack--playground w-full my-8" dir="ltr"><div class="sp-wrapper"><div class="shadow-lg dark:shadow-lg-dark rounded-lg" style="contain:content"><div class="bg-wash dark:bg-card-dark flex justify-between items-center relative z-10 border-b border-border dark:border-border-dark rounded-t-lg text-lg"><div class="flex-1 grow min-w-0 px-4 lg:px-6"><div><div class="relative overflow-hidden"><div class="w-[fit-content] invisible"><div class=" sp-tabs" translate="no"><div aria-label="Select active file" class=" sp-tabs-scrollable-container" role="tablist"><button aria-selected="true" class="  sp-tab-button" data-active="true" role="tab" title="/src/App.js" type="button">App.js</button></div></div></div><button class="absolute top-0 start-[2px]" id="headlessui-listbox-button-:R9iq6mcq6:" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><span class="h-full py-2 px-1 mt-px -mb-px flex border-b text-link dark:text-link-dark border-link dark:border-link-dark items-center text-md leading-tight truncate" style="max-width:160px">App.js</span></button></div></div></div><div class="px-3 flex items-center justify-end text-start" translate="yes"><button class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1" title="Reset Sandbox" type="button"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative"><path d="M13.8982 5.20844C12.4626 4.88688 10.9686 4.93769 9.55821 5.35604L11.8524 3.06184C11.8989 3.0154 11.9357 2.96028 11.9608 2.89961C11.986 2.83894 11.9989 2.77391 11.9989 2.70824C11.9989 2.64256 11.986 2.57754 11.9608 2.51686C11.9357 2.45619 11.8989 2.40107 11.8524 2.35464L11.1456 1.64784C11.0992 1.60139 11.0441 1.56455 10.9834 1.53942C10.9227 1.51428 10.8577 1.50134 10.792 1.50134C10.7263 1.50134 10.6613 1.51428 10.6006 1.53942C10.54 1.56455 10.4848 1.60139 10.4384 1.64784L6.14571 5.94054C6.00654 6.07969 5.89615 6.2449 5.82083 6.42673C5.74551 6.60855 5.70675 6.80343 5.70675 7.00024C5.70675 7.19704 5.74551 7.39192 5.82083 7.57374C5.89615 7.75557 6.00654 7.92078 6.14571 8.05994L10.4387 12.3529C10.5325 12.4465 10.6595 12.4991 10.792 12.4991C10.9245 12.4991 11.0516 12.4465 11.1453 12.3529L11.8527 11.6455C11.9463 11.5518 11.9989 11.4247 11.9989 11.2922C11.9989 11.1598 11.9463 11.0327 11.8527 10.9389L8.77481 7.86104C9.99795 7.16236 11.415 6.8801 12.8125 7.05678C14.21 7.23347 15.5122 7.85953 16.523 8.84064C17.5338 9.82176 18.1983 11.1048 18.4165 12.4964C18.6347 13.888 18.3947 15.3129 17.7328 16.5562C17.0708 17.7996 16.0227 18.7942 14.7463 19.3902C13.47 19.9861 12.0345 20.1511 10.6563 19.8603C9.27798 19.5695 8.03152 18.8387 7.10469 17.778C6.17786 16.7172 5.62086 15.384 5.51761 13.9791C5.51156 13.8512 5.45689 13.7303 5.36477 13.6413C5.27265 13.5522 5.15001 13.5017 5.02191 13.5H4.02081C3.95297 13.4996 3.88574 13.5129 3.8232 13.5392C3.76065 13.5655 3.70408 13.6042 3.6569 13.6529C3.60972 13.7017 3.57291 13.7595 3.54869 13.8228C3.52448 13.8862 3.51336 13.9538 3.51601 14.0216C3.61349 15.5965 4.1473 17.1132 5.0577 18.4019C5.9681 19.6906 7.21917 20.7006 8.6709 21.3188C10.1226 21.937 11.7178 22.139 13.2778 21.9022C14.8378 21.6654 16.3011 20.9992 17.504 19.978C18.7069 18.9569 19.6019 17.6212 20.0889 16.1203C20.5759 14.6195 20.6356 13.0128 20.2614 11.4799C19.8872 9.94705 19.0938 8.54858 17.97 7.44098C16.8462 6.33339 15.4363 5.56037 13.8982 5.20844V5.20844Z" fill="currentColor"></path></svg> 重置</button><a href="https://codesandbox.io/api/v1/sandboxes/define?undefined&amp;environment=create-react-app" rel="noreferrer noopener" target="_blank" title="Open in CodeSandbox" class="text-sm text-primary dark:text-primary-dark inline-flex items-center hover:text-link duration-100 ease-in transition mx-1 ms-2 md:ms-1"><svg width="1em" height="1em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="inline mx-1 relative top-[1px]"><path d="M20.5001 2H15.5001C15.3675 2 15.2403 2.05268 15.1465 2.14645C15.0528 2.24021 15.0001 2.36739 15.0001 2.5V3.5C15.0001 3.63261 15.0528 3.75979 15.1465 3.85355C15.2403 3.94732 15.3675 4 15.5001 4H18.5901L7.6501 14.94C7.60323 14.9865 7.56604 15.0418 7.54065 15.1027C7.51527 15.1636 7.5022 15.229 7.5022 15.295C7.5022 15.361 7.51527 15.4264 7.54065 15.4873C7.56604 15.5482 7.60323 15.6035 7.6501 15.65L8.3501 16.35C8.39658 16.3969 8.45188 16.4341 8.51281 16.4594C8.57374 16.4848 8.63909 16.4979 8.7051 16.4979C8.7711 16.4979 8.83646 16.4848 8.89738 16.4594C8.95831 16.4341 9.01362 16.3969 9.0601 16.35L20.0001 5.41V8.5C20.0001 8.63261 20.0528 8.75979 20.1465 8.85355C20.2403 8.94732 20.3675 9 20.5001 9H21.5001C21.6327 9 21.7599 8.94732 21.8537 8.85355C21.9474 8.75979 22.0001 8.63261 22.0001 8.5V3.5C22.0001 3.10218 21.8421 2.72064 21.5608 2.43934C21.2795 2.15804 20.8979 2 20.5001 2V2Z" fill="currentColor"></path><path d="M21.5 13H20.5C20.3674 13 20.2402 13.0527 20.1464 13.1464C20.0527 13.2402 20 13.3674 20 13.5V20H4V4H10.5C10.6326 4 10.7598 3.94732 10.8536 3.85355C10.9473 3.75979 11 3.63261 11 3.5V2.5C11 2.36739 10.9473 2.24021 10.8536 2.14645C10.7598 2.05268 10.6326 2 10.5 2H3.5C3.10218 2 2.72064 2.15804 2.43934 2.43934C2.15804 2.72064 2 3.10218 2 3.5V20.5C2 20.8978 2.15804 21.2794 2.43934 21.5607C2.72064 21.842 3.10218 22 3.5 22H20.5C20.8978 22 21.2794 21.842 21.5607 21.5607C21.842 21.2794 22 20.8978 22 20.5V13.5C22 13.3674 21.9473 13.2402 21.8536 13.1464C21.7598 13.0527 21.6326 13 21.5 13Z" fill="currentColor"></path></svg><span class="hidden md:block">Fork</span></a></div></div><div class=" sp-layout"><div class=" sp-editor sp-stack"><div class=" sp-code-editor"><div aria-autocomplete="list" aria-label="Code Editor for App.js" aria-multiline="true" class="sp-pristine sp-javascript   sp-cm" role="textbox" tabindex="0" translate="no"><pre class=" sp-pre-placeholder" style="margin-left:var(--sp-space-11)"><span class="sp-syntax-keyword">import</span> <span class="sp-syntax-punctuation">{</span> <span class="sp-syntax-plain">useState</span> <span class="sp-syntax-punctuation">}</span> <span class="sp-syntax-keyword">from</span> <span class="sp-syntax-string">&#x27;react&#x27;</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">const</span> <span class="sp-syntax-plain">initialProducts</span> = <span class="sp-syntax-punctuation">[</span><span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">0</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Baklava&#x27;</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-property">count</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">1</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Cheese&#x27;</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-property">count</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">5</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">,</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">2</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-string">&#x27;Spaghetti&#x27;</span><span class="sp-syntax-punctuation">,</span>
  <span class="sp-syntax-property">count</span><span class="sp-syntax-punctuation">:</span> <span class="sp-syntax-static">2</span><span class="sp-syntax-punctuation">,</span>
<span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">]</span><span class="sp-syntax-punctuation">;</span>

<span class="sp-syntax-keyword">export</span> <span class="sp-syntax-keyword">default</span> <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">ShoppingCart</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>
  <span class="sp-syntax-keyword">const</span> <span class="sp-syntax-punctuation">[</span>
    <span class="sp-syntax-plain">products</span><span class="sp-syntax-punctuation">,</span>
    <span class="sp-syntax-plain">setProducts</span>
  <span class="sp-syntax-punctuation">]</span> = <span class="sp-syntax-definition">useState</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">initialProducts</span><span class="sp-syntax-punctuation">)</span>

  <span class="sp-syntax-keyword">function</span> <span class="sp-syntax-definition">handleIncreaseClick</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">productId</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">{</span>

  <span class="sp-syntax-punctuation">}</span>

  <span class="sp-syntax-keyword">return</span> <span class="sp-syntax-punctuation">(</span>
    <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">products</span>.<span class="sp-syntax-property">map</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">product</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">(</span>
        <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">li</span> <span class="sp-syntax-property">key</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">product</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
          <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">product</span>.<span class="sp-syntax-property">name</span><span class="sp-syntax-punctuation">}</span>
          <span class="sp-syntax-punctuation">{</span><span class="sp-syntax-string">&#x27; &#x27;</span><span class="sp-syntax-punctuation">}</span>
          (<span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">b</span><span class="sp-syntax-punctuation">&gt;</span><span class="sp-syntax-punctuation">{</span><span class="sp-syntax-plain">product</span>.<span class="sp-syntax-property">count</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">b</span><span class="sp-syntax-punctuation">&gt;</span>)
          <span class="sp-syntax-punctuation">&lt;</span><span class="sp-syntax-tag">button</span> <span class="sp-syntax-property">onClick</span>=<span class="sp-syntax-punctuation">{</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-punctuation">)</span> <span class="sp-syntax-punctuation">=&gt;</span> <span class="sp-syntax-punctuation">{</span>
            <span class="sp-syntax-definition">handleIncreaseClick</span><span class="sp-syntax-punctuation">(</span><span class="sp-syntax-plain">product</span>.<span class="sp-syntax-property">id</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
          <span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">}</span><span class="sp-syntax-punctuation">&gt;</span>
            +
          <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">button</span><span class="sp-syntax-punctuation">&gt;</span>
        <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">li</span><span class="sp-syntax-punctuation">&gt;</span>
      <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">}</span>
    <span class="sp-syntax-punctuation">&lt;/</span><span class="sp-syntax-tag">ul</span><span class="sp-syntax-punctuation">&gt;</span>
  <span class="sp-syntax-punctuation">)</span><span class="sp-syntax-punctuation">;</span>
<span class="sp-syntax-punctuation">}</span>

</pre></div></div></div><div class=" order-last xl:order-2 sp-stack"><div class="p-0 sm:p-2 md:p-4 lg:p-8 bg-card dark:bg-wash-dark h-full relative md:rounded-b-lg lg:rounded-b-none"><div style="position:relative"><iframe class="rounded-t-none bg-white md:shadow-md sm:rounded-lg w-full max-w-full transition-opacity absolute opacity-0 pointer-events-none duration-75" title="Sandbox Preview" style="height:15px;z-index:-1"></iframe></div></div></div><button translate="yes" class="sandpack-expand flex text-base justify-between dark:border-card-dark bg-wash dark:bg-card-dark items-center z-10 p-1 w-full order-2 xl:order-last border-b-1 relative top-0"><span class="flex p-2 focus:outline-none text-primary dark:text-primary-dark leading-[20px]"><svg class="rotate-0 inline me-1.5 text-xl" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg>显示更多</span></button></div></div></div></div><!--/$--></div><div class="flex justify-between items-center mt-4"><button class="me-2 text-base leading-tight font-bold rounded-full py-2 px-4 focus:outline focus:outline-offset-2 focus:outline-link dark:focus:outline-link-dark inline-flex items-center my-1 bg-transparent text-primary dark:text-primary-dark active:text-primary shadow-secondary-button-stroke dark:shadow-secondary-button-stroke-dark hover:bg-gray-40/5 active:bg-gray-40/10  hover:dark:bg-gray-60/5 active:dark:bg-gray-60/10"><svg class="inline me-1.5" width="0.75em" height="0.75em" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg"><path d="M2.21908 8.74479V12.7448H0.885742V0.078125H7.14041C7.26418 0.0781911 7.3855 0.112714 7.49076 0.177827C7.59602 0.242939 7.68108 0.336071 7.73641 0.446792L8.21908 1.41146H12.2191C12.3959 1.41146 12.5655 1.4817 12.6905 1.60672C12.8155 1.73174 12.8857 1.90131 12.8857 2.07812V9.41146C12.8857 9.58827 12.8155 9.75784 12.6905 9.88286C12.5655 10.0079 12.3959 10.0781 12.2191 10.0781H7.96441C7.84063 10.0781 7.71932 10.0435 7.61406 9.97842C7.50879 9.91331 7.42374 9.82018 7.36841 9.70946L6.88574 8.74479H2.21908ZM2.21908 1.41146V7.41146H7.70974L8.37641 8.74479H11.5524V2.74479H7.39508L6.72841 1.41146H2.21908Z" fill="currentColor"></path></svg> <!-- -->展示答案</button><button class="bg-link dark:bg-link-dark text-base leading-tight font-bold rounded-full py-2 px-4 focus:outline focus:outline-offset-2 focus:outline-link dark:focus:outline-link-dark inline-flex items-center my-1 bg-link border-link text-white hover:bg-link focus:bg-link active:bg-link">下一个<!-- -->挑战<svg width="1em" height="1em" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="block ms-1.5"><path d="M6.86612 13.6161C6.37796 14.1043 6.37796 14.8957 6.86612 15.3839C7.35427 15.872 8.14572 15.872 8.63388 15.3839L13.1339 10.8839C13.622 10.3957 13.622 9.60428 13.1339 9.11612L8.63388 4.61612C8.14572 4.12797 7.35427 4.12797 6.86612 4.61612C6.37796 5.10428 6.37796 5.89573 6.86612 6.38388L10.4822 10L6.86612 13.6161Z" fill="currentColor"></path></svg></button></div></div></div></div></div><div class="grid grid-cols-1 gap-4 py-4 mx-auto max-w-7xl md:grid-cols-2 md:py-12"><a class="flex gap-x-4 md:gap-x-6 items-center w-full md:min-w-80 md:w-fit md:max-w-md px-4 md:px-5 py-6 border-2 border-transparent text-base leading-base text-link dark:text-link-dark rounded-lg group focus:text-link dark:focus:text-link-dark focus:bg-highlight focus:border-link dark:focus:bg-highlight-dark dark:focus:border-link-dark focus:border-opacity-100 focus:border-2 focus:ring-1 focus:ring-offset-4 focus:ring-blue-40 active:ring-0 active:ring-offset-0 hover:bg-gray-5 dark:hover:bg-gray-80" href="/learn/updating-objects-in-state"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" class="duration-100 ease-in transition rotate-90 rtl:-rotate-90 inline text-tertiary dark:text-tertiary-dark group-focus:text-link dark:group-focus:text-link-dark" style="min-width:20px;min-height:20px"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg><div class="flex flex-col overflow-hidden"><span class="text-sm font-bold tracking-wide no-underline uppercase text-secondary dark:text-secondary-dark group-focus:text-link dark:group-focus:text-link-dark group-focus:text-opacity-100">上一页</span><span class="text-lg break-words group-hover:underline">更新 state 中的对象</span></div></a><a class="flex gap-x-4 md:gap-x-6 items-center w-full md:min-w-80 md:w-fit md:max-w-md px-4 md:px-5 py-6 border-2 border-transparent text-base leading-base text-link dark:text-link-dark rounded-lg group focus:text-link dark:focus:text-link-dark focus:bg-highlight focus:border-link dark:focus:bg-highlight-dark dark:focus:border-link-dark focus:border-opacity-100 focus:border-2 focus:ring-1 focus:ring-offset-4 focus:ring-blue-40 active:ring-0 active:ring-offset-0 hover:bg-gray-5 dark:hover:bg-gray-80 flex-row-reverse justify-self-end text-end" href="/learn/managing-state"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" class="duration-100 ease-in transition -rotate-90 rtl:rotate-90 inline text-tertiary dark:text-tertiary-dark group-focus:text-link dark:group-focus:text-link-dark" style="min-width:20px;min-height:20px"><g fill="none" fill-rule="evenodd" transform="translate(-446 -398)"><path fill="currentColor" fill-rule="nonzero" d="M95.8838835,240.366117 C95.3957281,239.877961 94.6042719,239.877961 94.1161165,240.366117 C93.6279612,240.854272 93.6279612,241.645728 94.1161165,242.133883 L98.6161165,246.633883 C99.1042719,247.122039 99.8957281,247.122039 100.383883,246.633883 L104.883883,242.133883 C105.372039,241.645728 105.372039,240.854272 104.883883,240.366117 C104.395728,239.877961 103.604272,239.877961 103.116117,240.366117 L99.5,243.982233 L95.8838835,240.366117 Z" transform="translate(356.5 164.5)"></path><polygon points="446 418 466 418 466 398 446 398"></polygon></g></svg><div class="flex flex-col overflow-hidden"><span class="text-sm font-bold tracking-wide no-underline uppercase text-secondary dark:text-secondary-dark group-focus:text-link dark:group-focus:text-link-dark group-focus:text-opacity-100">下一页</span><span class="text-lg break-words group-hover:underline">状态管理</span></div></a></div></div></div></article><div class="self-stretch w-full"><div class="w-full px-5 pt-10 mx-auto sm:px-12 md:px-12 md:pt-12 lg:pt-10"><hr class="mx-auto max-w-7xl border-border dark:border-border-dark"/></div><div class="py-12 px-5 sm:px-12 md:px-12 sm:py-12 md:py-16 lg:py-14"></div></div></main><!--/$--><div class="hidden -mt-16 lg:max-w-custom-xs 2xl:block"><nav role="navigation" class="pt-20 sticky top-0 end-0"><h2 class="mb-3 lg:mb-3 uppercase tracking-wide font-bold text-sm text-secondary dark:text-secondary-dark px-4 w-full">目录</h2><div class="h-full overflow-y-auto ps-4 max-h-[calc(100vh-7.5rem)]" style="overscroll-behavior:contain"><ul class="space-y-2 pb-16"><li class="text-sm px-2 rounded-s-xl bg-highlight dark:bg-highlight-dark"><a class="text-link dark:text-link-dark font-bold block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#">概览</a></li><li class="text-sm px-2 rounded-s-xl"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#updating-arrays-without-mutation">在没有 mutation 的前提下更新数组 </a></li><li class="text-sm px-2 rounded-s-xl ps-4"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#adding-to-an-array">向数组中添加元素 </a></li><li class="text-sm px-2 rounded-s-xl ps-4"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#removing-from-an-array">从数组中删除元素 </a></li><li class="text-sm px-2 rounded-s-xl ps-4"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#transforming-an-array">转换数组 </a></li><li class="text-sm px-2 rounded-s-xl ps-4"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#replacing-items-in-an-array">替换数组中的元素 </a></li><li class="text-sm px-2 rounded-s-xl ps-4"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#inserting-into-an-array">向数组中插入元素 </a></li><li class="text-sm px-2 rounded-s-xl ps-4"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#making-other-changes-to-an-array">其他改变数组的情况 </a></li><li class="text-sm px-2 rounded-s-xl"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#updating-objects-inside-arrays">更新数组内部的对象 </a></li><li class="text-sm px-2 rounded-s-xl ps-4"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#write-concise-update-logic-with-immer">使用 Immer 编写简洁的更新逻辑 </a></li><li class="text-sm px-2 rounded-s-xl"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#recap">Recap</a></li><li class="text-sm px-2 rounded-s-xl"><a class="text-secondary dark:text-secondary-dark block hover:text-link dark:hover:text-link-dark leading-normal py-2" href="#challenges">Challenges</a></li></ul></div></nav></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"toc":"[{\"url\":\"#\",\"text\":\"概览\",\"depth\":2},{\"url\":\"#updating-arrays-without-mutation\",\"depth\":2,\"text\":\"在没有 mutation 的前提下更新数组 \"},{\"url\":\"#adding-to-an-array\",\"depth\":3,\"text\":\"向数组中添加元素 \"},{\"url\":\"#removing-from-an-array\",\"depth\":3,\"text\":\"从数组中删除元素 \"},{\"url\":\"#transforming-an-array\",\"depth\":3,\"text\":\"转换数组 \"},{\"url\":\"#replacing-items-in-an-array\",\"depth\":3,\"text\":\"替换数组中的元素 \"},{\"url\":\"#inserting-into-an-array\",\"depth\":3,\"text\":\"向数组中插入元素 \"},{\"url\":\"#making-other-changes-to-an-array\",\"depth\":3,\"text\":\"其他改变数组的情况 \"},{\"url\":\"#updating-objects-inside-arrays\",\"depth\":2,\"text\":\"更新数组内部的对象 \"},{\"url\":\"#write-concise-update-logic-with-immer\",\"depth\":3,\"text\":\"使用 Immer 编写简洁的更新逻辑 \"},{\"url\":\"#recap\",\"depth\":2,\"text\":\"Recap\"},{\"url\":\"#challenges\",\"depth\":2,\"text\":\"Challenges\"}]","content":"[[\"$r\",\"MaxWidth\",\"22\",{\"children\":[[\"$r\",\"Intro\",null,{\"children\":[\"$r\",\"p\",null,{\"children\":\"数组是另外一种可以存储在 state 中的 JavaScript 对象，它虽然是可变的，但是却应该被视为不可变。同对象一样，当你想要更新存储于 state 中的数组时，你需要创建一个新的数组（或者创建一份已有数组的拷贝值），并使用新数组设置 state。\"}]}],\"\\n\",[\"$r\",\"YouWillLearn\",null,{\"children\":[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"如何添加、删除或者修改 React state 中的数组中的元素\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"如何更新数组内部的对象\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"如何通过 Immer 降低数组拷贝的重复度\"}],\"\\n\"]}]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"updating-arrays-without-mutation\",\"children\":\"在没有 mutation 的前提下更新数组 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"在 JavaScript 中，数组只是另一种对象。\",[\"$r\",\"a\",null,{\"href\":\"/learn/updating-objects-in-state\",\"children\":\"同对象一样\"}],\"，\",[\"$r\",\"strong\",null,{\"children\":\"你需要将 React state 中的数组视为只读的\"}],\"。这意味着你不应该使用类似于 \",[\"$r\",\"code\",null,{\"children\":\"arr[0] = 'bird'\"}],\" 这样的方式来重新分配数组中的元素，也不应该使用会直接修改原始数组的方法，例如 \",[\"$r\",\"code\",null,{\"children\":\"push()\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"pop()\"}],\"。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"相反，每次要更新一个数组时，你需要把一个\",[\"$r\",\"strong\",null,{\"children\":\"新\"}],\"的数组传入 state 的 setting 方法中。为此，你可以通过使用像 \",[\"$r\",\"code\",null,{\"children\":\"filter()\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"map()\"}],\" 这样不会直接修改原始值的方法，从原始数组生成一个新的数组。然后你就可以将 state 设置为这个新生成的数组。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"下面是常见数组操作的参考表。当你操作 React state 中的数组时，你需要避免使用左列的方法，而首选右列的方法：\"}],\"\\n\",[\"$r\",\"table\",null,{\"children\":[[\"$r\",\"thead\",null,{\"children\":[\"$r\",\"tr\",null,{\"children\":[[\"$r\",\"th\",null,{}],[\"$r\",\"th\",null,{\"children\":\"避免使用 (会改变原始数组)\"}],[\"$r\",\"th\",null,{\"children\":\"推荐使用 (会返回一个新数组）\"}]]}]}],[\"$r\",\"tbody\",null,{\"children\":[[\"$r\",\"tr\",null,{\"children\":[[\"$r\",\"td\",null,{\"children\":\"添加元素\"}],[\"$r\",\"td\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"push\"}],\"，\",[\"$r\",\"code\",null,{\"children\":\"unshift\"}]]}],[\"$r\",\"td\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"concat\"}],\"，\",[\"$r\",\"code\",null,{\"children\":\"[...arr]\"}],\" 展开语法（\",[\"$r\",\"a\",null,{\"href\":\"#adding-to-an-array\",\"children\":\"例子\"}],\"）\"]}]]}],[\"$r\",\"tr\",null,{\"children\":[[\"$r\",\"td\",null,{\"children\":\"删除元素\"}],[\"$r\",\"td\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"pop\"}],\"，\",[\"$r\",\"code\",null,{\"children\":\"shift\"}],\"，\",[\"$r\",\"code\",null,{\"children\":\"splice\"}]]}],[\"$r\",\"td\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"filter\"}],\"，\",[\"$r\",\"code\",null,{\"children\":\"slice\"}],\"（\",[\"$r\",\"a\",null,{\"href\":\"#removing-from-an-array\",\"children\":\"例子\"}],\"）\"]}]]}],[\"$r\",\"tr\",null,{\"children\":[[\"$r\",\"td\",null,{\"children\":\"替换元素\"}],[\"$r\",\"td\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"splice\"}],\"，\",[\"$r\",\"code\",null,{\"children\":\"arr[i] = ...\"}],\" 赋值\"]}],[\"$r\",\"td\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"map\"}],\"（\",[\"$r\",\"a\",null,{\"href\":\"#replacing-items-in-an-array\",\"children\":\"例子\"}],\"）\"]}]]}],[\"$r\",\"tr\",null,{\"children\":[[\"$r\",\"td\",null,{\"children\":\"排序\"}],[\"$r\",\"td\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"reverse\"}],\"，\",[\"$r\",\"code\",null,{\"children\":\"sort\"}]]}],[\"$r\",\"td\",null,{\"children\":[\"先将数组复制一份（\",[\"$r\",\"a\",null,{\"href\":\"#making-other-changes-to-an-array\",\"children\":\"例子\"}],\"）\"]}]]}]]}]]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"或者，你可以\",[\"$r\",\"a\",null,{\"href\":\"#write-concise-update-logic-with-immer\",\"children\":\"使用 Immer\"}],\" ，这样你便可以使用表格中的所有方法了。\"]}],\"\\n\",[\"$r\",\"Pitfall\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"不幸的是，虽然 \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/slice\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"slice\"}]}],\" 和 \",[\"$r\",\"a\",null,{\"href\":\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/splice\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":[\"$r\",\"code\",null,{\"children\":\"splice\"}]}],\" 的名字相似，但作用却迥然不同：\"]}],[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"slice\"}],\" 让你可以拷贝数组或是数组的一部分。\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"splice\"}],\" \",[\"$r\",\"strong\",null,{\"children\":\"会直接修改\"}],\" 原始数组（插入或者删除元素）。\"]}],\"\\n\"]}],[\"$r\",\"p\",null,{\"children\":[\"在 React 中，更多情况下你会使用 \",[\"$r\",\"code\",null,{\"children\":\"slice\"}],\"（没有 \",[\"$r\",\"code\",null,{\"children\":\"p\"}],\" ！），因为你不想改变 state 中的对象或数组。\",[\"$r\",\"a\",null,{\"href\":\"/learn/updating-objects-in-state\",\"children\":\"更新对象\"}],\"这一章节解释了什么是 mutation，以及为什么不推荐在 state 里这样做。\"]}]]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"adding-to-an-array\",\"children\":\"向数组中添加元素 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"push()\"}],\" 会直接修改原始数组，而你不希望这样：\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nlet nextId = 0;\\r\\n\\r\\nexport default function List() {\\r\\n  const [name, setName] = useState('');\\r\\n  const [artists, setArtists] = useState([]);\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003ch1\u003e振奋人心的雕塑家们：\u003c/h1\u003e\\r\\n      \u003cinput\\r\\n        value={name}\\r\\n        onChange={e =\u003e setName(e.target.value)}\\r\\n      /\u003e\\r\\n      \u003cbutton onClick={() =\u003e {\\r\\n        artists.push({\\r\\n          id: nextId++,\\r\\n          name: name,\\r\\n        });\\r\\n      }}\u003e添加\u003c/button\u003e\\r\\n      \u003cul\u003e\\r\\n        {artists.map(artist =\u003e (\\r\\n          \u003cli key={artist.id}\u003e{artist.name}\u003c/li\u003e\\r\\n        ))}\\r\\n      \u003c/ul\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin-left: 5px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"30\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"相反，你应该创建一个 \",[\"$r\",\"strong\",null,{\"children\":\"新\"}],\" 数组，其包含了原始数组的所有元素 \",[\"$r\",\"strong\",null,{\"children\":\"以及\"}],\" 一个在末尾的新元素。这可以通过很多种方法实现，最简单的一种就是使用 \",[\"$r\",\"code\",null,{\"children\":\"...\"}],\" \",[\"$r\",\"a\",null,{\"href\":\"a-javascript-refresher#array-spread\",\"children\":\"数组展开\"}],\" 语法：\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"setArtists( // 替换 state\\r\\n  [ // 是通过传入一个新数组实现的\\r\\n    ...artists, // 新数组包含原数组的所有元素\\r\\n    { id: nextId++, name: name } // 并在末尾添加了一个新的元素\\r\\n  ]\\r\\n);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"现在代码可以正常运行了：\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nlet nextId = 0;\\r\\n\\r\\nexport default function List() {\\r\\n  const [name, setName] = useState('');\\r\\n  const [artists, setArtists] = useState([]);\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003ch1\u003e振奋人心的雕塑家们：\u003c/h1\u003e\\r\\n      \u003cinput\\r\\n        value={name}\\r\\n        onChange={e =\u003e setName(e.target.value)}\\r\\n      /\u003e\\r\\n      \u003cbutton onClick={() =\u003e {\\r\\n        setArtists([\\r\\n          ...artists,\\r\\n          { id: nextId++, name: name }\\r\\n        ]);\\r\\n      }}\u003e添加\u003c/button\u003e\\r\\n      \u003cul\u003e\\r\\n        {artists.map(artist =\u003e (\\r\\n          \u003cli key={artist.id}\u003e{artist.name}\u003c/li\u003e\\r\\n        ))}\\r\\n      \u003c/ul\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin-left: 5px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"42\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"数组展开运算符还允许你把新添加的元素放在原始的 \",[\"$r\",\"code\",null,{\"children\":\"...artists\"}],\" 之前：\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"setArtists([\\r\\n  { id: nextId++, name: name },\\r\\n  ...artists // 将原数组中的元素放在末尾\\r\\n]);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"这样一来，展开操作就可以完成 \",[\"$r\",\"code\",null,{\"children\":\"push()\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"unshift()\"}],\" 的工作，将新元素添加到数组的末尾和开头。你可以在上面的 sandbox 中尝试一下！\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"removing-from-an-array\",\"children\":\"从数组中删除元素 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"从数组中删除一个元素最简单的方法就是将它\",[\"$r\",\"strong\",null,{\"children\":\"过滤出去\"}],\"。换句话说，你需要生成一个不包含该元素的新数组。这可以通过 \",[\"$r\",\"code\",null,{\"children\":\"filter\"}],\" 方法实现，例如：\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nlet initialArtists = [\\r\\n  { id: 0, name: 'Marta Colvin Andrade' },\\r\\n  { id: 1, name: 'Lamidi Olonade Fakeye'},\\r\\n  { id: 2, name: 'Louise Nevelson'},\\r\\n];\\r\\n\\r\\nexport default function List() {\\r\\n  const [artists, setArtists] = useState(\\r\\n    initialArtists\\r\\n  );\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003ch1\u003e振奋人心的雕塑家们：\u003c/h1\u003e\\r\\n      \u003cul\u003e\\r\\n        {artists.map(artist =\u003e (\\r\\n          \u003cli key={artist.id}\u003e\\r\\n            {artist.name}{' '}\\r\\n            \u003cbutton onClick={() =\u003e {\\r\\n              setArtists(\\r\\n                artists.filter(a =\u003e\\r\\n                  a.id !== artist.id\\r\\n                )\\r\\n              );\\r\\n            }}\u003e\\r\\n              删除\\r\\n            \u003c/button\u003e\\r\\n          \u003c/li\u003e\\r\\n        ))}\\r\\n      \u003c/ul\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}]}],[\"$r\",\"MaxWidth\",\"56\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":\"点击“删除”按钮几次，并且查看按钮处理点击事件的代码。\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"setArtists(\\r\\n  artists.filter(a =\u003e a.id !== artist.id)\\r\\n);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"这里，\",[\"$r\",\"code\",null,{\"children\":\"artists.filter(s =\u003e s.id !== artist.id)\"}],\" 表示“创建一个新的数组，该数组由那些 ID 与 \",[\"$r\",\"code\",null,{\"children\":\"artists.id\"}],\" 不同的 \",[\"$r\",\"code\",null,{\"children\":\"artists\"}],\" 组成”。换句话说，每个 artist 的“删除”按钮会把 \",[\"$r\",\"em\",null,{\"children\":\"那一个\"}],\" artist 从原始数组中过滤掉，并使用过滤后的数组再次进行渲染。注意，\",[\"$r\",\"code\",null,{\"children\":\"filter\"}],\" 并不会改变原始数组。\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"transforming-an-array\",\"children\":\"转换数组 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"如果你想改变数组中的某些或全部元素，你可以用 \",[\"$r\",\"code\",null,{\"children\":\"map()\"}],\" 创建一个\",[\"$r\",\"strong\",null,{\"children\":\"新\"}],\"数组。你传入 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\" 的函数决定了要根据每个元素的值或索引（或二者都要）对元素做何处理。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"在下面的例子中，一个数组记录了两个圆形和一个正方形的坐标。当你点击按钮时，仅有两个圆形会向下移动 100 像素。这是通过使用 \",[\"$r\",\"code\",null,{\"children\":\"map()\"}],\" 生成一个新数组实现的。\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nlet initialShapes = [\\r\\n  { id: 0, type: 'circle', x: 50, y: 100 },\\r\\n  { id: 1, type: 'square', x: 150, y: 100 },\\r\\n  { id: 2, type: 'circle', x: 250, y: 100 },\\r\\n];\\r\\n\\r\\nexport default function ShapeEditor() {\\r\\n  const [shapes, setShapes] = useState(\\r\\n    initialShapes\\r\\n  );\\r\\n\\r\\n  function handleClick() {\\r\\n    const nextShapes = shapes.map(shape =\u003e {\\r\\n      if (shape.type === 'square') {\\r\\n        // 不作改变\\r\\n        return shape;\\r\\n      } else {\\r\\n        // 返回一个新的圆形，位置在下方 50px 处\\r\\n        return {\\r\\n          ...shape,\\r\\n          y: shape.y + 50,\\r\\n        };\\r\\n      }\\r\\n    });\\r\\n    // 使用新的数组进行重渲染\\r\\n    setShapes(nextShapes);\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cbutton onClick={handleClick}\u003e\\r\\n        所有圆形向下移动！\\r\\n      \u003c/button\u003e\\r\\n      {shapes.map(shape =\u003e (\\r\\n        \u003cdiv\\r\\n          key={shape.id}\\r\\n          style={{\\r\\n          background: 'purple',\\r\\n          position: 'absolute',\\r\\n          left: shape.x,\\r\\n          top: shape.y,\\r\\n          borderRadius:\\r\\n            shape.type === 'circle'\\r\\n              ? '50%' : '',\\r\\n          width: 20,\\r\\n          height: 20,\\r\\n        }} /\u003e\\r\\n      ))}\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"body { height: 300px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"64\",{\"children\":[\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"replacing-items-in-an-array\",\"children\":\"替换数组中的元素 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"想要替换数组中一个或多个元素是非常常见的。类似 \",[\"$r\",\"code\",null,{\"children\":\"arr[0] = 'bird'\"}],\" 这样的赋值语句会直接修改原始数组，所以在这种情况下，你也应该使用 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\"。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"要替换一个元素，请使用 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\" 创建一个新数组。在你的 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\" 回调里，第二个参数是元素的索引。使用索引来判断最终是返回原始的元素（即回调的第一个参数）还是替换成其他值：\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nlet initialCounters = [\\r\\n  0, 0, 0\\r\\n];\\r\\n\\r\\nexport default function CounterList() {\\r\\n  const [counters, setCounters] = useState(\\r\\n    initialCounters\\r\\n  );\\r\\n\\r\\n  function handleIncrementClick(index) {\\r\\n    const nextCounters = counters.map((c, i) =\u003e {\\r\\n      if (i === index) {\\r\\n        // 递增被点击的计数器数值\\r\\n        return c + 1;\\r\\n      } else {\\r\\n        // 其余部分不发生变化\\r\\n        return c;\\r\\n      }\\r\\n    });\\r\\n    setCounters(nextCounters);\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {counters.map((counter, i) =\u003e (\\r\\n        \u003cli key={i}\u003e\\r\\n          {counter}\\r\\n          \u003cbutton onClick={() =\u003e {\\r\\n            handleIncrementClick(i);\\r\\n          }}\u003e+1\u003c/button\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"72\",{\"children\":[\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"inserting-into-an-array\",\"children\":\"向数组中插入元素 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"有时，你也许想向数组特定位置插入一个元素，这个位置既不在数组开头，也不在末尾。为此，你可以将数组展开运算符 \",[\"$r\",\"code\",null,{\"children\":\"...\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"slice()\"}],\" 方法一起使用。\",[\"$r\",\"code\",null,{\"children\":\"slice()\"}],\" 方法让你从数组中切出“一片”。为了将元素插入数组，你需要先展开原数组在插入点之前的切片，然后插入新元素，最后展开原数组中剩下的部分。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"下面的例子中，插入按钮总是会将元素插入到数组中索引为 \",[\"$r\",\"code\",null,{\"children\":\"1\"}],\" 的位置。\"]}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialArtists = [\\r\\n  { id: 0, name: 'Marta Colvin Andrade' },\\r\\n  { id: 1, name: 'Lamidi Olonade Fakeye'},\\r\\n  { id: 2, name: 'Louise Nevelson'},\\r\\n];\\r\\n\\r\\nexport default function List() {\\r\\n  const [name, setName] = useState('');\\r\\n  const [artists, setArtists] = useState(\\r\\n    initialArtists\\r\\n  );\\r\\n\\r\\n  function handleClick() {\\r\\n    const insertAt = 1; // 可能是任何索引\\r\\n    const nextArtists = [\\r\\n      // 插入点之前的元素：\\r\\n      ...artists.slice(0, insertAt),\\r\\n      // 新的元素：\\r\\n      { id: nextId++, name: name },\\r\\n      // 插入点之后的元素：\\r\\n      ...artists.slice(insertAt)\\r\\n    ];\\r\\n    setArtists(nextArtists);\\r\\n    setName('');\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003ch1\u003e振奋人心的雕塑家们：\u003c/h1\u003e\\r\\n      \u003cinput\\r\\n        value={name}\\r\\n        onChange={e =\u003e setName(e.target.value)}\\r\\n      /\u003e\\r\\n      \u003cbutton onClick={handleClick}\u003e\\r\\n        插入\\r\\n      \u003c/button\u003e\\r\\n      \u003cul\u003e\\r\\n        {artists.map(artist =\u003e (\\r\\n          \u003cli key={artist.id}\u003e{artist.name}\u003c/li\u003e\\r\\n        ))}\\r\\n      \u003c/ul\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin-left: 5px; }\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"82\",{\"children\":[\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"making-other-changes-to-an-array\",\"children\":\"其他改变数组的情况 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"总会有一些事，是你仅仅依靠展开运算符和 \",[\"$r\",\"code\",null,{\"children\":\"map()\"}],\" 或者 \",[\"$r\",\"code\",null,{\"children\":\"filter()\"}],\" 等不会直接修改原值的方法所无法做到的。例如，你可能想翻转数组，或是对数组排序。而 JavaScript 中的 \",[\"$r\",\"code\",null,{\"children\":\"reverse()\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"sort()\"}],\" 方法会改变原数组，所以你无法直接使用它们。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":\"然而，你可以先拷贝这个数组，再改变这个拷贝后的值。\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"例如：\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nconst initialList = [\\r\\n  { id: 0, title: 'Big Bellies' },\\r\\n  { id: 1, title: 'Lunar Landscape' },\\r\\n  { id: 2, title: 'Terracotta Army' },\\r\\n];\\r\\n\\r\\nexport default function List() {\\r\\n  const [list, setList] = useState(initialList);\\r\\n\\r\\n  function handleClick() {\\r\\n    const nextList = [...list];\\r\\n    nextList.reverse();\\r\\n    setList(nextList);\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cbutton onClick={handleClick}\u003e\\r\\n        翻转\\r\\n      \u003c/button\u003e\\r\\n      \u003cul\u003e\\r\\n        {list.map(artwork =\u003e (\\r\\n          \u003cli key={artwork.id}\u003e{artwork.title}\u003c/li\u003e\\r\\n        ))}\\r\\n      \u003c/ul\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}]}],[\"$r\",\"MaxWidth\",\"100\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"在这段代码中，你先使用 \",[\"$r\",\"code\",null,{\"children\":\"[...list]\"}],\" 展开运算符创建了一份数组的拷贝值。当你有了这个拷贝值后，你就可以使用像 \",[\"$r\",\"code\",null,{\"children\":\"nextList.reverse()\"}],\" 或 \",[\"$r\",\"code\",null,{\"children\":\"nextList.sort()\"}],\" 这样直接修改原数组的方法。你甚至可以通过 \",[\"$r\",\"code\",null,{\"children\":\"nextList[0] = \\\"something\\\"\"}],\" 这样的方式对数组中的特定元素进行赋值。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"然而，\",[\"$r\",\"strong\",null,{\"children\":\"即使你拷贝了数组，你还是不能直接修改其内部的元素\"}],\"。这是因为数组的拷贝是浅拷贝——新的数组中依然保留了与原始数组相同的元素。因此，如果你修改了拷贝数组内部的某个对象，其实你正在直接修改当前的 state。举个例子，像下面的代码就会带来问题。\"]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"const nextList = [...list];\\r\\nnextList[0].seen = true; // 问题：直接修改了 list[0] 的值\\r\\nsetList(nextList);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"虽然 \",[\"$r\",\"code\",null,{\"children\":\"nextList\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"list\"}],\" 是两个不同的数组，\",[\"$r\",\"strong\",null,{\"children\":[[\"$r\",\"code\",null,{\"children\":\"nextList[0]\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"list[0]\"}],\" 却指向了同一个对象\"]}],\"。因此，通过改变 \",[\"$r\",\"code\",null,{\"children\":\"nextList[0].seen\"}],\"，\",[\"$r\",\"code\",null,{\"children\":\"list[0].seen\"}],\" 的值也被改变了。这是一种 state 的 mutation 操作，你应该避免这么做！你可以用类似于 \",[\"$r\",\"a\",null,{\"href\":\"learn/updating-objects-in-state#updating-a-nested-object\",\"children\":\"更新嵌套的 JavaScript 对象\"}],\" 的方式解决这个问题——拷贝想要修改的特定元素，而不是直接修改它。下面是具体的操作。\"]}],\"\\n\",[\"$r\",\"h2\",null,{\"id\":\"updating-objects-inside-arrays\",\"children\":\"更新数组内部的对象 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"对象并不是 \",[\"$r\",\"em\",null,{\"children\":\"真的\"}],\" 位于数组“内部”。可能他们在代码中看起来像是在数组“内部”，但其实数组中的每个对象都是这个数组“指向”的一个存储于其它位置的值。这就是当你在处理类似 \",[\"$r\",\"code\",null,{\"children\":\"list[0]\"}],\" 这样的嵌套字段时需要格外小心的原因。其他人的艺术品清单可能指向了数组的同一个元素！\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[[\"$r\",\"strong\",null,{\"children\":\"当你更新一个嵌套的 state 时，你需要从想要更新的地方创建拷贝值，一直这样，直到顶层。\"}],\" 让我们看一下这该怎么做。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"在下面的例子中，两个不同的艺术品清单有着相同的初始 state。他们本应该互不影响，但是因为一次 mutation，他们的 state 被意外地共享了，勾选一个清单中的事项会影响另外一个清单：\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialList = [\\r\\n  { id: 0, title: 'Big Bellies', seen: false },\\r\\n  { id: 1, title: 'Lunar Landscape', seen: false },\\r\\n  { id: 2, title: 'Terracotta Army', seen: true },\\r\\n];\\r\\n\\r\\nexport default function BucketList() {\\r\\n  const [myList, setMyList] = useState(initialList);\\r\\n  const [yourList, setYourList] = useState(\\r\\n    initialList\\r\\n  );\\r\\n\\r\\n  function handleToggleMyList(artworkId, nextSeen) {\\r\\n    const myNextList = [...myList];\\r\\n    const artwork = myNextList.find(\\r\\n      a =\u003e a.id === artworkId\\r\\n    );\\r\\n    artwork.seen = nextSeen;\\r\\n    setMyList(myNextList);\\r\\n  }\\r\\n\\r\\n  function handleToggleYourList(artworkId, nextSeen) {\\r\\n    const yourNextList = [...yourList];\\r\\n    const artwork = yourNextList.find(\\r\\n      a =\u003e a.id === artworkId\\r\\n    );\\r\\n    artwork.seen = nextSeen;\\r\\n    setYourList(yourNextList);\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003ch1\u003e艺术愿望清单\u003c/h1\u003e\\r\\n      \u003ch2\u003e我想看的艺术清单：\u003c/h2\u003e\\r\\n      \u003cItemList\\r\\n        artworks={myList}\\r\\n        onToggle={handleToggleMyList} /\u003e\\r\\n      \u003ch2\u003e你想看的艺术清单：\u003c/h2\u003e\\r\\n      \u003cItemList\\r\\n        artworks={yourList}\\r\\n        onToggle={handleToggleYourList} /\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\r\\n\\r\\nfunction ItemList({ artworks, onToggle }) {\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {artworks.map(artwork =\u003e (\\r\\n        \u003cli key={artwork.id}\u003e\\r\\n          \u003clabel\u003e\\r\\n            \u003cinput\\r\\n              type=\\\"checkbox\\\"\\r\\n              checked={artwork.seen}\\r\\n              onChange={e =\u003e {\\r\\n                onToggle(\\r\\n                  artwork.id,\\r\\n                  e.target.checked\\r\\n                );\\r\\n              }}\\r\\n            /\u003e\\r\\n            {artwork.title}\\r\\n          \u003c/label\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\n\"}]}]}],[\"$r\",\"MaxWidth\",\"116\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":\"问题出在下面这段代码中:\"}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"const myNextList = [...myList];\\r\\nconst artwork = myNextList.find(a =\u003e a.id === artworkId);\\r\\nartwork.seen = nextSeen; // 问题：直接修改了已有的元素\\r\\nsetMyList(myNextList);\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"虽然 \",[\"$r\",\"code\",null,{\"children\":\"myNextList\"}],\" 这个数组是新的，但是其\",[\"$r\",\"strong\",null,{\"children\":\"内部的元素本身\"}],\"与原数组 \",[\"$r\",\"code\",null,{\"children\":\"myList\"}],\" 是相同的。因此，修改 \",[\"$r\",\"code\",null,{\"children\":\"artwork.seen\"}],\"，其实是在修改\",[\"$r\",\"strong\",null,{\"children\":\"原始的\"}],\" artwork 对象。而这个 artwork 对象也被 \",[\"$r\",\"code\",null,{\"children\":\"yourList\"}],\" 使用，这样就带来了 bug。这样的 bug 可能难以想到，但好在如果你避免直接修改 state，它们就会消失。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"$r\",\"strong\",null,{\"children\":[\"你可以使用 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\" 在没有 mutation 的前提下将一个旧的元素替换成更新的版本。\"]}]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"setMyList(myList.map(artwork =\u003e {\\r\\n  if (artwork.id === artworkId) {\\r\\n    // 创建包含变更的*新*对象\\r\\n    return { ...artwork, seen: nextSeen };\\r\\n  } else {\\r\\n    // 没有变更\\r\\n    return artwork;\\r\\n  }\\r\\n}));\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"此处的 \",[\"$r\",\"code\",null,{\"children\":\"...\"}],\" 是一个对象展开语法，被用来\",[\"$r\",\"a\",null,{\"href\":\"/learn/updating-objects-in-state#copying-objects-with-the-spread-syntax\",\"children\":\"创建一个对象的拷贝\"}],\".\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"通过这种方式，没有任何现有的 state 中的元素会被改变，bug 也就被修复了。\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialList = [\\r\\n  { id: 0, title: 'Big Bellies', seen: false },\\r\\n  { id: 1, title: 'Lunar Landscape', seen: false },\\r\\n  { id: 2, title: 'Terracotta Army', seen: true },\\r\\n];\\r\\n\\r\\nexport default function BucketList() {\\r\\n  const [myList, setMyList] = useState(initialList);\\r\\n  const [yourList, setYourList] = useState(\\r\\n    initialList\\r\\n  );\\r\\n\\r\\n  function handleToggleMyList(artworkId, nextSeen) {\\r\\n    setMyList(myList.map(artwork =\u003e {\\r\\n      if (artwork.id === artworkId) {\\r\\n        // 创建包含变更的*新*对象\\r\\n        return { ...artwork, seen: nextSeen };\\r\\n      } else {\\r\\n        // 没有变更\\r\\n        return artwork;\\r\\n      }\\r\\n    }));\\r\\n  }\\r\\n\\r\\n  function handleToggleYourList(artworkId, nextSeen) {\\r\\n    setYourList(yourList.map(artwork =\u003e {\\r\\n      if (artwork.id === artworkId) {\\r\\n        // 创建包含变更的*新*对象\\r\\n        return { ...artwork, seen: nextSeen };\\r\\n      } else {\\r\\n        // 没有变更\\r\\n        return artwork;\\r\\n      }\\r\\n    }));\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003ch1\u003e艺术愿望清单\u003c/h1\u003e\\r\\n      \u003ch2\u003e我想看的艺术清单：\u003c/h2\u003e\\r\\n      \u003cItemList\\r\\n        artworks={myList}\\r\\n        onToggle={handleToggleMyList} /\u003e\\r\\n      \u003ch2\u003e你想看的艺术清单：\u003c/h2\u003e\\r\\n      \u003cItemList\\r\\n        artworks={yourList}\\r\\n        onToggle={handleToggleYourList} /\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\r\\n\\r\\nfunction ItemList({ artworks, onToggle }) {\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {artworks.map(artwork =\u003e (\\r\\n        \u003cli key={artwork.id}\u003e\\r\\n          \u003clabel\u003e\\r\\n            \u003cinput\\r\\n              type=\\\"checkbox\\\"\\r\\n              checked={artwork.seen}\\r\\n              onChange={e =\u003e {\\r\\n                onToggle(\\r\\n                  artwork.id,\\r\\n                  e.target.checked\\r\\n                );\\r\\n              }}\\r\\n            /\u003e\\r\\n            {artwork.title}\\r\\n          \u003c/label\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\n\"}]}]}],[\"$r\",\"MaxWidth\",\"128\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"通常来讲，\",[\"$r\",\"strong\",null,{\"children\":\"你应该只直接修改你刚刚创建的对象\"}],\"。如果你正在插入一个\",[\"$r\",\"strong\",null,{\"children\":\"新\"}],\"的 artwork，你可以修改它，但是如果你想要改变的是 state 中已经存在的东西，你就需要先拷贝一份了。\"]}],\"\\n\",[\"$r\",\"h3\",null,{\"id\":\"write-concise-update-logic-with-immer\",\"children\":\"使用 Immer 编写简洁的更新逻辑 \"}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"在没有 mutation 的前提下更新嵌套数组可能会变得有点重复。\",[\"$r\",\"a\",null,{\"href\":\"/learn/updating-objects-in-state#write-concise-update-logic-with-immer\",\"children\":\"就像对对象一样\"}],\":\"]}],\"\\n\",[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"通常情况下，你应该不需要更新处于非常深层级的 state 。如果你有此类需求，你或许需要\",[\"$r\",\"a\",null,{\"href\":\"/learn/choosing-the-state-structure#avoid-deeply-nested-state\",\"children\":\"调整一下数据的结构\"}],\"，让数据变得扁平一些。\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"如果你不想改变 state 的数据结构，你也许会更喜欢使用 \",[\"$r\",\"a\",null,{\"href\":\"https://github.com/immerjs/use-immer\",\"target\":\"_blank\",\"rel\":\"nofollow noopener noreferrer\",\"children\":\"Immer\"}],\" ，它让你可以继续使用方便的，但会直接修改原值的语法，并负责为你生成拷贝值。\"]}],\"\\n\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":\"下面是我们用 Immer 来重写的艺术愿望清单的例子：\"}],\"\\n\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\nimport { useImmer } from 'use-immer';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialList = [\\r\\n  { id: 0, title: 'Big Bellies', seen: false },\\r\\n  { id: 1, title: 'Lunar Landscape', seen: false },\\r\\n  { id: 2, title: 'Terracotta Army', seen: true },\\r\\n];\\r\\n\\r\\nexport default function BucketList() {\\r\\n  const [myList, updateMyList] = useImmer(\\r\\n    initialList\\r\\n  );\\r\\n  const [yourList, updateYourList] = useImmer(\\r\\n    initialList\\r\\n  );\\r\\n\\r\\n  function handleToggleMyList(id, nextSeen) {\\r\\n    updateMyList(draft =\u003e {\\r\\n      const artwork = draft.find(a =\u003e\\r\\n        a.id === id\\r\\n      );\\r\\n      artwork.seen = nextSeen;\\r\\n    });\\r\\n  }\\r\\n\\r\\n  function handleToggleYourList(artworkId, nextSeen) {\\r\\n    updateYourList(draft =\u003e {\\r\\n      const artwork = draft.find(a =\u003e\\r\\n        a.id === artworkId\\r\\n      );\\r\\n      artwork.seen = nextSeen;\\r\\n    });\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003ch1\u003e艺术愿望清单\u003c/h1\u003e\\r\\n      \u003ch2\u003e我想看的艺术清单：\u003c/h2\u003e\\r\\n      \u003cItemList\\r\\n        artworks={myList}\\r\\n        onToggle={handleToggleMyList} /\u003e\\r\\n      \u003ch2\u003e你想看的艺术清单：\u003c/h2\u003e\\r\\n      \u003cItemList\\r\\n        artworks={yourList}\\r\\n        onToggle={handleToggleYourList} /\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\r\\n\\r\\nfunction ItemList({ artworks, onToggle }) {\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {artworks.map(artwork =\u003e (\\r\\n        \u003cli key={artwork.id}\u003e\\r\\n          \u003clabel\u003e\\r\\n            \u003cinput\\r\\n              type=\\\"checkbox\\\"\\r\\n              checked={artwork.seen}\\r\\n              onChange={e =\u003e {\\r\\n                onToggle(\\r\\n                  artwork.id,\\r\\n                  e.target.checked\\r\\n                );\\r\\n              }}\\r\\n            /\u003e\\r\\n            {artwork.title}\\r\\n          \u003c/label\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json\",\"children\":\"{\\r\\n  \\\"dependencies\\\": {\\r\\n    \\\"immer\\\": \\\"1.7.3\\\",\\r\\n    \\\"react\\\": \\\"latest\\\",\\r\\n    \\\"react-dom\\\": \\\"latest\\\",\\r\\n    \\\"react-scripts\\\": \\\"latest\\\",\\r\\n    \\\"use-immer\\\": \\\"0.5.1\\\"\\r\\n  },\\r\\n  \\\"scripts\\\": {\\r\\n    \\\"start\\\": \\\"react-scripts start\\\",\\r\\n    \\\"build\\\": \\\"react-scripts build\\\",\\r\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\r\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\r\\n  }\\r\\n}\\n\"}]}]]}],[\"$r\",\"MaxWidth\",\"140\",{\"children\":[\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"请注意当使用 Immer 时，\",[\"$r\",\"strong\",null,{\"children\":[\"类似 \",[\"$r\",\"code\",null,{\"children\":\"artwork.seen = nextSeen\"}],\" 这种会产生 mutation 的语法不会再有任何问题了：\"]}]]}],\"\\n\",[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"updateMyTodos(draft =\u003e {\\r\\n  const artwork = draft.find(a =\u003e a.id === artworkId);\\r\\n  artwork.seen = nextSeen;\\r\\n});\\n\"}]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"这是因为你并不是在直接修改原始的 state，而是在修改 Immer 提供的一个特殊的 \",[\"$r\",\"code\",null,{\"children\":\"draft\"}],\" 对象。同理，你也可以为 \",[\"$r\",\"code\",null,{\"children\":\"draft\"}],\" 的内容使用 \",[\"$r\",\"code\",null,{\"children\":\"push()\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"pop()\"}],\" 这些会直接修改原值的方法。\"]}],\"\\n\",[\"$r\",\"p\",null,{\"children\":[\"在幕后，Immer 总是会根据你对 \",[\"$r\",\"code\",null,{\"children\":\"draft\"}],\" 的修改来从头开始构建下一个 state。这使得你的事件处理程序非常的简洁，同时也不会直接修改 state。\"]}],\"\\n\",[\"$r\",\"Recap\",null,{\"children\":[\"$r\",\"ul\",null,{\"children\":[\"\\n\",[\"$r\",\"li\",null,{\"children\":\"你可以把数组放入 state 中，但你不应该直接修改它。\"}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"不要直接修改数组，而是创建它的一份 \",[\"$r\",\"strong\",null,{\"children\":\"新的\"}],\" 拷贝，然后使用新的数组来更新它的状态。\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"你可以使用 \",[\"$r\",\"code\",null,{\"children\":\"[...arr, newItem]\"}],\" 这样的数组展开语法来向数组中添加元素。\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":[\"你可以使用 \",[\"$r\",\"code\",null,{\"children\":\"filter()\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"map()\"}],\" 来创建一个经过过滤或者变换的数组。\"]}],\"\\n\",[\"$r\",\"li\",null,{\"children\":\"你可以使用 Immer 来保持代码简洁。\"}],\"\\n\"]}]}],\"\\n\"]}],[\"$r\",\"Challenges\",null,{\"children\":[[\"$r\",\"h4\",null,{\"id\":\"update-an-item-in-the-shopping-cart\",\"children\":\"更新购物车中的商品 \"}],[\"$r\",\"p\",null,{\"children\":[\"填写 \",[\"$r\",\"code\",null,{\"children\":\"handleIncreaseClick\"}],\" 的逻辑，以便按下“+”时递增对应数字：\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nconst initialProducts = [{\\r\\n  id: 0,\\r\\n  name: 'Baklava',\\r\\n  count: 1,\\r\\n}, {\\r\\n  id: 1,\\r\\n  name: 'Cheese',\\r\\n  count: 5,\\r\\n}, {\\r\\n  id: 2,\\r\\n  name: 'Spaghetti',\\r\\n  count: 2,\\r\\n}];\\r\\n\\r\\nexport default function ShoppingCart() {\\r\\n  const [\\r\\n    products,\\r\\n    setProducts\\r\\n  ] = useState(initialProducts)\\r\\n\\r\\n  function handleIncreaseClick(productId) {\\r\\n\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {products.map(product =\u003e (\\r\\n        \u003cli key={product.id}\u003e\\r\\n          {product.name}\\r\\n          {' '}\\r\\n          (\u003cb\u003e{product.count}\u003c/b\u003e)\\r\\n          \u003cbutton onClick={() =\u003e {\\r\\n            handleIncreaseClick(product.id);\\r\\n          }}\u003e\\r\\n            +\\r\\n          \u003c/button\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"你可以使用 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\" 函数创建一个新数组，然后使用 \",[\"$r\",\"code\",null,{\"children\":\"...\"}],\" 对象展开语法为新数组创建一个变更后对象的拷贝值：\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nconst initialProducts = [{\\r\\n  id: 0,\\r\\n  name: 'Baklava',\\r\\n  count: 1,\\r\\n}, {\\r\\n  id: 1,\\r\\n  name: 'Cheese',\\r\\n  count: 5,\\r\\n}, {\\r\\n  id: 2,\\r\\n  name: 'Spaghetti',\\r\\n  count: 2,\\r\\n}];\\r\\n\\r\\nexport default function ShoppingCart() {\\r\\n  const [\\r\\n    products,\\r\\n    setProducts\\r\\n  ] = useState(initialProducts)\\r\\n\\r\\n  function handleIncreaseClick(productId) {\\r\\n    setProducts(products.map(product =\u003e {\\r\\n      if (product.id === productId) {\\r\\n        return {\\r\\n          ...product,\\r\\n          count: product.count + 1\\r\\n        };\\r\\n      } else {\\r\\n        return product;\\r\\n      }\\r\\n    }))\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {products.map(product =\u003e (\\r\\n        \u003cli key={product.id}\u003e\\r\\n          {product.name}\\r\\n          {' '}\\r\\n          (\u003cb\u003e{product.count}\u003c/b\u003e)\\r\\n          \u003cbutton onClick={() =\u003e {\\r\\n            handleIncreaseClick(product.id);\\r\\n          }}\u003e\\r\\n            +\\r\\n          \u003c/button\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\n\"}]}]]}]]}],[\"$r\",\"h4\",null,{\"id\":\"remove-an-item-from-the-shopping-cart\",\"children\":\"删除购物车中的商品 \"}],[\"$r\",\"p\",null,{\"children\":[\"现在购物车有了一个正常工作的“+”按钮，但是“-”按钮却没有任何作用。你需要为它添加一个事件处理程序，以便按下它时可以减少对应商品的 \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\"。如果在数字为 1 时按下按钮，商品需要自动从购物车中移除。确保商品计数永远不出现 0。\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nconst initialProducts = [{\\r\\n  id: 0,\\r\\n  name: 'Baklava',\\r\\n  count: 1,\\r\\n}, {\\r\\n  id: 1,\\r\\n  name: 'Cheese',\\r\\n  count: 5,\\r\\n}, {\\r\\n  id: 2,\\r\\n  name: 'Spaghetti',\\r\\n  count: 2,\\r\\n}];\\r\\n\\r\\nexport default function ShoppingCart() {\\r\\n  const [\\r\\n    products,\\r\\n    setProducts\\r\\n  ] = useState(initialProducts)\\r\\n\\r\\n  function handleIncreaseClick(productId) {\\r\\n    setProducts(products.map(product =\u003e {\\r\\n      if (product.id === productId) {\\r\\n        return {\\r\\n          ...product,\\r\\n          count: product.count + 1\\r\\n        };\\r\\n      } else {\\r\\n        return product;\\r\\n      }\\r\\n    }))\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {products.map(product =\u003e (\\r\\n        \u003cli key={product.id}\u003e\\r\\n          {product.name}\\r\\n          {' '}\\r\\n          (\u003cb\u003e{product.count}\u003c/b\u003e)\\r\\n          \u003cbutton onClick={() =\u003e {\\r\\n            handleIncreaseClick(product.id);\\r\\n          }}\u003e\\r\\n            +\\r\\n          \u003c/button\u003e\\r\\n          \u003cbutton\u003e\\r\\n            –\\r\\n          \u003c/button\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"你可以先使用 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\" 生成一个新数组，然后使用 \",[\"$r\",\"code\",null,{\"children\":\"filter\"}],\" 移除 \",[\"$r\",\"code\",null,{\"children\":\"count\"}],\" 被设置为 \",[\"$r\",\"code\",null,{\"children\":\"0\"}],\" 的商品：\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nconst initialProducts = [{\\r\\n  id: 0,\\r\\n  name: 'Baklava',\\r\\n  count: 1,\\r\\n}, {\\r\\n  id: 1,\\r\\n  name: 'Cheese',\\r\\n  count: 5,\\r\\n}, {\\r\\n  id: 2,\\r\\n  name: 'Spaghetti',\\r\\n  count: 2,\\r\\n}];\\r\\n\\r\\nexport default function ShoppingCart() {\\r\\n  const [\\r\\n    products,\\r\\n    setProducts\\r\\n  ] = useState(initialProducts)\\r\\n\\r\\n  function handleIncreaseClick(productId) {\\r\\n    setProducts(products.map(product =\u003e {\\r\\n      if (product.id === productId) {\\r\\n        return {\\r\\n          ...product,\\r\\n          count: product.count + 1\\r\\n        };\\r\\n      } else {\\r\\n        return product;\\r\\n      }\\r\\n    }))\\r\\n  }\\r\\n\\r\\n  function handleDecreaseClick(productId) {\\r\\n    let nextProducts = products.map(product =\u003e {\\r\\n      if (product.id === productId) {\\r\\n        return {\\r\\n          ...product,\\r\\n          count: product.count - 1\\r\\n        };\\r\\n      } else {\\r\\n        return product;\\r\\n      }\\r\\n    });\\r\\n    nextProducts = nextProducts.filter(p =\u003e\\r\\n      p.count \u003e 0\\r\\n    );\\r\\n    setProducts(nextProducts)\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {products.map(product =\u003e (\\r\\n        \u003cli key={product.id}\u003e\\r\\n          {product.name}\\r\\n          {' '}\\r\\n          (\u003cb\u003e{product.count}\u003c/b\u003e)\\r\\n          \u003cbutton onClick={() =\u003e {\\r\\n            handleIncreaseClick(product.id);\\r\\n          }}\u003e\\r\\n            +\\r\\n          \u003c/button\u003e\\r\\n          \u003cbutton onClick={() =\u003e {\\r\\n            handleDecreaseClick(product.id);\\r\\n          }}\u003e\\r\\n            –\\r\\n          \u003c/button\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\n\"}]}]]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-the-mutations-using-non-mutative-methods\",\"children\":\"使用不会直接修改原始值的方法修复 mutation 的问题 \"}],[\"$r\",\"p\",null,{\"children\":[\"在下面的例子中，\",[\"$r\",\"code\",null,{\"children\":\"App.js\"}],\" 中所有的事件处理程序都会产生 mutation。这导致编辑和删除待办事项的功能无法正常运行。使用不会直接修改原始值的方法重写 \",[\"$r\",\"code\",null,{\"children\":\"handleAddTodo\"}],\"、\",[\"$r\",\"code\",null,{\"children\":\"handleChangeTodo\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"handleDeleteTodo\"}],\" 这三个函数：\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\r\\nimport AddTodo from './AddTodo.js';\\r\\nimport TaskList from './TaskList.js';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialTodos = [\\r\\n  { id: 0, title: 'Buy milk', done: true },\\r\\n  { id: 1, title: 'Eat tacos', done: false },\\r\\n  { id: 2, title: 'Brew tea', done: false },\\r\\n];\\r\\n\\r\\nexport default function TaskApp() {\\r\\n  const [todos, setTodos] = useState(\\r\\n    initialTodos\\r\\n  );\\r\\n\\r\\n  function handleAddTodo(title) {\\r\\n    todos.push({\\r\\n      id: nextId++,\\r\\n      title: title,\\r\\n      done: false\\r\\n    });\\r\\n  }\\r\\n\\r\\n  function handleChangeTodo(nextTodo) {\\r\\n    const todo = todos.find(t =\u003e\\r\\n      t.id === nextTodo.id\\r\\n    );\\r\\n    todo.title = nextTodo.title;\\r\\n    todo.done = nextTodo.done;\\r\\n  }\\r\\n\\r\\n  function handleDeleteTodo(todoId) {\\r\\n    const index = todos.findIndex(t =\u003e\\r\\n      t.id === todoId\\r\\n    );\\r\\n    todos.splice(index, 1);\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cAddTodo\\r\\n        onAddTodo={handleAddTodo}\\r\\n      /\u003e\\r\\n      \u003cTaskList\\r\\n        todos={todos}\\r\\n        onChangeTodo={handleChangeTodo}\\r\\n        onDeleteTodo={handleDeleteTodo}\\r\\n      /\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/AddTodo.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function AddTodo({ onAddTodo }) {\\r\\n  const [title, setTitle] = useState('');\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cinput\\r\\n        placeholder=\\\"Add todo\\\"\\r\\n        value={title}\\r\\n        onChange={e =\u003e setTitle(e.target.value)}\\r\\n      /\u003e\\r\\n      \u003cbutton onClick={() =\u003e {\\r\\n        setTitle('');\\r\\n        onAddTodo(title);\\r\\n      }}\u003e添加\u003c/button\u003e\\r\\n    \u003c/\u003e\\r\\n  )\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/TaskList.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function TaskList({\\r\\n  todos,\\r\\n  onChangeTodo,\\r\\n  onDeleteTodo\\r\\n}) {\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {todos.map(todo =\u003e (\\r\\n        \u003cli key={todo.id}\u003e\\r\\n          \u003cTask\\r\\n            todo={todo}\\r\\n            onChange={onChangeTodo}\\r\\n            onDelete={onDeleteTodo}\\r\\n          /\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\r\\n\\r\\nfunction Task({ todo, onChange, onDelete }) {\\r\\n  const [isEditing, setIsEditing] = useState(false);\\r\\n  let todoContent;\\r\\n  if (isEditing) {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        \u003cinput\\r\\n          value={todo.title}\\r\\n          onChange={e =\u003e {\\r\\n            onChange({\\r\\n              ...todo,\\r\\n              title: e.target.value\\r\\n            });\\r\\n          }} /\u003e\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(false)}\u003e\\r\\n          保存\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  } else {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        {todo.title}\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(true)}\u003e\\r\\n          编辑\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  }\\r\\n  return (\\r\\n    \u003clabel\u003e\\r\\n      \u003cinput\\r\\n        type=\\\"checkbox\\\"\\r\\n        checked={todo.done}\\r\\n        onChange={e =\u003e {\\r\\n          onChange({\\r\\n            ...todo,\\r\\n            done: e.target.checked\\r\\n          });\\r\\n        }}\\r\\n      /\u003e\\r\\n      {todoContent}\\r\\n      \u003cbutton onClick={() =\u003e onDelete(todo.id)}\u003e\\r\\n        删除\\r\\n      \u003c/button\u003e\\r\\n    \u003c/label\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\r\\nli { list-style-type: none; }\\r\\nul, li { margin: 0; padding: 0; }\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"在 \",[\"$r\",\"code\",null,{\"children\":\"handleAddTodo\"}],\" 中，你可以使用数组展开语法；在 \",[\"$r\",\"code\",null,{\"children\":\"handleChangeTodo\"}],\" 中，你可以使用 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\" 创建一个新数组；在 \",[\"$r\",\"code\",null,{\"children\":\"handleDeleteTodo\"}],\" 中，你可以使用 \",[\"$r\",\"code\",null,{\"children\":\"filter\"}],\" 创建一个新数组。现在列表可以正常工作了：\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\r\\nimport AddTodo from './AddTodo.js';\\r\\nimport TaskList from './TaskList.js';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialTodos = [\\r\\n  { id: 0, title: 'Buy milk', done: true },\\r\\n  { id: 1, title: 'Eat tacos', done: false },\\r\\n  { id: 2, title: 'Brew tea', done: false },\\r\\n];\\r\\n\\r\\nexport default function TaskApp() {\\r\\n  const [todos, setTodos] = useState(\\r\\n    initialTodos\\r\\n  );\\r\\n\\r\\n  function handleAddTodo(title) {\\r\\n    setTodos([\\r\\n      ...todos,\\r\\n      {\\r\\n        id: nextId++,\\r\\n        title: title,\\r\\n        done: false\\r\\n      }\\r\\n    ]);\\r\\n  }\\r\\n\\r\\n  function handleChangeTodo(nextTodo) {\\r\\n    setTodos(todos.map(t =\u003e {\\r\\n      if (t.id === nextTodo.id) {\\r\\n        return nextTodo;\\r\\n      } else {\\r\\n        return t;\\r\\n      }\\r\\n    }));\\r\\n  }\\r\\n\\r\\n  function handleDeleteTodo(todoId) {\\r\\n    setTodos(\\r\\n      todos.filter(t =\u003e t.id !== todoId)\\r\\n    );\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cAddTodo\\r\\n        onAddTodo={handleAddTodo}\\r\\n      /\u003e\\r\\n      \u003cTaskList\\r\\n        todos={todos}\\r\\n        onChangeTodo={handleChangeTodo}\\r\\n        onDeleteTodo={handleDeleteTodo}\\r\\n      /\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/AddTodo.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function AddTodo({ onAddTodo }) {\\r\\n  const [title, setTitle] = useState('');\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cinput\\r\\n        placeholder=\\\"Add todo\\\"\\r\\n        value={title}\\r\\n        onChange={e =\u003e setTitle(e.target.value)}\\r\\n      /\u003e\\r\\n      \u003cbutton onClick={() =\u003e {\\r\\n        setTitle('');\\r\\n        onAddTodo(title);\\r\\n      }}\u003e添加\u003c/button\u003e\\r\\n    \u003c/\u003e\\r\\n  )\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/TaskList.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function TaskList({\\r\\n  todos,\\r\\n  onChangeTodo,\\r\\n  onDeleteTodo\\r\\n}) {\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {todos.map(todo =\u003e (\\r\\n        \u003cli key={todo.id}\u003e\\r\\n          \u003cTask\\r\\n            todo={todo}\\r\\n            onChange={onChangeTodo}\\r\\n            onDelete={onDeleteTodo}\\r\\n          /\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\r\\n\\r\\nfunction Task({ todo, onChange, onDelete }) {\\r\\n  const [isEditing, setIsEditing] = useState(false);\\r\\n  let todoContent;\\r\\n  if (isEditing) {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        \u003cinput\\r\\n          value={todo.title}\\r\\n          onChange={e =\u003e {\\r\\n            onChange({\\r\\n              ...todo,\\r\\n              title: e.target.value\\r\\n            });\\r\\n          }} /\u003e\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(false)}\u003e\\r\\n          保存\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  } else {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        {todo.title}\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(true)}\u003e\\r\\n          编辑\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  }\\r\\n  return (\\r\\n    \u003clabel\u003e\\r\\n      \u003cinput\\r\\n        type=\\\"checkbox\\\"\\r\\n        checked={todo.done}\\r\\n        onChange={e =\u003e {\\r\\n          onChange({\\r\\n            ...todo,\\r\\n            done: e.target.checked\\r\\n          });\\r\\n        }}\\r\\n      /\u003e\\r\\n      {todoContent}\\r\\n      \u003cbutton onClick={() =\u003e onDelete(todo.id)}\u003e\\r\\n        删除\\r\\n      \u003c/button\u003e\\r\\n    \u003c/label\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\r\\nli { list-style-type: none; }\\r\\nul, li { margin: 0; padding: 0; }\\n\"}]}]]}]]}],[\"$r\",\"h4\",null,{\"id\":\"fix-the-mutations-using-immer\",\"children\":\"使用 Immer 修复 mutation 的问题 \"}],[\"$r\",\"p\",null,{\"children\":[\"下面的例子和上一个挑战的相同。这次，你需要使用 Immer 来修复 mutation 的问题。为了方便，\",[\"$r\",\"code\",null,{\"children\":\"useImmer\"}],\" 已经被引入了，你需要使用它来替换 \",[\"$r\",\"code\",null,{\"children\":\"todos\"}],\" 的 state 变量。\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\r\\nimport { useImmer } from 'use-immer';\\r\\nimport AddTodo from './AddTodo.js';\\r\\nimport TaskList from './TaskList.js';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialTodos = [\\r\\n  { id: 0, title: 'Buy milk', done: true },\\r\\n  { id: 1, title: 'Eat tacos', done: false },\\r\\n  { id: 2, title: 'Brew tea', done: false },\\r\\n];\\r\\n\\r\\nexport default function TaskApp() {\\r\\n  const [todos, setTodos] = useState(\\r\\n    initialTodos\\r\\n  );\\r\\n\\r\\n  function handleAddTodo(title) {\\r\\n    todos.push({\\r\\n      id: nextId++,\\r\\n      title: title,\\r\\n      done: false\\r\\n    });\\r\\n  }\\r\\n\\r\\n  function handleChangeTodo(nextTodo) {\\r\\n    const todo = todos.find(t =\u003e\\r\\n      t.id === nextTodo.id\\r\\n    );\\r\\n    todo.title = nextTodo.title;\\r\\n    todo.done = nextTodo.done;\\r\\n  }\\r\\n\\r\\n  function handleDeleteTodo(todoId) {\\r\\n    const index = todos.findIndex(t =\u003e\\r\\n      t.id === todoId\\r\\n    );\\r\\n    todos.splice(index, 1);\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cAddTodo\\r\\n        onAddTodo={handleAddTodo}\\r\\n      /\u003e\\r\\n      \u003cTaskList\\r\\n        todos={todos}\\r\\n        onChangeTodo={handleChangeTodo}\\r\\n        onDeleteTodo={handleDeleteTodo}\\r\\n      /\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/AddTodo.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function AddTodo({ onAddTodo }) {\\r\\n  const [title, setTitle] = useState('');\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cinput\\r\\n        placeholder=\\\"Add todo\\\"\\r\\n        value={title}\\r\\n        onChange={e =\u003e setTitle(e.target.value)}\\r\\n      /\u003e\\r\\n      \u003cbutton onClick={() =\u003e {\\r\\n        setTitle('');\\r\\n        onAddTodo(title);\\r\\n      }}\u003e添加\u003c/button\u003e\\r\\n    \u003c/\u003e\\r\\n  )\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/TaskList.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function TaskList({\\r\\n  todos,\\r\\n  onChangeTodo,\\r\\n  onDeleteTodo\\r\\n}) {\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {todos.map(todo =\u003e (\\r\\n        \u003cli key={todo.id}\u003e\\r\\n          \u003cTask\\r\\n            todo={todo}\\r\\n            onChange={onChangeTodo}\\r\\n            onDelete={onDeleteTodo}\\r\\n          /\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\r\\n\\r\\nfunction Task({ todo, onChange, onDelete }) {\\r\\n  const [isEditing, setIsEditing] = useState(false);\\r\\n  let todoContent;\\r\\n  if (isEditing) {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        \u003cinput\\r\\n          value={todo.title}\\r\\n          onChange={e =\u003e {\\r\\n            onChange({\\r\\n              ...todo,\\r\\n              title: e.target.value\\r\\n            });\\r\\n          }} /\u003e\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(false)}\u003e\\r\\n          保存\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  } else {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        {todo.title}\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(true)}\u003e\\r\\n          编辑\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  }\\r\\n  return (\\r\\n    \u003clabel\u003e\\r\\n      \u003cinput\\r\\n        type=\\\"checkbox\\\"\\r\\n        checked={todo.done}\\r\\n        onChange={e =\u003e {\\r\\n          onChange({\\r\\n            ...todo,\\r\\n            done: e.target.checked\\r\\n          });\\r\\n        }}\\r\\n      /\u003e\\r\\n      {todoContent}\\r\\n      \u003cbutton onClick={() =\u003e onDelete(todo.id)}\u003e\\r\\n        删除\\r\\n      \u003c/button\u003e\\r\\n    \u003c/label\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\r\\nli { list-style-type: none; }\\r\\nul, li { margin: 0; padding: 0; }\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json\",\"children\":\"{\\r\\n  \\\"dependencies\\\": {\\r\\n    \\\"immer\\\": \\\"1.7.3\\\",\\r\\n    \\\"react\\\": \\\"latest\\\",\\r\\n    \\\"react-dom\\\": \\\"latest\\\",\\r\\n    \\\"react-scripts\\\": \\\"latest\\\",\\r\\n    \\\"use-immer\\\": \\\"0.5.1\\\"\\r\\n  },\\r\\n  \\\"scripts\\\": {\\r\\n    \\\"start\\\": \\\"react-scripts start\\\",\\r\\n    \\\"build\\\": \\\"react-scripts build\\\",\\r\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\r\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\r\\n  }\\r\\n}\\n\"}]}]]}],[\"$r\",\"Solution\",null,{\"children\":[[\"$r\",\"p\",null,{\"children\":[\"通过使用 Immer，只要你仅仅直接修改 Immer 提供给你的 \",[\"$r\",\"code\",null,{\"children\":\"draft\"}],\" 的一部分，你就可以以 mutation 的方式写代码。这里所有的 mutation 都在 \",[\"$r\",\"code\",null,{\"children\":\"draft\"}],\" 上执行，因此代码可以正常运行：\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\r\\nimport { useImmer } from 'use-immer';\\r\\nimport AddTodo from './AddTodo.js';\\r\\nimport TaskList from './TaskList.js';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialTodos = [\\r\\n  { id: 0, title: 'Buy milk', done: true },\\r\\n  { id: 1, title: 'Eat tacos', done: false },\\r\\n  { id: 2, title: 'Brew tea', done: false },\\r\\n];\\r\\n\\r\\nexport default function TaskApp() {\\r\\n  const [todos, updateTodos] = useImmer(\\r\\n    initialTodos\\r\\n  );\\r\\n\\r\\n  function handleAddTodo(title) {\\r\\n    updateTodos(draft =\u003e {\\r\\n      draft.push({\\r\\n        id: nextId++,\\r\\n        title: title,\\r\\n        done: false\\r\\n      });\\r\\n    });\\r\\n  }\\r\\n\\r\\n  function handleChangeTodo(nextTodo) {\\r\\n    updateTodos(draft =\u003e {\\r\\n      const todo = draft.find(t =\u003e\\r\\n        t.id === nextTodo.id\\r\\n      );\\r\\n      todo.title = nextTodo.title;\\r\\n      todo.done = nextTodo.done;\\r\\n    });\\r\\n  }\\r\\n\\r\\n  function handleDeleteTodo(todoId) {\\r\\n    updateTodos(draft =\u003e {\\r\\n      const index = draft.findIndex(t =\u003e\\r\\n        t.id === todoId\\r\\n      );\\r\\n      draft.splice(index, 1);\\r\\n    });\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cAddTodo\\r\\n        onAddTodo={handleAddTodo}\\r\\n      /\u003e\\r\\n      \u003cTaskList\\r\\n        todos={todos}\\r\\n        onChangeTodo={handleChangeTodo}\\r\\n        onDeleteTodo={handleDeleteTodo}\\r\\n      /\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/AddTodo.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function AddTodo({ onAddTodo }) {\\r\\n  const [title, setTitle] = useState('');\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cinput\\r\\n        placeholder=\\\"Add todo\\\"\\r\\n        value={title}\\r\\n        onChange={e =\u003e setTitle(e.target.value)}\\r\\n      /\u003e\\r\\n      \u003cbutton onClick={() =\u003e {\\r\\n        setTitle('');\\r\\n        onAddTodo(title);\\r\\n      }}\u003e添加\u003c/button\u003e\\r\\n    \u003c/\u003e\\r\\n  )\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/TaskList.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function TaskList({\\r\\n  todos,\\r\\n  onChangeTodo,\\r\\n  onDeleteTodo\\r\\n}) {\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {todos.map(todo =\u003e (\\r\\n        \u003cli key={todo.id}\u003e\\r\\n          \u003cTask\\r\\n            todo={todo}\\r\\n            onChange={onChangeTodo}\\r\\n            onDelete={onDeleteTodo}\\r\\n          /\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\r\\n\\r\\nfunction Task({ todo, onChange, onDelete }) {\\r\\n  const [isEditing, setIsEditing] = useState(false);\\r\\n  let todoContent;\\r\\n  if (isEditing) {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        \u003cinput\\r\\n          value={todo.title}\\r\\n          onChange={e =\u003e {\\r\\n            onChange({\\r\\n              ...todo,\\r\\n              title: e.target.value\\r\\n            });\\r\\n          }} /\u003e\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(false)}\u003e\\r\\n          保存\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  } else {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        {todo.title}\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(true)}\u003e\\r\\n          编辑\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  }\\r\\n  return (\\r\\n    \u003clabel\u003e\\r\\n      \u003cinput\\r\\n        type=\\\"checkbox\\\"\\r\\n        checked={todo.done}\\r\\n        onChange={e =\u003e {\\r\\n          onChange({\\r\\n            ...todo,\\r\\n            done: e.target.checked\\r\\n          });\\r\\n        }}\\r\\n      /\u003e\\r\\n      {todoContent}\\r\\n      \u003cbutton onClick={() =\u003e onDelete(todo.id)}\u003e\\r\\n        删除\\r\\n      \u003c/button\u003e\\r\\n    \u003c/label\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\r\\nli { list-style-type: none; }\\r\\nul, li { margin: 0; padding: 0; }\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json\",\"children\":\"{\\r\\n  \\\"dependencies\\\": {\\r\\n    \\\"immer\\\": \\\"1.7.3\\\",\\r\\n    \\\"react\\\": \\\"latest\\\",\\r\\n    \\\"react-dom\\\": \\\"latest\\\",\\r\\n    \\\"react-scripts\\\": \\\"latest\\\",\\r\\n    \\\"use-immer\\\": \\\"0.5.1\\\"\\r\\n  },\\r\\n  \\\"scripts\\\": {\\r\\n    \\\"start\\\": \\\"react-scripts start\\\",\\r\\n    \\\"build\\\": \\\"react-scripts build\\\",\\r\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\r\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\r\\n  }\\r\\n}\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":\"你还可以在 Immer 中混合使用会改变和不会改变原始值的方法。\"}],[\"$r\",\"p\",null,{\"children\":[\"例如，在下面的代码中，\",[\"$r\",\"code\",null,{\"children\":\"handleAddTodo\"}],\"是通过直接修改 Immer 的 \",[\"$r\",\"code\",null,{\"children\":\"draft\"}],\" 实现的，而 \",[\"$r\",\"code\",null,{\"children\":\"handleChangeTodo\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"handleDeleteTodo\"}],\" 则使用了不会直接修改原始值的 \",[\"$r\",\"code\",null,{\"children\":\"map\"}],\" 和 \",[\"$r\",\"code\",null,{\"children\":\"filter\"}],\" 方法：\"]}],[\"$r\",\"Sandpack\",null,{\"children\":[[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/App.js\",\"children\":\"import { useState } from 'react';\\r\\nimport { useImmer } from 'use-immer';\\r\\nimport AddTodo from './AddTodo.js';\\r\\nimport TaskList from './TaskList.js';\\r\\n\\r\\nlet nextId = 3;\\r\\nconst initialTodos = [\\r\\n  { id: 0, title: 'Buy milk', done: true },\\r\\n  { id: 1, title: 'Eat tacos', done: false },\\r\\n  { id: 2, title: 'Brew tea', done: false },\\r\\n];\\r\\n\\r\\nexport default function TaskApp() {\\r\\n  const [todos, updateTodos] = useImmer(\\r\\n    initialTodos\\r\\n  );\\r\\n\\r\\n  function handleAddTodo(title) {\\r\\n    updateTodos(draft =\u003e {\\r\\n      draft.push({\\r\\n        id: nextId++,\\r\\n        title: title,\\r\\n        done: false\\r\\n      });\\r\\n    });\\r\\n  }\\r\\n\\r\\n  function handleChangeTodo(nextTodo) {\\r\\n    updateTodos(todos.map(todo =\u003e {\\r\\n      if (todo.id === nextTodo.id) {\\r\\n        return nextTodo;\\r\\n      } else {\\r\\n        return todo;\\r\\n      }\\r\\n    }));\\r\\n  }\\r\\n\\r\\n  function handleDeleteTodo(todoId) {\\r\\n    updateTodos(\\r\\n      todos.filter(t =\u003e t.id !== todoId)\\r\\n    );\\r\\n  }\\r\\n\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cAddTodo\\r\\n        onAddTodo={handleAddTodo}\\r\\n      /\u003e\\r\\n      \u003cTaskList\\r\\n        todos={todos}\\r\\n        onChangeTodo={handleChangeTodo}\\r\\n        onDeleteTodo={handleDeleteTodo}\\r\\n      /\u003e\\r\\n    \u003c/\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/AddTodo.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function AddTodo({ onAddTodo }) {\\r\\n  const [title, setTitle] = useState('');\\r\\n  return (\\r\\n    \u003c\u003e\\r\\n      \u003cinput\\r\\n        placeholder=\\\"Add todo\\\"\\r\\n        value={title}\\r\\n        onChange={e =\u003e setTitle(e.target.value)}\\r\\n      /\u003e\\r\\n      \u003cbutton onClick={() =\u003e {\\r\\n        setTitle('');\\r\\n        onAddTodo(title);\\r\\n      }}\u003e添加\u003c/button\u003e\\r\\n    \u003c/\u003e\\r\\n  )\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-js\",\"meta\":\"src/TaskList.js\",\"children\":\"import { useState } from 'react';\\r\\n\\r\\nexport default function TaskList({\\r\\n  todos,\\r\\n  onChangeTodo,\\r\\n  onDeleteTodo\\r\\n}) {\\r\\n  return (\\r\\n    \u003cul\u003e\\r\\n      {todos.map(todo =\u003e (\\r\\n        \u003cli key={todo.id}\u003e\\r\\n          \u003cTask\\r\\n            todo={todo}\\r\\n            onChange={onChangeTodo}\\r\\n            onDelete={onDeleteTodo}\\r\\n          /\u003e\\r\\n        \u003c/li\u003e\\r\\n      ))}\\r\\n    \u003c/ul\u003e\\r\\n  );\\r\\n}\\r\\n\\r\\nfunction Task({ todo, onChange, onDelete }) {\\r\\n  const [isEditing, setIsEditing] = useState(false);\\r\\n  let todoContent;\\r\\n  if (isEditing) {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        \u003cinput\\r\\n          value={todo.title}\\r\\n          onChange={e =\u003e {\\r\\n            onChange({\\r\\n              ...todo,\\r\\n              title: e.target.value\\r\\n            });\\r\\n          }} /\u003e\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(false)}\u003e\\r\\n          保存\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  } else {\\r\\n    todoContent = (\\r\\n      \u003c\u003e\\r\\n        {todo.title}\\r\\n        \u003cbutton onClick={() =\u003e setIsEditing(true)}\u003e\\r\\n          编辑\\r\\n        \u003c/button\u003e\\r\\n      \u003c/\u003e\\r\\n    );\\r\\n  }\\r\\n  return (\\r\\n    \u003clabel\u003e\\r\\n      \u003cinput\\r\\n        type=\\\"checkbox\\\"\\r\\n        checked={todo.done}\\r\\n        onChange={e =\u003e {\\r\\n          onChange({\\r\\n            ...todo,\\r\\n            done: e.target.checked\\r\\n          });\\r\\n        }}\\r\\n      /\u003e\\r\\n      {todoContent}\\r\\n      \u003cbutton onClick={() =\u003e onDelete(todo.id)}\u003e\\r\\n        删除\\r\\n      \u003c/button\u003e\\r\\n    \u003c/label\u003e\\r\\n  );\\r\\n}\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-css\",\"children\":\"button { margin: 5px; }\\r\\nli { list-style-type: none; }\\r\\nul, li { margin: 0; padding: 0; }\\n\"}]}],[\"$r\",\"pre\",null,{\"children\":[\"$r\",\"code\",null,{\"className\":\"language-json\",\"meta\":\"package.json\",\"children\":\"{\\r\\n  \\\"dependencies\\\": {\\r\\n    \\\"immer\\\": \\\"1.7.3\\\",\\r\\n    \\\"react\\\": \\\"latest\\\",\\r\\n    \\\"react-dom\\\": \\\"latest\\\",\\r\\n    \\\"react-scripts\\\": \\\"latest\\\",\\r\\n    \\\"use-immer\\\": \\\"0.5.1\\\"\\r\\n  },\\r\\n  \\\"scripts\\\": {\\r\\n    \\\"start\\\": \\\"react-scripts start\\\",\\r\\n    \\\"build\\\": \\\"react-scripts build\\\",\\r\\n    \\\"test\\\": \\\"react-scripts test --env=jsdom\\\",\\r\\n    \\\"eject\\\": \\\"react-scripts eject\\\"\\r\\n  }\\r\\n}\\n\"}]}]]}],[\"$r\",\"p\",null,{\"children\":\"通过使用 Immer ，你可以为每个单独的场景选择最为自然的代码风格。\"}]]}]]}]]","meta":{"title":"更新 state 中的数组","translators":["yliaz","takeItIzzy","KnowsCount"]},"languages":null},"__N_SSG":true},"page":"/[[...markdownPath]]","query":{"markdownPath":["learn","updating-arrays-in-state"]},"buildId":"o3sV9gi4zL8eH-vfCdLA_","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>